
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module MatchState</title>
<meta name="description" content="Documentation of Coq module MatchState" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module MatchState</h1>
<div class="coq">
<br/>
<div class="doc">Definition of matching relation between Coq and C representation </div>
<span class="kwd">From</span> <span class="id">bpf.comm</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="bpf.comm.LemmaInt.html">LemmaInt</a></span> <span class="id"><a href="bpf.comm.State.html">State</a></span> <span class="id"><a href="bpf.comm.MemRegion.html">MemRegion</a></span> <span class="id"><a href="bpf.comm.Regs.html">Regs</a></span> <span class="id"><a href="bpf.comm.Flag.html">Flag</a></span> <span class="id"><a href="bpf.comm.List64.html">List64</a></span> <span class="id"><a href="bpf.comm.rBPFMemType.html">rBPFMemType</a></span>.<br/>
<span class="kwd">From</span> <span class="id">compcert</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Coqlib.html">Coqlib</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Integers.html">Integers</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html">Values</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.AST.html">AST</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.cfrontend.Clight.html">Clight</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html">Memory</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memtype.html">Memtype</a></span>.<br/>
<br/>
<span class="kwd">From</span> <span class="id">bpf.clightlogic</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="bpf.clightlogic.CommonLemma.html">CommonLemma</a></span> <span class="id">CommonLib</span> <span class="id"><a href="bpf.clightlogic.Clightlogic.html">Clightlogic</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Coq</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.ZArith.html">ZArith</a></span>.<br/>
<span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">Z_scope</span>.<br/>
<br/>
<br/>
<span class="kwd">Global</span> <span class="kwd">Transparent</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.x86_32.Archi.html#ptr64">Archi.ptr64</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="match_region_at_ofs">match_region_at_ofs</a></span> (<span class="id">mr</span>:<span class="id"><a href="bpf.comm.MemRegion.html#memory_region">memory_region</a></span>) (<span class="id">state_blk</span> <span class="id">mrs_blk</span> <span class="id">ins_blk</span>: <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#block">block</a></span>) (<span class="id">ofs</span> : <span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Integers.html#ptrofs">ptrofs</a></span>) (<span class="id">m</span>: <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#mem">mem</a></span>)  : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;(<span class="tactic">exists</span> <span class="id">vl</span>,  <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.loadv">Mem.loadv</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.AST.html#Mint32">AST.Mint32</a></span> <span class="id">m</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id">mrs_blk</span> <span class="id">ofs</span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Vint">Vint</a></span> <span class="id">vl</span>) /\ (<span class="id"><a href="bpf.comm.MemRegion.html#start_addr">start_addr</a></span> <span class="id">mr</span>) = <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Vint">Vint</a></span> <span class="id">vl</span>)    /\ <span class="docright">(* start_addr mr = Vint vl *)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">exists</span> <span class="id">vl</span>,  <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.loadv">Mem.loadv</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.AST.html#Mint32">AST.Mint32</a></span> <span class="id">m</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id">mrs_blk</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Integers.html#Ptrofs.add">Ptrofs.add</a></span> <span class="id">ofs</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> 4))) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Vint">Vint</a></span> <span class="id">vl</span>) /\ (<span class="id"><a href="bpf.comm.MemRegion.html#block_size">block_size</a></span> <span class="id">mr</span>) = <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Vint">Vint</a></span> <span class="id">vl</span>) /\ <span class="docright">(* block_size mr = Vint vl *)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">exists</span> <span class="id">vl</span>,  <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.loadv">Mem.loadv</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.AST.html#Mint32">AST.Mint32</a></span> <span class="id">m</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id">mrs_blk</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Integers.html#Ptrofs.add">Ptrofs.add</a></span> <span class="id">ofs</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> 8))) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Vint">Vint</a></span> <span class="id">vl</span>) /\ <span class="id">correct_perm</span> (<span class="id"><a href="bpf.comm.MemRegion.html#block_perm">block_perm</a></span> <span class="id">mr</span>)  <span class="id">vl</span>) /\ <span class="docright">(* block_perm mr = Vint vl *)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">exists</span> <span class="id">b</span>, <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.loadv">Mem.loadv</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.AST.html#Mptr">AST.Mptr</a></span>  <span class="id">m</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id">mrs_blk</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Integers.html#Ptrofs.add">Ptrofs.add</a></span> <span class="id">ofs</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> 12))) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id">b</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) /\ (<span class="id"><a href="bpf.comm.MemRegion.html#block_ptr">block_ptr</a></span> <span class="id">mr</span>) = <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id">b</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span> /\ (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.valid_block">Mem.valid_block</a></span> <span class="id">m</span> <span class="id">b</span> /\ <span class="id">b</span> &lt;&gt; <span class="id">state_blk</span> /\ <span class="id">b</span> &lt;&gt; <span class="id">mrs_blk</span> /\ <span class="id">b</span> &lt;&gt; <span class="id">ins_blk</span>)).<br/>
<br/>
<br/>
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="match_list_region">match_list_region</a></span> (<span class="id">m</span>:<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#mem">mem</a></span>) (<span class="id">state_blk</span> <span class="id">mrs_blk</span> <span class="id">ins_blk</span>: <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#block">block</a></span>) (<span class="id">l</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="bpf.comm.MemRegion.html#memory_region">memory_region</a></span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">i</span>, (0 &lt;= <span class="id">i</span> &lt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#length">List.length</a></span> <span class="id">l</span>)%<span class="id">nat</span> -&gt; <span class="id"><a href="bpf.simulation.MatchState.html#match_region_at_ofs">match_region_at_ofs</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth">List.nth</a></span> <span class="id">i</span> <span class="id">l</span> <span class="id"><a href="bpf.comm.MemRegion.html#default_memory_region">default_memory_region</a></span>) <span class="id">state_blk</span> <span class="id">mrs_blk</span> <span class="id">ins_blk</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> (16 * <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.of_nat">Z.of_nat</a></span> <span class="id">i</span>)) <span class="id">m</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="match_regions">match_regions</a></span> (<span class="id">state_blk</span> <span class="id">mrs_blk</span> <span class="id">ins_blk</span>: <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#block">block</a></span>) (<span class="id">st</span>: <span class="id"><a href="bpf.comm.State.html#state">State.state</a></span>) (<span class="id">m</span>:<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#mem">mem</a></span>) :=<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#length">List.length</a></span> (<span class="id"><a href="bpf.comm.State.html#bpf_mrs">bpf_mrs</a></span> <span class="id">st</span>) = (<span class="id"><a href="bpf.comm.State.html#mrs_num">mrs_num</a></span> <span class="id">st</span>) /\ <span class="docright">(* the number of bpf_mrs is exactly the mrs_num  *)</span><br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.of_nat">Z.of_nat</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#length">List.length</a></span> (<span class="id"><a href="bpf.comm.State.html#bpf_mrs">bpf_mrs</a></span> <span class="id">st</span>)) * 16 &lt;= <span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Integers.html#Ptrofs.max_unsigned">Ptrofs.max_unsigned</a></span> /\ <span class="docright">(* there is not overflow  *)</span><br/>
&nbsp;&nbsp;<span class="id"><a href="bpf.simulation.MatchState.html#match_list_region">match_list_region</a></span> <span class="id">m</span> <span class="id">state_blk</span> <span class="id">mrs_blk</span> <span class="id">ins_blk</span> (<span class="id"><a href="bpf.comm.State.html#bpf_mrs">bpf_mrs</a></span> <span class="id">st</span>).<br/>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="match_regions_in">match_regions_in</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span> <span class="id">mr</span> <span class="id">m</span> <span class="id">state_blk</span> <span class="id">mrs_blk</span> <span class="id">ins_blk</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hnth_error</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">mr</span> <span class="id">l</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hmatch</span> : <span class="id"><a href="bpf.simulation.MatchState.html#match_list_region">match_list_region</a></span> <span class="id">m</span> <span class="id">state_blk</span> <span class="id">mrs_blk</span> <span class="id">ins_blk</span> <span class="id">l</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">n</span>, <span class="id"><a href="bpf.simulation.MatchState.html#match_region_at_ofs">match_region_at_ofs</a></span> <span class="id">mr</span> <span class="id">state_blk</span> <span class="id">mrs_blk</span> <span class="id">ins_blk</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> (16 * <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.of_nat">Z.of_nat</a></span> <span class="id">n</span>)) <span class="id">m</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1')">Proof.</div>
<div class="proofscript" id="proof1">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="bpf.simulation.MatchState.html#match_list_region">match_list_region</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In_nth_error">In_nth_error</a></span> <span class="kwd">in</span> <span class="id">Hnth_error</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hnth_error</span> <span class="kwd">as</span> (<span class="id">n</span> &amp; <span class="id">Hnth_error</span>).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="bpf.clightlogic.CommonLemma.html#nth_error_some_length">nth_error_some_length</a></span> <span class="kwd">in</span> <span class="id">Hnth_error</span> <span class="kwd">as</span> <span class="id">Hlen</span>.<br/>
&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">Hmatch</span> <span class="id">n</span> <span class="id">Hlen</span>).<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hlen</span> <span class="kwd">as</span> ( <span class="id">_</span> &amp; <span class="id">Hlen</span>).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">nth_error_nth</span>' <span class="kwd">with</span> (<span class="id">d</span>:= <span class="id"><a href="bpf.comm.MemRegion.html#default_memory_region">default_memory_region</a></span>) <span class="kwd">in</span> <span class="id">Hlen</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hlen</span> <span class="kwd">in</span> <span class="id">Hnth_error</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hnth_error</span>.<br/>
&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">n</span>; <span class="tactic">assumption</span>.<br/>
Qed.</div>
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="match_list_ins">match_list_ins</a></span> (<span class="id">m</span>:<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#mem">mem</a></span>) (<span class="id">b</span>: <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#block">block</a></span>) (<span class="id">l</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Integers.html#int64">int64</a></span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">i</span>, (0 &lt;= <span class="id">i</span> &lt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#length">List.length</a></span> <span class="id">l</span>)%<span class="id">nat</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.loadv">Mem.loadv</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.AST.html#Mint64">AST.Mint64</a></span> <span class="id">m</span>  (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id">b</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> (8 * (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.of_nat">Z.of_nat</a></span> <span class="id">i</span>)))) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Vlong">Vlong</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth">List.nth</a></span> <span class="id">i</span> <span class="id">l</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Integers.html#Int64.zero">Int64.zero</a></span>)) .<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="match_ins">match_ins</a></span> (<span class="id">ins_blk</span>: <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#block">block</a></span>) (<span class="id">st</span>: <span class="id"><a href="bpf.comm.State.html#state">State.state</a></span>) (<span class="id">m</span>:<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#mem">mem</a></span>) :=<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#length">List.length</a></span> (<span class="id"><a href="bpf.comm.State.html#ins">ins</a></span> <span class="id">st</span>) = (<span class="id"><a href="bpf.comm.State.html#ins_len">ins_len</a></span> <span class="id">st</span>) /\<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.of_nat">Z.of_nat</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#length">List.length</a></span> (<span class="id"><a href="bpf.comm.State.html#ins">ins</a></span> <span class="id">st</span>)) * 8 &lt;= <span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Integers.html#Ptrofs.max_unsigned">Ptrofs.max_unsigned</a></span> /\<br/>
&nbsp;&nbsp;<span class="id"><a href="bpf.simulation.MatchState.html#match_list_ins">match_list_ins</a></span> <span class="id">m</span> <span class="id">ins_blk</span> (<span class="id"><a href="bpf.comm.State.html#ins">ins</a></span> <span class="id">st</span>).<br/>
<br/>
<br/>
<span class="kwd">Class</span> <span class="id"><a name="special_blocks">special_blocks</a></span> : <span class="kwd">Type</span> :=<br/>
&nbsp;&nbsp;{ <span class="id"><a name="st_blk">st_blk</a></span> : <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#block">block</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="mrs_blk">mrs_blk</a></span>  : <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#block">block</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="ins_blk">ins_blk</a></span>  : <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#block">block</a></span> }.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="S">S</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">Blocks</span> : <span class="id"><a href="bpf.simulation.MatchState.html#special_blocks">special_blocks</a></span>}.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="match_registers">match_registers</a></span>  (<span class="id">rmap</span>:<span class="id"><a href="bpf.comm.Regs.html#regmap">regmap</a></span>) (<span class="id">bl_reg</span>:<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#block">block</a></span>) (<span class="id">ofs</span> : <span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Integers.html#ptrofs">ptrofs</a></span>) (<span class="id">m</span> : <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#mem">mem</a></span>) : <span class="kwd">Prop</span>:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">r</span>:<span class="id"><a href="bpf.comm.Regs.html#reg">reg</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">vl</span>, <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.loadv">Mem.loadv</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.AST.html#Mint64">Mint64</a></span> <span class="id">m</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id">bl_reg</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Integers.html#Ptrofs.add">Ptrofs.add</a></span> <span class="id">ofs</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> (8 * (<span class="id">id_of_reg</span> <span class="id">r</span>))))) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Vlong">Vlong</a></span> <span class="id">vl</span>) /\ <span class="docright">(* it should be `(eval_regmap r rmap)` *)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Vlong">Vlong</a></span> <span class="id">vl</span> = <span class="id"><a href="bpf.comm.Regs.html#eval_regmap">eval_regmap</a></span> <span class="id">r</span> <span class="id">rmap</span>.<br/>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="size_of_state">size_of_state</a></span> (<span class="id">st</span>: <span class="id"><a href="bpf.comm.State.html#state">State.state</a></span>) := 100 + 16 * (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.of_nat">Z.of_nat</a></span> (<span class="id"><a href="bpf.comm.State.html#mrs_num">mrs_num</a></span> <span class="id">st</span>)) + 8 *(<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.of_nat">Z.of_nat</a></span> (<span class="id"><a href="bpf.comm.State.html#ins_len">ins_len</a></span> <span class="id">st</span>)).<br/>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Record</span> <span class="id"><a name="match_state">match_state</a></span>  (<span class="id">st</span>: <span class="id"><a href="bpf.comm.State.html#state">State.state</a></span>) (<span class="id">m</span>: <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#mem">mem</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="munchange">munchange</a></span>: <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.unchanged_on">Mem.unchanged_on</a></span> (<span class="kwd">fun</span> <span class="id">b</span> <span class="id">_</span> =&gt; <span class="id">b</span> &lt;&gt; <span class="id"><a href="bpf.simulation.MatchState.html#st_blk">st_blk</a></span> /\ <span class="id">b</span> &lt;&gt; <span class="id"><a href="bpf.simulation.MatchState.html#mrs_blk">mrs_blk</a></span> /\ <span class="id">b</span> &lt;&gt; <span class="id"><a href="bpf.simulation.MatchState.html#ins_blk">ins_blk</a></span>) (<span class="id"><a href="bpf.comm.State.html#bpf_m">bpf_m</a></span> <span class="id">st</span>) <span class="id">m</span>; <span class="docright">(* (bpf_m st) = m - {state_blk, mrs_blk, ins_blk}  *)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="mpc">mpc</a></span>      : <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.loadv">Mem.loadv</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.AST.html#Mint32">AST.Mint32</a></span> <span class="id">m</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="bpf.simulation.MatchState.html#st_blk">st_blk</a></span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> 0)) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Vint">Vint</a></span>  (<span class="id"><a href="bpf.comm.State.html#pc_loc">pc_loc</a></span> <span class="id">st</span>));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="mflags">mflags</a></span>   : <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.loadv">Mem.loadv</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.AST.html#Mint32">AST.Mint32</a></span> <span class="id">m</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="bpf.simulation.MatchState.html#st_blk">st_blk</a></span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> 4)) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Vint">Vint</a></span>  (<span class="id">int_of_flag</span> (<span class="id"><a href="bpf.comm.State.html#flag">flag</a></span> <span class="id">st</span>)));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="mregs">mregs</a></span>    : <span class="id"><a href="bpf.simulation.MatchState.html#match_registers">match_registers</a></span> (<span class="id"><a href="bpf.comm.State.html#regs_st">regs_st</a></span> <span class="id">st</span>) <span class="id"><a href="bpf.simulation.MatchState.html#st_blk">st_blk</a></span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> 8) <span class="id">m</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="mins_len">mins_len</a></span> : <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.loadv">Mem.loadv</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.AST.html#Mint32">AST.Mint32</a></span> <span class="id">m</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="bpf.simulation.MatchState.html#st_blk">st_blk</a></span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> 96)) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Vint">Vint</a></span>  (<span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Integers.html#Int.repr">Int.repr</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.of_nat">Z.of_nat</a></span> (<span class="id"><a href="bpf.comm.State.html#ins_len">ins_len</a></span> <span class="id">st</span>)))) /\ <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.of_nat">Z.of_nat</a></span> (<span class="id"><a href="bpf.comm.State.html#ins_len">ins_len</a></span> <span class="id">st</span>) &gt;= 1;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="mins">mins</a></span>     : <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.loadv">Mem.loadv</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.AST.html#Mptr">AST.Mptr</a></span> <span class="id">m</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="bpf.simulation.MatchState.html#st_blk">st_blk</a></span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> 100)) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="bpf.simulation.MatchState.html#ins_blk">ins_blk</a></span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> 0)) /\ <span class="id"><a href="bpf.simulation.MatchState.html#match_ins">match_ins</a></span> <span class="id"><a href="bpf.simulation.MatchState.html#ins_blk">ins_blk</a></span> <span class="id">st</span> <span class="id">m</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="mmrs_num">mmrs_num</a></span> : <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.loadv">Mem.loadv</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.AST.html#Mint32">AST.Mint32</a></span> <span class="id">m</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="bpf.simulation.MatchState.html#st_blk">st_blk</a></span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> 104)) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Vint">Vint</a></span>  (<span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Integers.html#Int.repr">Int.repr</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.of_nat">Z.of_nat</a></span> (<span class="id"><a href="bpf.comm.State.html#mrs_num">mrs_num</a></span> <span class="id">st</span>)))) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.of_nat">Z.of_nat</a></span>(<span class="id"><a href="bpf.comm.State.html#mrs_num">mrs_num</a></span> <span class="id">st</span>)) &gt;= 1; <span class="docright">(* at least we have the memory region that corresponds to the input paramters of the interpreter  *)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="mem_regs">mem_regs</a></span> : <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.loadv">Mem.loadv</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.AST.html#Mptr">AST.Mptr</a></span> <span class="id">m</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="bpf.simulation.MatchState.html#st_blk">st_blk</a></span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> 108)) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="bpf.simulation.MatchState.html#mrs_blk">mrs_blk</a></span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> 0)) /\ <span class="id"><a href="bpf.simulation.MatchState.html#match_regions">match_regions</a></span> <span class="id"><a href="bpf.simulation.MatchState.html#st_blk">st_blk</a></span> <span class="id"><a href="bpf.simulation.MatchState.html#mrs_blk">mrs_blk</a></span> <span class="id"><a href="bpf.simulation.MatchState.html#ins_blk">ins_blk</a></span> <span class="id">st</span> <span class="id">m</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="mperm">mperm</a></span>    : <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.range_perm">Mem.range_perm</a></span> <span class="id">m</span> <span class="id"><a href="bpf.simulation.MatchState.html#st_blk">st_blk</a></span> 0 (<span class="id"><a href="bpf.simulation.MatchState.html#size_of_state">size_of_state</a></span> <span class="id">st</span>) <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memtype.html#Cur">Cur</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memtype.html#Freeable">Freeable</a></span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.range_perm">Mem.range_perm</a></span> <span class="id">m</span> <span class="id"><a href="bpf.simulation.MatchState.html#mrs_blk">mrs_blk</a></span>   0 (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.of_nat">Z.of_nat</a></span> (<span class="id"><a href="bpf.comm.State.html#mrs_num">mrs_num</a></span> <span class="id">st</span>)) <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memtype.html#Cur">Cur</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memtype.html#Freeable">Freeable</a></span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.range_perm">Mem.range_perm</a></span> <span class="id">m</span> <span class="id"><a href="bpf.simulation.MatchState.html#ins_blk">ins_blk</a></span>   0 (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.of_nat">Z.of_nat</a></span> (<span class="id"><a href="bpf.comm.State.html#ins_len">ins_len</a></span> <span class="id">st</span>)) <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memtype.html#Cur">Cur</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memtype.html#Readable">Readable</a></span>; <span class="docright">(* we also need to say `mrs/ins_blk`  *)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="minvalid">minvalid</a></span> : (~<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.valid_block">Mem.valid_block</a></span> (<span class="id"><a href="bpf.comm.State.html#bpf_m">bpf_m</a></span> <span class="id">st</span>) <span class="id"><a href="bpf.simulation.MatchState.html#st_blk">st_blk</a></span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.valid_block">Mem.valid_block</a></span> (<span class="id"><a href="bpf.comm.State.html#bpf_m">bpf_m</a></span> <span class="id">st</span>) <span class="id"><a href="bpf.simulation.MatchState.html#mrs_blk">mrs_blk</a></span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.valid_block">Mem.valid_block</a></span> (<span class="id"><a href="bpf.comm.State.html#bpf_m">bpf_m</a></span> <span class="id">st</span>) <span class="id"><a href="bpf.simulation.MatchState.html#ins_blk">ins_blk</a></span>) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="bpf.simulation.MatchState.html#mrs_blk">mrs_blk</a></span> &lt;&gt; <span class="id"><a href="bpf.simulation.MatchState.html#st_blk">st_blk</a></span> /\ <span class="id"><a href="bpf.simulation.MatchState.html#mrs_blk">mrs_blk</a></span> &lt;&gt; <span class="id"><a href="bpf.simulation.MatchState.html#ins_blk">ins_blk</a></span> /\ <span class="id"><a href="bpf.simulation.MatchState.html#ins_blk">ins_blk</a></span> &lt;&gt; <span class="id"><a href="bpf.simulation.MatchState.html#st_blk">st_blk</a></span>) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">b</span>, <span class="id">b</span> &lt;&gt; <span class="id"><a href="bpf.simulation.MatchState.html#st_blk">st_blk</a></span> /\ <span class="id">b</span> &lt;&gt; <span class="id"><a href="bpf.simulation.MatchState.html#mrs_blk">mrs_blk</a></span> /\ <span class="id">b</span> &lt;&gt; <span class="id"><a href="bpf.simulation.MatchState.html#ins_blk">ins_blk</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.valid_block">Mem.valid_block</a></span> <span class="id">m</span> <span class="id">b</span> -&gt; <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.valid_block">Mem.valid_block</a></span> (<span class="id"><a href="bpf.comm.State.html#bpf_m">bpf_m</a></span> <span class="id">st</span>) <span class="id">b</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}.<br/>
<br/>
<span class="kwd">End</span> <span class="id"><a href="bpf.simulation.MatchState.html#S">S</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="range_perm_included">range_perm_included</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">b</span> <span class="id">p</span> <span class="id">lo</span> <span class="id">hi</span> <span class="id">ofs_lo</span> <span class="id">ofs_hi</span>, <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lo</span> &lt;= <span class="id">ofs_lo</span> -&gt; <span class="id">ofs_lo</span> &lt; <span class="id">ofs_hi</span> -&gt; <span class="id">ofs_hi</span> &lt;= <span class="id">hi</span> -&gt;  <span class="docright">(* `&lt;` -&gt; `&lt;=`  *)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.range_perm">Mem.range_perm</a></span> <span class="id">m</span> <span class="id">b</span> <span class="id">lo</span> <span class="id">hi</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memtype.html#Cur">Cur</a></span> <span class="id">p</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.range_perm">Mem.range_perm</a></span> <span class="id">m</span> <span class="id">b</span> <span class="id">ofs_lo</span> <span class="id">ofs_hi</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memtype.html#Cur">Cur</a></span> <span class="id">p</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2')">Proof.</div>
<div class="proofscript" id="proof2">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.range_perm_implies">Mem.range_perm_implies</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">p</span> <span class="id">_</span>); [<span class="tactic">idtac</span> | <span class="tactic">constructor</span>].<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.range_perm">Mem.range_perm</a></span> <span class="kwd">in</span> *; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;<span class="id">lia</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Permission Lemmas: upd_pc </div>
<span class="kwd">Lemma</span> <span class="id"><a name="upd_pc_write_access">upd_pc_write_access</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m0</span> {<span class="id">bl</span>:<span class="id"><a href="bpf.simulation.MatchState.html#special_blocks">special_blocks</a></span>} <span class="id">st</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hst</span>: <span class="id"><a href="bpf.simulation.MatchState.html#match_state">match_state</a></span>  <span class="id">st</span> <span class="id">m0</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.valid_access">Mem.valid_access</a></span> <span class="id">m0</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.AST.html#Mint32">Mint32</a></span> <span class="id"><a href="bpf.simulation.MatchState.html#st_blk">st_blk</a></span> 0 <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memtype.html#Writable">Writable</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3')">Proof.</div>
<div class="proofscript" id="proof3">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">unfold</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.valid_access">Mem.valid_access</a></span>; <span class="tactic">destruct</span> <span class="id">Hst</span>; <span class="tactic">clear</span> - <span class="id">mem_regs0</span> <span class="id">mperm0</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">mem_regs0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="bpf.simulation.MatchState.html#match_regions">match_regions</a></span>, <span class="id"><a href="bpf.simulation.MatchState.html#size_of_state">size_of_state</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">mperm0</span> <span class="kwd">as</span> (<span class="id">mperm0</span> &amp; <span class="id">_</span> &amp; <span class="id">_</span>).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.range_perm_implies">Mem.range_perm_implies</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memtype.html#Writable">Writable</a></span>) <span class="kwd">in</span> <span class="id">mperm0</span>; [<span class="tactic">idtac</span> | <span class="tactic">constructor</span>].<br/>
<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memdata.html#size_chunk">size_chunk</a></span>, <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memdata.html#align_chunk">align_chunk</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">simpl</span>; <span class="tactic">apply</span> (<span class="id"><a href="bpf.simulation.MatchState.html#range_perm_included">range_perm_included</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memtype.html#Writable">Writable</a></span> <span class="id">_</span> <span class="id">_</span> 0 4) <span class="kwd">in</span> <span class="id">mperm0</span>; [<span class="tactic">assumption</span> | <span class="id">lia</span> | <span class="id">lia</span> | <span class="tactic">idtac</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">H</span>: 0&lt;= <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.of_nat">Z.of_nat</a></span> (<span class="id"><a href="bpf.comm.State.html#mrs_num">State.mrs_num</a></span> <span class="id">st</span>)). { <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Znat.html#Nat2Z.is_nonneg">Nat2Z.is_nonneg</a></span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lia</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.divide_0_r">Z.divide_0_r</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="upd_pc_store">upd_pc_store</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m0</span> {<span class="id">S</span>: <span class="id"><a href="bpf.simulation.MatchState.html#special_blocks">special_blocks</a></span>} <span class="id">pc</span> <span class="id">st</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hst</span>: <span class="id"><a href="bpf.simulation.MatchState.html#match_state">match_state</a></span>  <span class="id">st</span> <span class="id">m0</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">m1</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.store">Mem.store</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.AST.html#Mint32">AST.Mint32</a></span> <span class="id">m0</span> <span class="id"><a href="bpf.simulation.MatchState.html#st_blk">st_blk</a></span> 0 (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Vint">Vint</a></span> <span class="id">pc</span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m1</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4')">Proof.</div>
<div class="proofscript" id="proof4">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="bpf.simulation.MatchState.html#upd_pc_write_access">upd_pc_write_access</a></span>  <span class="kwd">in</span> <span class="id">Hst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.valid_access_store">Mem.valid_access_store</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Vint">Vint</a></span> <span class="id">pc</span>)) <span class="kwd">in</span> <span class="id">Hst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hst</span> <span class="kwd">as</span> (<span class="id">m2</span> &amp; <span class="id">Hstore</span>).<br/>
&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">m2</span>; <span class="tactic">assumption</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Permission Lemmas: upd_flags </div>
<span class="kwd">Lemma</span> <span class="id"><a name="upd_flags_write_access">upd_flags_write_access</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m0</span> {<span class="id">S</span>:<span class="id"><a href="bpf.simulation.MatchState.html#special_blocks">special_blocks</a></span>} <span class="id">st</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hst</span>: <span class="id"><a href="bpf.simulation.MatchState.html#match_state">match_state</a></span>  <span class="id">st</span> <span class="id">m0</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.valid_access">Mem.valid_access</a></span> <span class="id">m0</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.AST.html#Mint32">Mint32</a></span> <span class="id"><a href="bpf.simulation.MatchState.html#st_blk">st_blk</a></span> 4 <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memtype.html#Writable">Writable</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof5')">Proof.</div>
<div class="proofscript" id="proof5">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">unfold</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.valid_access">Mem.valid_access</a></span>; <span class="tactic">destruct</span> <span class="id">Hst</span>; <span class="tactic">clear</span> - <span class="id">mperm0</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">mperm0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="bpf.simulation.MatchState.html#size_of_state">size_of_state</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">mperm0</span> <span class="kwd">as</span> (<span class="id">mperm0</span> &amp; <span class="id">_</span> &amp; <span class="id">_</span>).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.range_perm_implies">Mem.range_perm_implies</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memtype.html#Writable">Writable</a></span>) <span class="kwd">in</span> <span class="id">mperm0</span>; [<span class="tactic">idtac</span> | <span class="tactic">constructor</span>].<br/>
<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memdata.html#size_chunk">size_chunk</a></span>, <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memdata.html#align_chunk">align_chunk</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="bpf.simulation.MatchState.html#range_perm_included">range_perm_included</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memtype.html#Writable">Writable</a></span> <span class="id">_</span> <span class="id">_</span> 4 8) <span class="kwd">in</span> <span class="id">mperm0</span>; [<span class="tactic">assumption</span> | <span class="id">lia</span> | <span class="id">lia</span> | <span class="id">lia</span>].<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.divide_refl">Z.divide_refl</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="upd_flags_store">upd_flags_store</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m0</span> {<span class="id">S</span>: <span class="id"><a href="bpf.simulation.MatchState.html#special_blocks">special_blocks</a></span>} <span class="id">st</span> <span class="id">v</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hst</span>: <span class="id"><a href="bpf.simulation.MatchState.html#match_state">match_state</a></span>  <span class="id">st</span> <span class="id">m0</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">m1</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.store">Mem.store</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.AST.html#Mint32">AST.Mint32</a></span> <span class="id">m0</span> <span class="id"><a href="bpf.simulation.MatchState.html#st_blk">st_blk</a></span> 4 (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Vint">Vint</a></span> <span class="id">v</span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m1</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6')">Proof.</div>
<div class="proofscript" id="proof6">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="bpf.simulation.MatchState.html#upd_flags_write_access">upd_flags_write_access</a></span> <span class="id">_</span> <span class="id">_</span> ) <span class="kwd">in</span> <span class="id">Hst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.valid_access_store">Mem.valid_access_store</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Vint">Vint</a></span> <span class="id">v</span>)) <span class="kwd">in</span> <span class="id">Hst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hst</span> <span class="kwd">as</span> (<span class="id">m2</span> &amp; <span class="id">Hstore</span>).<br/>
&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">m2</span>; <span class="tactic">assumption</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Permission Lemmas: upd_regs </div>
<span class="kwd">Lemma</span> <span class="id"><a name="upd_regs_write_access">upd_regs_write_access</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m0</span> {<span class="id">S</span>: <span class="id"><a href="bpf.simulation.MatchState.html#special_blocks">special_blocks</a></span>} <span class="id">st</span> <span class="id">r</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hst</span>: <span class="id"><a href="bpf.simulation.MatchState.html#match_state">match_state</a></span>  <span class="id">st</span> <span class="id">m0</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.valid_access">Mem.valid_access</a></span> <span class="id">m0</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.AST.html#Mint64">Mint64</a></span> <span class="id"><a href="bpf.simulation.MatchState.html#st_blk">st_blk</a></span> (8 + (8 * (<span class="id">id_of_reg</span> <span class="id">r</span>))) <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memtype.html#Writable">Writable</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7')">Proof.</div>
<div class="proofscript" id="proof7">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">unfold</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.valid_access">Mem.valid_access</a></span>; <span class="tactic">destruct</span> <span class="id">Hst</span>; <span class="tactic">clear</span> - <span class="id">mperm0</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">mperm0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="bpf.simulation.MatchState.html#size_of_state">size_of_state</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">mperm0</span> <span class="kwd">as</span> (<span class="id">mperm0</span> &amp; <span class="id">_</span> &amp; <span class="id">_</span>).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.range_perm_implies">Mem.range_perm_implies</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memtype.html#Writable">Writable</a></span>) <span class="kwd">in</span> <span class="id">mperm0</span>; [<span class="tactic">idtac</span> | <span class="tactic">constructor</span>].<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">H</span>: 0&lt;= <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.of_nat">Z.of_nat</a></span> (<span class="id"><a href="bpf.comm.State.html#mrs_num">State.mrs_num</a></span> <span class="id">st</span>)). { <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Znat.html#Nat2Z.is_nonneg">Nat2Z.is_nonneg</a></span>. }<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="bpf.simulation.MatchState.html#range_perm_included">range_perm_included</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memtype.html#Writable">Writable</a></span> <span class="id">_</span> <span class="id">_</span> 0 100) <span class="kwd">in</span> <span class="id">mperm0</span>; [<span class="tactic">idtac</span> | <span class="id">lia</span> | <span class="id">lia</span> | <span class="id">lia</span>].<br/>
<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">id_of_reg</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memdata.html#size_chunk">size_chunk</a></span>, <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memdata.html#align_chunk">align_chunk</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> (<span class="id"><a href="bpf.simulation.MatchState.html#range_perm_included">range_perm_included</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memtype.html#Writable">Writable</a></span> <span class="id">_</span> <span class="id">_</span> (8 + (8 * (<span class="id">id_of_reg</span> <span class="id">r</span>))) (8 + (8 * (<span class="id">id_of_reg</span> <span class="id">r</span> +1)))) <span class="kwd">in</span> <span class="id">mperm0</span>;<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">r</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">try</span> <span class="id">lia</span>; <span class="tactic">try</span> <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">assert</span> (<span class="id">Heq</span>: <span class="kwd">forall</span> <span class="id">x</span>, 8 + 8 * <span class="id">x</span> = 8 * (1 + <span class="id">x</span>)). {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.omega.OmegaLemmas.html#Zred_factor2">Zred_factor2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.divide_factor_l">Z.divide_factor_l</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="upd_regs_store">upd_regs_store</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m0</span> {<span class="id">S</span>: <span class="id"><a href="bpf.simulation.MatchState.html#special_blocks">special_blocks</a></span>} <span class="id">st</span> <span class="id">r</span> <span class="id">v</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hst</span>: <span class="id"><a href="bpf.simulation.MatchState.html#match_state">match_state</a></span>  <span class="id">st</span> <span class="id">m0</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">m1</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.store">Mem.store</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.AST.html#Mint64">AST.Mint64</a></span> <span class="id">m0</span> <span class="id"><a href="bpf.simulation.MatchState.html#st_blk">st_blk</a></span> (8 + (8 * (<span class="id">id_of_reg</span> <span class="id">r</span>))) (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Vlong">Vlong</a></span> <span class="id">v</span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m1</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof8')">Proof.</div>
<div class="proofscript" id="proof8">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="bpf.simulation.MatchState.html#upd_regs_write_access">upd_regs_write_access</a></span> <span class="kwd">with</span> (<span class="id">r</span>:=<span class="id">r</span>) <span class="kwd">in</span> <span class="id">Hst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.valid_access_store">Mem.valid_access_store</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Vlong">Vlong</a></span> <span class="id">v</span>)) <span class="kwd">in</span> <span class="id">Hst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hst</span> <span class="kwd">as</span> (<span class="id">m2</span> &amp; <span class="id">Hstore</span>).<br/>
&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">m2</span>; <span class="tactic">assumption</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Permission Lemmas: upd_mem_regions </div>
<br/>
<div class="doc">TODO: nothing to do because we never update memory_regions, it should be done before running the interpter </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="match_region">match_region</a></span> (<span class="id">st_blk</span> <span class="id">mrs_blk</span> <span class="id">ins_blk</span> : <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#block">block</a></span>) (<span class="id">mr</span>: <span class="id"><a href="bpf.comm.MemRegion.html#memory_region">memory_region</a></span>) (<span class="id">v</span>: <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#val">val</a></span>) (<span class="id">st</span>: <span class="id"><a href="bpf.comm.State.html#state">State.state</a></span>) (<span class="id">m</span>:<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.mem">Memory.Mem.mem</a></span>) :=<br/>
&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">o</span>, <span class="id">v</span> = <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id">mrs_blk</span> <span class="id">o</span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.simulation.MatchState.html#match_region_at_ofs">match_region_at_ofs</a></span> <span class="id">mr</span> <span class="id">st_blk</span> <span class="id">mrs_blk</span> <span class="id">ins_blk</span> <span class="id">o</span> <span class="id">m</span>.<br/>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="same_memory_match_region">same_memory_match_region</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">st_blk</span> <span class="id">mrs_blk</span> <span class="id">ins_blk</span> <span class="id">st</span> <span class="id">st</span>' <span class="id">m</span> <span class="id">m</span>' <span class="id">mr</span> <span class="id">v</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">UMOD</span> : <span class="id"><a href="bpf.clightlogic.Clightlogic.html#unmodifies_effect">unmodifies_effect</a></span> <span class="id"><a href="bpf.clightlogic.Clightlogic.html#ModNothing">ModNothing</a></span> <span class="id">m</span> <span class="id">m</span>' <span class="id">st</span> <span class="id">st</span>'),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.simulation.MatchState.html#match_region">match_region</a></span> <span class="id">st_blk</span> <span class="id">mrs_blk</span> <span class="id">ins_blk</span> <span class="id">mr</span> <span class="id">v</span> <span class="id">st</span> <span class="id">m</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.simulation.MatchState.html#match_region">match_region</a></span> <span class="id">st_blk</span> <span class="id">mrs_blk</span> <span class="id">ins_blk</span> <span class="id">mr</span> <span class="id">v</span> <span class="id">st</span>' <span class="id">m</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9')">Proof.</div>
<div class="proofscript" id="proof9">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="bpf.simulation.MatchState.html#match_region">match_region</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> (<span class="id">o</span> &amp; <span class="id">E</span> &amp; <span class="id">MR</span>).<br/>
&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">o</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="bpf.simulation.MatchState.html#match_region_at_ofs">match_region_at_ofs</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="bpf.clightlogic.Clightlogic.html#unmodifies_effect">unmodifies_effect</a></span> <span class="kwd">in</span> <span class="id">UMOD</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">UMOD</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> &lt;- <span class="id">UMOD</span> <span class="tactic">by</span> (<span class="tactic">simpl</span> ; <span class="tactic">tauto</span>).<br/>
&nbsp;&nbsp;<span class="tactic">intuition</span>.<br/>
Qed.</div>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="upd_reg_same_mem">upd_reg_same_mem</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">st0</span> <span class="id">r</span> <span class="id">vl</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.comm.State.html#bpf_m">bpf_m</a></span> <span class="id">st0</span> = <span class="id"><a href="bpf.comm.State.html#bpf_m">bpf_m</a></span> (<span class="id"><a href="bpf.comm.State.html#upd_reg">State.upd_reg</a></span> <span class="id">r</span> <span class="id">vl</span> <span class="id">st0</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof10')">Proof.</div>
<div class="proofscript" id="proof10">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="bpf.comm.State.html#upd_reg">State.upd_reg</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="upd_reg_same_pc">upd_reg_same_pc</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">st0</span> <span class="id">r</span> <span class="id">vl</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.comm.State.html#pc_loc">pc_loc</a></span> <span class="id">st0</span> = <span class="id"><a href="bpf.comm.State.html#pc_loc">pc_loc</a></span> (<span class="id"><a href="bpf.comm.State.html#upd_reg">State.upd_reg</a></span> <span class="id">r</span> <span class="id">vl</span> <span class="id">st0</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof11')">Proof.</div>
<div class="proofscript" id="proof11">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="bpf.comm.State.html#upd_reg">State.upd_reg</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="upd_reg_same_flag">upd_reg_same_flag</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">st0</span> <span class="id">r</span> <span class="id">vl</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.comm.State.html#flag">flag</a></span> <span class="id">st0</span> = <span class="id"><a href="bpf.comm.State.html#flag">flag</a></span> (<span class="id"><a href="bpf.comm.State.html#upd_reg">State.upd_reg</a></span> <span class="id">r</span> <span class="id">vl</span> <span class="id">st0</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof12')">Proof.</div>
<div class="proofscript" id="proof12">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="bpf.comm.State.html#upd_reg">State.upd_reg</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="upd_reg_same_mrs">upd_reg_same_mrs</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">st0</span> <span class="id">r</span> <span class="id">vl</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.comm.State.html#bpf_mrs">bpf_mrs</a></span> <span class="id">st0</span> = <span class="id"><a href="bpf.comm.State.html#bpf_mrs">bpf_mrs</a></span> (<span class="id"><a href="bpf.comm.State.html#upd_reg">State.upd_reg</a></span> <span class="id">r</span> <span class="id">vl</span> <span class="id">st0</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof13')">Proof.</div>
<div class="proofscript" id="proof13">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="bpf.comm.State.html#upd_reg">State.upd_reg</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="upd_reg_same_mrs_num">upd_reg_same_mrs_num</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">st0</span> <span class="id">r</span> <span class="id">vl</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.comm.State.html#mrs_num">State.mrs_num</a></span> <span class="id">st0</span> = <span class="id"><a href="bpf.comm.State.html#mrs_num">State.mrs_num</a></span> (<span class="id"><a href="bpf.comm.State.html#upd_reg">State.upd_reg</a></span> <span class="id">r</span> <span class="id">vl</span> <span class="id">st0</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof14')">Proof.</div>
<div class="proofscript" id="proof14">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="bpf.comm.State.html#upd_reg">State.upd_reg</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="upd_reg_same_ins">upd_reg_same_ins</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">st0</span> <span class="id">r</span> <span class="id">vl</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.comm.State.html#ins">ins</a></span> <span class="id">st0</span> = <span class="id"><a href="bpf.comm.State.html#ins">ins</a></span> (<span class="id"><a href="bpf.comm.State.html#upd_reg">State.upd_reg</a></span> <span class="id">r</span> <span class="id">vl</span> <span class="id">st0</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof15')">Proof.</div>
<div class="proofscript" id="proof15">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="bpf.comm.State.html#upd_reg">State.upd_reg</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="upd_reg_same_ins_len">upd_reg_same_ins_len</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">st0</span> <span class="id">r</span> <span class="id">vl</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.comm.State.html#ins_len">ins_len</a></span> <span class="id">st0</span> = <span class="id"><a href="bpf.comm.State.html#ins_len">ins_len</a></span> (<span class="id"><a href="bpf.comm.State.html#upd_reg">State.upd_reg</a></span> <span class="id">r</span> <span class="id">vl</span> <span class="id">st0</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof16')">Proof.</div>
<div class="proofscript" id="proof16">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="bpf.comm.State.html#upd_reg">State.upd_reg</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="upd_pc_same_mem">upd_pc_same_mem</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">st0</span> <span class="id">pc</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.comm.State.html#bpf_m">bpf_m</a></span> <span class="id">st0</span> = <span class="id"><a href="bpf.comm.State.html#bpf_m">bpf_m</a></span> (<span class="id"><a href="bpf.comm.State.html#upd_pc">State.upd_pc</a></span> <span class="id">pc</span> <span class="id">st0</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof17')">Proof.</div>
<div class="proofscript" id="proof17">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="bpf.comm.State.html#upd_pc">State.upd_pc</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="upd_pc_same_regs">upd_pc_same_regs</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">st0</span> <span class="id">pc</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.comm.State.html#regs_st">regs_st</a></span> <span class="id">st0</span> = <span class="id"><a href="bpf.comm.State.html#regs_st">regs_st</a></span> (<span class="id"><a href="bpf.comm.State.html#upd_pc">State.upd_pc</a></span> <span class="id">pc</span> <span class="id">st0</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof18')">Proof.</div>
<div class="proofscript" id="proof18">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="bpf.comm.State.html#upd_pc">State.upd_pc</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="upd_pc_same_flag">upd_pc_same_flag</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">st0</span> <span class="id">pc</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.comm.State.html#flag">flag</a></span> <span class="id">st0</span> = <span class="id"><a href="bpf.comm.State.html#flag">flag</a></span> (<span class="id"><a href="bpf.comm.State.html#upd_pc">State.upd_pc</a></span> <span class="id">pc</span> <span class="id">st0</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof19')">Proof.</div>
<div class="proofscript" id="proof19">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="bpf.comm.State.html#upd_pc">State.upd_pc</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="upd_pc_same_mrs">upd_pc_same_mrs</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">st0</span> <span class="id">pc</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.comm.State.html#bpf_mrs">bpf_mrs</a></span> <span class="id">st0</span> = <span class="id"><a href="bpf.comm.State.html#bpf_mrs">bpf_mrs</a></span> (<span class="id"><a href="bpf.comm.State.html#upd_pc">State.upd_pc</a></span> <span class="id">pc</span> <span class="id">st0</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof20')">Proof.</div>
<div class="proofscript" id="proof20">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="bpf.comm.State.html#upd_pc">State.upd_pc</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="upd_pc_same_mrs_num">upd_pc_same_mrs_num</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">st0</span> <span class="id">pc</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.comm.State.html#mrs_num">State.mrs_num</a></span> <span class="id">st0</span> = <span class="id"><a href="bpf.comm.State.html#mrs_num">State.mrs_num</a></span> (<span class="id"><a href="bpf.comm.State.html#upd_pc">State.upd_pc</a></span> <span class="id">pc</span> <span class="id">st0</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof21')">Proof.</div>
<div class="proofscript" id="proof21">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="bpf.comm.State.html#upd_pc">State.upd_pc</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="upd_pc_same_ins">upd_pc_same_ins</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">st0</span> <span class="id">pc</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.comm.State.html#ins">ins</a></span> <span class="id">st0</span> = <span class="id"><a href="bpf.comm.State.html#ins">ins</a></span> (<span class="id"><a href="bpf.comm.State.html#upd_pc">State.upd_pc</a></span> <span class="id">pc</span> <span class="id">st0</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof22')">Proof.</div>
<div class="proofscript" id="proof22">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="bpf.comm.State.html#upd_pc">State.upd_pc</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="upd_pc_same_ins_len">upd_pc_same_ins_len</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">st0</span> <span class="id">pc</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.comm.State.html#ins_len">ins_len</a></span> <span class="id">st0</span> = <span class="id"><a href="bpf.comm.State.html#ins_len">ins_len</a></span> (<span class="id"><a href="bpf.comm.State.html#upd_pc">State.upd_pc</a></span> <span class="id">pc</span> <span class="id">st0</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof23')">Proof.</div>
<div class="proofscript" id="proof23">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="bpf.comm.State.html#upd_pc">State.upd_pc</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="upd_pc_incr_same_mem">upd_pc_incr_same_mem</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">st0</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.comm.State.html#bpf_m">bpf_m</a></span> <span class="id">st0</span> = <span class="id"><a href="bpf.comm.State.html#bpf_m">bpf_m</a></span> (<span class="id"><a href="bpf.comm.State.html#upd_pc_incr">State.upd_pc_incr</a></span> <span class="id">st0</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof24')">Proof.</div>
<div class="proofscript" id="proof24">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="bpf.comm.State.html#upd_pc_incr">State.upd_pc_incr</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="upd_pc_incr_same_regs">upd_pc_incr_same_regs</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">st0</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.comm.State.html#regs_st">regs_st</a></span> <span class="id">st0</span> = <span class="id"><a href="bpf.comm.State.html#regs_st">regs_st</a></span> (<span class="id"><a href="bpf.comm.State.html#upd_pc_incr">State.upd_pc_incr</a></span> <span class="id">st0</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof25')">Proof.</div>
<div class="proofscript" id="proof25">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="bpf.comm.State.html#upd_pc_incr">State.upd_pc_incr</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="upd_pc_incr_same_flag">upd_pc_incr_same_flag</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">st0</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.comm.State.html#flag">flag</a></span> <span class="id">st0</span> = <span class="id"><a href="bpf.comm.State.html#flag">flag</a></span> (<span class="id"><a href="bpf.comm.State.html#upd_pc_incr">State.upd_pc_incr</a></span> <span class="id">st0</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof26')">Proof.</div>
<div class="proofscript" id="proof26">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="bpf.comm.State.html#upd_pc_incr">State.upd_pc_incr</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="upd_pc_incr_same_mrs">upd_pc_incr_same_mrs</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">st0</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.comm.State.html#bpf_mrs">bpf_mrs</a></span> <span class="id">st0</span> = <span class="id"><a href="bpf.comm.State.html#bpf_mrs">bpf_mrs</a></span> (<span class="id"><a href="bpf.comm.State.html#upd_pc_incr">State.upd_pc_incr</a></span> <span class="id">st0</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof27')">Proof.</div>
<div class="proofscript" id="proof27">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="bpf.comm.State.html#upd_pc_incr">State.upd_pc_incr</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="upd_pc_incr_same_mrs_num">upd_pc_incr_same_mrs_num</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">st0</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.comm.State.html#mrs_num">State.mrs_num</a></span> <span class="id">st0</span> = <span class="id"><a href="bpf.comm.State.html#mrs_num">State.mrs_num</a></span> (<span class="id"><a href="bpf.comm.State.html#upd_pc_incr">State.upd_pc_incr</a></span> <span class="id">st0</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof28')">Proof.</div>
<div class="proofscript" id="proof28">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="bpf.comm.State.html#upd_pc_incr">State.upd_pc_incr</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="upd_pc_incr_same_ins">upd_pc_incr_same_ins</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">st0</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.comm.State.html#ins">ins</a></span> <span class="id">st0</span> = <span class="id"><a href="bpf.comm.State.html#ins">ins</a></span> (<span class="id"><a href="bpf.comm.State.html#upd_pc_incr">State.upd_pc_incr</a></span> <span class="id">st0</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof29')">Proof.</div>
<div class="proofscript" id="proof29">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="bpf.comm.State.html#upd_pc_incr">State.upd_pc_incr</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="upd_pc_incr_same_ins_len">upd_pc_incr_same_ins_len</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">st0</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.comm.State.html#ins_len">ins_len</a></span> <span class="id">st0</span> = <span class="id"><a href="bpf.comm.State.html#ins_len">ins_len</a></span> (<span class="id"><a href="bpf.comm.State.html#upd_pc_incr">State.upd_pc_incr</a></span> <span class="id">st0</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof30')">Proof.</div>
<div class="proofscript" id="proof30">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="bpf.comm.State.html#upd_pc_incr">State.upd_pc_incr</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="upd_flag_same_mem">upd_flag_same_mem</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">st0</span> <span class="id">f</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.comm.State.html#bpf_m">bpf_m</a></span> <span class="id">st0</span> = <span class="id"><a href="bpf.comm.State.html#bpf_m">bpf_m</a></span> (<span class="id"><a href="bpf.comm.State.html#upd_flag">State.upd_flag</a></span> <span class="id">f</span> <span class="id">st0</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof31')">Proof.</div>
<div class="proofscript" id="proof31">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="bpf.comm.State.html#upd_flag">State.upd_flag</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="upd_flag_same_regs">upd_flag_same_regs</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">st0</span> <span class="id">f</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.comm.State.html#regs_st">regs_st</a></span> <span class="id">st0</span> = <span class="id"><a href="bpf.comm.State.html#regs_st">regs_st</a></span> (<span class="id"><a href="bpf.comm.State.html#upd_flag">State.upd_flag</a></span> <span class="id">f</span> <span class="id">st0</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof32')">Proof.</div>
<div class="proofscript" id="proof32">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="bpf.comm.State.html#upd_flag">State.upd_flag</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="upd_flag_same_pc">upd_flag_same_pc</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">st0</span> <span class="id">f</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.comm.State.html#pc_loc">pc_loc</a></span> <span class="id">st0</span> = <span class="id"><a href="bpf.comm.State.html#pc_loc">pc_loc</a></span> (<span class="id"><a href="bpf.comm.State.html#upd_flag">State.upd_flag</a></span> <span class="id">f</span> <span class="id">st0</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof33')">Proof.</div>
<div class="proofscript" id="proof33">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="bpf.comm.State.html#upd_flag">State.upd_flag</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="upd_flag_same_mrs">upd_flag_same_mrs</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">st0</span> <span class="id">f</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.comm.State.html#bpf_mrs">bpf_mrs</a></span> <span class="id">st0</span> = <span class="id"><a href="bpf.comm.State.html#bpf_mrs">bpf_mrs</a></span> (<span class="id"><a href="bpf.comm.State.html#upd_flag">State.upd_flag</a></span> <span class="id">f</span> <span class="id">st0</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof34')">Proof.</div>
<div class="proofscript" id="proof34">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="bpf.comm.State.html#upd_flag">State.upd_flag</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="upd_flag_same_mrs_num">upd_flag_same_mrs_num</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">st0</span> <span class="id">f</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.comm.State.html#mrs_num">State.mrs_num</a></span> <span class="id">st0</span> = <span class="id"><a href="bpf.comm.State.html#mrs_num">State.mrs_num</a></span> (<span class="id"><a href="bpf.comm.State.html#upd_flag">State.upd_flag</a></span> <span class="id">f</span> <span class="id">st0</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof35')">Proof.</div>
<div class="proofscript" id="proof35">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="bpf.comm.State.html#upd_flag">State.upd_flag</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="upd_flag_same_ins">upd_flag_same_ins</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">st0</span> <span class="id">f</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.comm.State.html#ins">ins</a></span> <span class="id">st0</span> = <span class="id"><a href="bpf.comm.State.html#ins">ins</a></span> (<span class="id"><a href="bpf.comm.State.html#upd_flag">State.upd_flag</a></span> <span class="id">f</span> <span class="id">st0</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof36')">Proof.</div>
<div class="proofscript" id="proof36">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="bpf.comm.State.html#upd_flag">State.upd_flag</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="upd_flag_same_ins_len">upd_flag_same_ins_len</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">st0</span> <span class="id">f</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.comm.State.html#ins_len">ins_len</a></span> <span class="id">st0</span> = <span class="id"><a href="bpf.comm.State.html#ins_len">ins_len</a></span> (<span class="id"><a href="bpf.comm.State.html#upd_flag">State.upd_flag</a></span> <span class="id">f</span> <span class="id">st0</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof37')">Proof.</div>
<div class="proofscript" id="proof37">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="bpf.comm.State.html#upd_flag">State.upd_flag</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="upd_unchanged_on">upd_unchanged_on</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">st</span> <span class="id">m0</span> <span class="id">m1</span> {<span class="id">S</span>:<span class="id"><a href="bpf.simulation.MatchState.html#special_blocks">special_blocks</a></span>} <span class="id">chunk</span> <span class="id">ofs</span> <span class="id">vl</span><br/>
&nbsp;&nbsp;(<span class="id">Hst</span>    : <span class="id"><a href="bpf.simulation.MatchState.html#match_state">match_state</a></span>  <span class="id">st</span> <span class="id">m0</span>)<br/>
&nbsp;&nbsp;(<span class="id">Hstore</span> : <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.store">Mem.store</a></span> <span class="id">chunk</span> <span class="id">m0</span> <span class="id"><a href="bpf.simulation.MatchState.html#st_blk">st_blk</a></span> <span class="id">ofs</span> <span class="id">vl</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m1</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.unchanged_on">Mem.unchanged_on</a></span> (<span class="kwd">fun</span> <span class="id">b</span> <span class="id">_</span> =&gt; <span class="id">b</span> &lt;&gt; <span class="id"><a href="bpf.simulation.MatchState.html#st_blk">st_blk</a></span> /\ <span class="id">b</span> &lt;&gt; <span class="id"><a href="bpf.simulation.MatchState.html#mrs_blk">mrs_blk</a></span> /\ <span class="id">b</span> &lt;&gt; <span class="id"><a href="bpf.simulation.MatchState.html#ins_blk">ins_blk</a></span>) <span class="id">m0</span> <span class="id">m1</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof38')">Proof.</div>
<div class="proofscript" id="proof38">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hst</span>. <span class="comment">(*<br/>
&nbsp;&nbsp;destruct&nbsp;minj0.<br/>
&nbsp;&nbsp;clear&nbsp;-&nbsp;mi_inj&nbsp;mi_freeblocks&nbsp;minvalid0&nbsp;munchange0&nbsp;mByte0&nbsp;Hstore.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.store_unchanged_on">Mem.store_unchanged_on</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hstore</span>.<br/>
&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H0</span> <span class="kwd">as</span> (<span class="id">H0</span> &amp; <span class="id">_</span>).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H0</span>; <span class="tactic">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="upd_preserves_match_list_ins">upd_preserves_match_list_ins</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span> <span class="id">chunk</span> <span class="id">m0</span> <span class="id">m1</span> <span class="id">st_blk</span> <span class="id">ins_blk</span> <span class="id">ofs0</span> <span class="id">vl</span><br/>
&nbsp;&nbsp;(<span class="id">Hstore</span> : <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.store">Mem.store</a></span> <span class="id">chunk</span> <span class="id">m0</span> <span class="id">st_blk</span> <span class="id">ofs0</span> <span class="id">vl</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m1</span>)<br/>
&nbsp;&nbsp;(<span class="id">mem_regs</span> : <span class="id"><a href="bpf.simulation.MatchState.html#match_list_ins">match_list_ins</a></span> <span class="id">m0</span> <span class="id">ins_blk</span> <span class="id">l</span>)<br/>
&nbsp;&nbsp;(<span class="id">Hneq_blk</span> : <span class="id">st_blk</span> &lt;&gt; <span class="id">ins_blk</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.simulation.MatchState.html#match_list_ins">match_list_ins</a></span> <span class="id">m1</span> <span class="id">ins_blk</span> <span class="id">l</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof39')">Proof.</div>
<div class="proofscript" id="proof39">
&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">l</span>.<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="bpf.simulation.MatchState.html#match_list_ins">match_list_ins</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">lia</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="bpf.simulation.MatchState.html#match_list_ins">match_list_ins</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">mem_regs0</span> <span class="id">i</span> <span class="id">H</span>).<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.loadv">Mem.loadv</a></span> <span class="kwd">in</span> *. <span class="comment">(*<br/>
&nbsp;&nbsp;destruct&nbsp;mem_regs0&nbsp;as&nbsp;(mem_regs0&nbsp;&amp;&nbsp;Hdst&nbsp;&amp;&nbsp;Hsrc).&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">mem_regs0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.load_store_other">Mem.load_store_other</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="comment">(*<br/>
&nbsp;&nbsp;split.<br/>
&nbsp;&nbsp;eapply&nbsp;Mem.load_store_other;&nbsp;eauto.<br/>
&nbsp;&nbsp;split;&nbsp;assumption.&nbsp;*)</span><br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="upd_preserves_match_list_region">upd_preserves_match_list_region</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span> <span class="id">chunk</span> <span class="id">m0</span> <span class="id">m1</span> <span class="id">st_blk</span> <span class="id">mrs_blk</span> <span class="id">ins_blk</span> <span class="id">b</span> <span class="id">ofs0</span> <span class="id">vl</span><br/>
&nbsp;&nbsp;(<span class="id">Hstore</span> : <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.store">Mem.store</a></span> <span class="id">chunk</span> <span class="id">m0</span> <span class="id">b</span> <span class="id">ofs0</span> <span class="id">vl</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m1</span>)<br/>
&nbsp;&nbsp;(<span class="id">mem_regs</span> : <span class="id"><a href="bpf.simulation.MatchState.html#match_list_region">match_list_region</a></span> <span class="id">m0</span> <span class="id">st_blk</span> <span class="id">mrs_blk</span> <span class="id">ins_blk</span> <span class="id">l</span>)<br/>
&nbsp;&nbsp;(<span class="id">Hneq_blk</span> : <span class="id">b</span> &lt;&gt; <span class="id">mrs_blk</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.simulation.MatchState.html#match_list_region">match_list_region</a></span> <span class="id">m1</span> <span class="id">st_blk</span> <span class="id">mrs_blk</span> <span class="id">ins_blk</span> <span class="id">l</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof40')">Proof.</div>
<div class="proofscript" id="proof40">
&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">l</span>.<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>;<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="bpf.simulation.MatchState.html#match_list_region">match_list_region</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="id">lia</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="bpf.simulation.MatchState.html#match_region_at_ofs">match_region_at_ofs</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">mem_regs0</span> <span class="id">i</span> <span class="id">H</span>).<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">mem_regs0</span> <span class="kwd">as</span>  ((<span class="id">vl0</span> &amp; <span class="id">Hload0</span> &amp; <span class="id">Heq0</span>) &amp; (<span class="id">vl1</span> &amp; <span class="id">Hload1</span> &amp; <span class="id">Heq1</span>) &amp; (<span class="id">vl2</span> &amp; <span class="id">Hload2</span> &amp; <span class="id">Heq2</span>) &amp; (<span class="id">blk3</span> &amp; <span class="id">Hload3</span> &amp; <span class="id">Heq_ptr</span>)).<br/>
<br/>
&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">vl0</span>; <span class="tactic">rewrite</span> &lt;- <span class="id">Hload0</span>; <span class="tactic">split</span>; [<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.load_store_other">Mem.load_store_other</a></span>; <span class="tactic">eauto</span> | <span class="tactic">assumption</span>].<br/>
<br/>
&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">vl1</span>; <span class="tactic">rewrite</span> &lt;- <span class="id">Hload1</span>; <span class="tactic">split</span>; [<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.load_store_other">Mem.load_store_other</a></span>; <span class="tactic">eauto</span> | <span class="tactic">assumption</span>].<br/>
<br/>
&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">vl2</span>; <span class="tactic">rewrite</span> &lt;- <span class="id">Hload2</span>; <span class="tactic">split</span>; [<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.load_store_other">Mem.load_store_other</a></span>; <span class="tactic">eauto</span> | <span class="tactic">assumption</span>].<br/>
<br/>
&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">blk3</span>; <span class="tactic">rewrite</span> &lt;- <span class="id">Hload3</span>; <span class="tactic">split</span>; [<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.load_store_other">Mem.load_store_other</a></span>; <span class="tactic">eauto</span> | ].<br/>
&nbsp;&nbsp;<span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.store_valid_block_1">Mem.store_valid_block_1</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="upd_reg_preserves_match_state">upd_reg_preserves_match_state</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">st0</span> <span class="id">st1</span> <span class="id">m0</span> <span class="id">m1</span> {<span class="id">S</span>:<span class="id"><a href="bpf.simulation.MatchState.html#special_blocks">special_blocks</a></span>} <span class="id">r</span> <span class="id">vl</span><br/>
&nbsp;&nbsp;(<span class="id">Hst</span>    : <span class="id"><a href="bpf.simulation.MatchState.html#match_state">match_state</a></span>  <span class="id">st0</span> <span class="id">m0</span>)<br/>
&nbsp;&nbsp;(<span class="id">Hst1</span>   : <span class="id"><a href="bpf.comm.State.html#upd_reg">State.upd_reg</a></span> <span class="id">r</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Vlong">Vlong</a></span> <span class="id">vl</span>) <span class="id">st0</span> = <span class="id">st1</span>)<br/>
&nbsp;&nbsp;(<span class="id">Hstore</span> : <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.store">Mem.store</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.AST.html#Mint64">AST.Mint64</a></span> <span class="id">m0</span> <span class="id"><a href="bpf.simulation.MatchState.html#st_blk">st_blk</a></span> (8 + 8 * <span class="id">id_of_reg</span> <span class="id">r</span>) (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Vlong">Vlong</a></span> <span class="id">vl</span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m1</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.simulation.MatchState.html#match_state">match_state</a></span>  <span class="id">st1</span> <span class="id">m1</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof41')">Proof.</div>
<div class="proofscript" id="proof41">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">Hst</span>' := <span class="id">Hst</span>).<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hst</span>'.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">unfold</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.loadv">Mem.loadv</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="bpf.simulation.MatchState.html#upd_reg_same_mem">upd_reg_same_mem</a></span> <span class="id">_</span> <span class="id">r</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Vlong">Vlong</a></span> <span class="id">vl</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hunchanged_on</span>': <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.unchanged_on">Mem.unchanged_on</a></span> (<span class="kwd">fun</span> (<span class="id">b</span> : <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#block">block</a></span>) (<span class="id">_</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) =&gt; <span class="id">b</span> &lt;&gt; <span class="id"><a href="bpf.simulation.MatchState.html#st_blk">st_blk</a></span> /\ <span class="id">b</span> &lt;&gt; <span class="id"><a href="bpf.simulation.MatchState.html#mrs_blk">mrs_blk</a></span> /\ <span class="id">b</span> &lt;&gt; <span class="id"><a href="bpf.simulation.MatchState.html#ins_blk">ins_blk</a></span>) <span class="id">m0</span> <span class="id">m1</span>). {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.store_unchanged_on">Mem.store_unchanged_on</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H0</span> <span class="kwd">as</span> (<span class="id">H0</span> &amp; <span class="id">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H0</span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.unchanged_on_trans">Mem.unchanged_on_trans</a></span> <span class="kwd">with</span>(<span class="id">m2</span>:= <span class="id">m0</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="bpf.simulation.MatchState.html#upd_reg_same_pc">upd_reg_same_pc</a></span> <span class="id">_</span> <span class="id">r</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Vlong">Vlong</a></span> <span class="id">vl</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">mpc0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.load_store_other">Mem.load_store_other</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">right</span>; <span class="tactic">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">id_of_reg</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">fold</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Integers.html#Ptrofs.unsigned_zero">Ptrofs.unsigned_zero</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">r</span>; <span class="tactic">try</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="bpf.simulation.MatchState.html#upd_reg_same_flag">upd_reg_same_flag</a></span> <span class="id">_</span> <span class="id">r</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Vlong">Vlong</a></span> <span class="id">vl</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">mflags0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.load_store_other">Mem.load_store_other</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">right</span>; <span class="tactic">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="bpf.clightlogic.CommonLemma.html#Ptrofs_unsigned_repr_n">Ptrofs_unsigned_repr_n</a></span>; [| <span class="tactic">try</span> <span class="tactic">simpl</span>; <span class="id">lia</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">id_of_reg</span>; <span class="tactic">simpl</span>; <span class="tactic">destruct</span> <span class="id">r</span>; <span class="tactic">try</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">unfold</span> <span class="id"><a href="bpf.simulation.MatchState.html#match_registers">match_registers</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">mregs0</span> <span class="id">r0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">mregs0</span> <span class="kwd">as</span> (<span class="id">vl0</span> &amp; <span class="id">mregs0</span> &amp; <span class="id">mregs1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.loadv">Mem.loadv</a></span>, <span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Integers.html#Ptrofs.add">Ptrofs.add</a></span> <span class="kwd">in</span> *.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="bpf.clightlogic.CommonLemma.html#Hreg_eq">Hreg_eq</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="bpf.comm.Regs.html#reg_eq">reg_eq</a></span> <span class="id">r0</span> <span class="id">r</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="docright">(* case: r0 = r  *)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">vl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hload_result</span>: <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Val.load_result">Val.load_result</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.AST.html#Mint64">Mint64</a></span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Vlong">Vlong</a></span> <span class="id">vl</span>) = (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Vlong">Vlong</a></span> <span class="id">vl</span>)). {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">Hload_result</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.load_store_same">Mem.load_store_same</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="bpf.comm.State.html#upd_reg">State.upd_reg</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="bpf.clightlogic.CommonLemma.html#eval_upd_regmap_same">eval_upd_regmap_same</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">vl0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="bpf.comm.State.html#upd_reg">State.upd_reg</a></span>, <span class="id"><a href="bpf.comm.State.html#regs_st">regs_st</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="bpf.clightlogic.CommonLemma.html#eval_upd_regmap_other">eval_upd_regmap_other</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">mregs1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">mregs0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.load_store_other">Mem.load_store_other</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="tactic">assumption</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">r0</span>, <span class="id">r</span>; <span class="tactic">simpl</span>; [<span class="tactic">try</span> (<span class="id">exfalso</span>; <span class="tactic">apply</span> <span class="id">n</span>; <span class="tactic">reflexivity</span>) || (<span class="tactic">try</span> <span class="tactic">left</span>; <span class="id">lia</span>) || (<span class="tactic">try</span> <span class="tactic">right</span>; <span class="id">lia</span>) ..].<br/>
&nbsp;&nbsp;- <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">mins_len0</span> <span class="kwd">as</span> (<span class="id">mins_len0</span> &amp; <span class="id">mins_len1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; [| <span class="tactic">assumption</span>].<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="bpf.clightlogic.CommonLemma.html#Ptrofs_unsigned_repr_n">Ptrofs_unsigned_repr_n</a></span> <span class="kwd">in</span> *; <span class="tactic">try</span> (<span class="tactic">simpl</span>; <span class="id">lia</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">mins_len0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.load_store_other">Mem.load_store_other</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">right</span>; <span class="tactic">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">id_of_reg</span>, <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memdata.html#size_chunk">size_chunk</a></span>; <span class="tactic">destruct</span> <span class="id">r</span>; <span class="id">lia</span>.<br/>
&nbsp;&nbsp;- <span class="docright">(* match_ins  *)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="bpf.simulation.MatchState.html#match_ins">match_ins</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="bpf.simulation.MatchState.html#match_ins">match_ins</a></span> <span class="kwd">in</span> <span class="id">mins0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">mins0</span> <span class="kwd">as</span> (<span class="id">Hload</span> &amp; <span class="id">mins_len</span> &amp; <span class="id">mins_max</span> &amp; <span class="id">mins0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">Hload</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.load_store_other">Mem.load_store_other</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">right</span>; <span class="tactic">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="bpf.clightlogic.CommonLemma.html#Ptrofs_unsigned_repr_n">Ptrofs_unsigned_repr_n</a></span> <span class="kwd">in</span> *; <span class="tactic">try</span> (<span class="tactic">simpl</span>; <span class="id">lia</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">id_of_reg</span>, <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memdata.html#size_chunk">size_chunk</a></span>; <span class="tactic">destruct</span> <span class="id">r</span>; <span class="id">lia</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; [<span class="tactic">assumption</span> | ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; [<span class="tactic">assumption</span> | ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hins_eq</span> : <span class="id"><a href="bpf.comm.State.html#ins">ins</a></span> (<span class="id"><a href="bpf.comm.State.html#upd_reg">State.upd_reg</a></span> <span class="id">r</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Vlong">Vlong</a></span> <span class="id">vl</span>) <span class="id">st0</span>) = <span class="id"><a href="bpf.comm.State.html#ins">ins</a></span> <span class="id">st0</span>). {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="bpf.comm.State.html#upd_reg">State.upd_reg</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hins_eq</span>; <span class="tactic">clear</span> <span class="id">Hins_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">minvalid0</span> <span class="kwd">as</span> (<span class="id">_</span> &amp; <span class="id">minvalid0</span> &amp; <span class="id">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="bpf.simulation.MatchState.html#upd_preserves_match_list_ins">upd_preserves_match_list_ins</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="bpf.simulation.MatchState.html#upd_reg_same_mrs_num">upd_reg_same_mrs_num</a></span> <span class="id">_</span> <span class="id">r</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Vlong">Vlong</a></span> <span class="id">vl</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">mmrs_num0</span> <span class="kwd">as</span> (<span class="id">Hload</span> &amp; <span class="id">Hge</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; [| <span class="tactic">assumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">Hload</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.load_store_other">Mem.load_store_other</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">right</span>; <span class="tactic">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memdata.html#size_chunk">size_chunk</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hle_104</span>: 8 + 8 * <span class="id">id_of_reg</span> <span class="id">r</span> + 8 &lt;= 104). { <span class="tactic">unfold</span> <span class="id">id_of_reg</span>; <span class="tactic">destruct</span> <span class="id">r</span>; <span class="id">lia</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="bpf.clightlogic.CommonLemma.html#Ptrofs_unsigned_repr_n">Ptrofs_unsigned_repr_n</a></span>; [| <span class="tactic">try</span> <span class="tactic">simpl</span>; <span class="id">lia</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">unfold</span> <span class="id"><a href="bpf.simulation.MatchState.html#match_regions">match_regions</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">mem_regs0</span> <span class="kwd">as</span> (<span class="id">Hload</span> &amp; <span class="id">mrs_len</span> &amp; <span class="id">mrs_max</span> &amp; <span class="id">mem_regs0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="bpf.simulation.MatchState.html#upd_reg_same_mrs">upd_reg_same_mrs</a></span> <span class="id">_</span> <span class="id">r</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Vlong">Vlong</a></span> <span class="id">vl</span>)).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">Hload</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.load_store_other">Mem.load_store_other</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">right</span>; <span class="tactic">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="bpf.clightlogic.CommonLemma.html#Ptrofs_unsigned_repr_n">Ptrofs_unsigned_repr_n</a></span> <span class="kwd">in</span> *; <span class="tactic">try</span> (<span class="tactic">simpl</span>; <span class="id">lia</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">id_of_reg</span>, <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memdata.html#size_chunk">size_chunk</a></span>; <span class="tactic">destruct</span> <span class="id">r</span>; <span class="id">lia</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; [<span class="tactic">assumption</span> | ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; [<span class="tactic">assumption</span> | ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">minvalid0</span> <span class="kwd">as</span> (<span class="id">_</span> &amp; <span class="id">minvalid0</span> &amp; <span class="id">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="bpf.simulation.MatchState.html#upd_preserves_match_list_region">upd_preserves_match_list_region</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intuition</span>.<br/>
<br/>
&nbsp;&nbsp;- <span class="tactic">clear</span> - <span class="id">mperm0</span> <span class="id">Hstore</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.range_perm">Mem.range_perm</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">mperm0</span> <span class="kwd">as</span> (<span class="id">mperm0</span> &amp; <span class="id">mperm1</span> &amp; <span class="id">mperm2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.perm_store_1">Mem.perm_store_1</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Hstore</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">mperm0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="bpf.simulation.MatchState.html#size_of_state">size_of_state</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="bpf.simulation.MatchState.html#upd_reg_same_mrs_num">upd_reg_same_mrs_num</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.perm_store_1">Mem.perm_store_1</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Hstore</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">mperm1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="bpf.simulation.MatchState.html#size_of_state">size_of_state</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="bpf.simulation.MatchState.html#upd_reg_same_mrs_num">upd_reg_same_mrs_num</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.perm_store_1">Mem.perm_store_1</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Hstore</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">mperm2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="bpf.simulation.MatchState.html#size_of_state">size_of_state</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="bpf.simulation.MatchState.html#upd_reg_same_ins_len">upd_reg_same_ins_len</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="bpf.simulation.MatchState.html#upd_reg_same_mem">upd_reg_same_mem</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H14</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.store_valid_block_2">Mem.store_valid_block_2</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="upd_pc_preserves_match_state">upd_pc_preserves_match_state</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">st0</span> <span class="id">st1</span> <span class="id">m0</span> <span class="id">m1</span> {<span class="id">S</span>:<span class="id"><a href="bpf.simulation.MatchState.html#special_blocks">special_blocks</a></span>} <span class="id">pc</span><br/>
&nbsp;&nbsp;(<span class="id">Hst</span>    : <span class="id"><a href="bpf.simulation.MatchState.html#match_state">match_state</a></span>  <span class="id">st0</span> <span class="id">m0</span>)<br/>
&nbsp;&nbsp;(<span class="id">Hst1</span>   : <span class="id"><a href="bpf.comm.State.html#upd_pc">State.upd_pc</a></span> <span class="id">pc</span> <span class="id">st0</span> = <span class="id">st1</span>)<br/>
&nbsp;&nbsp;(<span class="id">Hstore</span> : <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.store">Mem.store</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.AST.html#Mint32">AST.Mint32</a></span> <span class="id">m0</span> <span class="id"><a href="bpf.simulation.MatchState.html#st_blk">st_blk</a></span> 0 (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Vint">Vint</a></span> <span class="id">pc</span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m1</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.simulation.MatchState.html#match_state">match_state</a></span>  <span class="id">st1</span> <span class="id">m1</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof42')">Proof.</div>
<div class="proofscript" id="proof42">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">Hst</span>' := <span class="id">Hst</span>).<br/>
&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hst</span>' <span class="kwd">as</span> (<span class="id">Hunchanged_on</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="bpf.simulation.MatchState.html#upd_pc_same_mem">upd_pc_same_mem</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hunchanged_on</span>': <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.unchanged_on">Mem.unchanged_on</a></span> (<span class="kwd">fun</span> (<span class="id">b</span> : <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#block">block</a></span>) (<span class="id">_</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) =&gt; <span class="id">b</span> &lt;&gt; <span class="id"><a href="bpf.simulation.MatchState.html#st_blk">st_blk</a></span> /\ <span class="id">b</span> &lt;&gt; <span class="id"><a href="bpf.simulation.MatchState.html#mrs_blk">mrs_blk</a></span> /\ <span class="id">b</span> &lt;&gt; <span class="id"><a href="bpf.simulation.MatchState.html#ins_blk">ins_blk</a></span>) <span class="id">m0</span> <span class="id">m1</span>). {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.store_unchanged_on">Mem.store_unchanged_on</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H0</span> <span class="kwd">as</span>(<span class="id">H0</span> &amp; <span class="id">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H0</span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.unchanged_on_trans">Mem.unchanged_on_trans</a></span> <span class="kwd">with</span>(<span class="id">m2</span>:= <span class="id">m0</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hst</span>' <span class="kwd">as</span> (<span class="id">_</span> , <span class="id">Hpc</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.loadv">Mem.loadv</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">fold</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Integers.html#Ptrofs.unsigned_zero">Ptrofs.unsigned_zero</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.load_store_same">Mem.load_store_same</a></span> <span class="kwd">in</span> <span class="id">Hstore</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hstore</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Val.load_result">Val.load_result</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hst</span>' <span class="kwd">as</span> (<span class="id">_</span> , <span class="id">_</span>, <span class="id">Hflag</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="bpf.simulation.MatchState.html#upd_pc_same_flag">upd_pc_same_flag</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">Hflag</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.load_store_other">Mem.load_store_other</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Hstore</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">right</span>; <span class="tactic">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="bpf.clightlogic.CommonLemma.html#Ptrofs_unsigned_repr_n">Ptrofs_unsigned_repr_n</a></span>; [| <span class="tactic">try</span> <span class="tactic">simpl</span>; <span class="id">lia</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hst</span>' <span class="kwd">as</span> (<span class="id">_</span> , <span class="id">_</span>, <span class="id">_</span>, <span class="id">Hregs</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="bpf.simulation.MatchState.html#upd_pc_same_regs">upd_pc_same_regs</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="bpf.simulation.MatchState.html#match_registers">match_registers</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">Hregs</span> <span class="id">r</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hregs</span> <span class="kwd">as</span> (<span class="id">vl</span> &amp; <span class="id">Hload</span> &amp; <span class="id">Hvl_eq</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">vl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; [| <span class="tactic">assumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">Hload</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.loadv">Mem.loadv</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.load_store_other">Mem.load_store_other</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Hstore</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">right</span>; <span class="tactic">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Integers.html#Ptrofs.add">Ptrofs.add</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memdata.html#size_chunk">size_chunk</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="bpf.clightlogic.CommonLemma.html#Ptrofs_unsigned_repr_n">Ptrofs_unsigned_repr_n</a></span> <span class="kwd">in</span> *; <span class="tactic">try</span> (<span class="tactic">simpl</span>; <span class="id">lia</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="bpf.clightlogic.CommonLemma.html#Ptrofs_unsigned_repr_id_of_reg">Ptrofs_unsigned_repr_id_of_reg</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="bpf.clightlogic.CommonLemma.html#Ptrofs_unsigned_repr_n">Ptrofs_unsigned_repr_n</a></span> <span class="kwd">in</span> *; <span class="tactic">try</span> (<span class="tactic">simpl</span>; <span class="id">lia</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">id_of_reg</span>; <span class="tactic">destruct</span> <span class="id">r</span>; <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="bpf.clightlogic.CommonLemma.html#Ptrofs_unsigned_repr_n">Ptrofs_unsigned_repr_n</a></span> <span class="kwd">in</span> *; <span class="tactic">try</span> (<span class="tactic">simpl</span>; <span class="id">lia</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="bpf.clightlogic.CommonLemma.html#Ptrofs_unsigned_repr_n">Ptrofs_unsigned_repr_n</a></span> <span class="kwd">with</span> (<span class="id">n</span>:= 8 * <span class="id">id_of_reg</span> <span class="id">r</span>) <span class="kwd">in</span> *; <span class="tactic">try</span> (<span class="tactic">simpl</span>; <span class="id">lia</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>: <span class="tactic">unfold</span> <span class="id">id_of_reg</span>; <span class="tactic">destruct</span> <span class="id">r</span>; <span class="id">lia</span>.<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hst</span>' <span class="kwd">as</span> (<span class="id">_</span> , <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, (<span class="id">Hins_len</span> &amp; <span class="id">Hge</span>), <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="bpf.simulation.MatchState.html#upd_pc_same_ins_len">upd_pc_same_ins_len</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; [| <span class="tactic">assumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">Hins_len</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.load_store_other">Mem.load_store_other</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">right</span>; <span class="tactic">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="bpf.clightlogic.CommonLemma.html#Ptrofs_unsigned_repr_n">Ptrofs_unsigned_repr_n</a></span> <span class="kwd">in</span> *; <span class="tactic">try</span> (<span class="tactic">simpl</span>; <span class="id">lia</span>).<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hst</span>' <span class="kwd">as</span> (<span class="id">_</span> , <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">Hins</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, (<span class="id">_</span> &amp; <span class="id">Hneq_blk</span> &amp; <span class="id">_</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="bpf.simulation.MatchState.html#match_ins">match_ins</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hins</span> <span class="kwd">as</span> (<span class="id">Hload</span> &amp; <span class="id">Hins_len</span> &amp; <span class="id">Hins_max</span> &amp; <span class="id">Hins</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="bpf.simulation.MatchState.html#upd_pc_same_ins">upd_pc_same_ins</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="bpf.simulation.MatchState.html#upd_pc_same_ins_len">upd_pc_same_ins_len</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">Hload</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.load_store_other">Mem.load_store_other</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">right</span>; <span class="tactic">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="bpf.clightlogic.CommonLemma.html#Ptrofs_unsigned_repr_n">Ptrofs_unsigned_repr_n</a></span> <span class="kwd">in</span> *; <span class="tactic">try</span> (<span class="tactic">simpl</span>; <span class="id">lia</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; [<span class="tactic">assumption</span> |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; [<span class="tactic">assumption</span> |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="bpf.simulation.MatchState.html#upd_preserves_match_list_ins">upd_preserves_match_list_ins</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hst</span>' <span class="kwd">as</span> (<span class="id">_</span> , <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, (<span class="id">Hmrs_len</span> &amp; <span class="id">Hge</span>), <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="bpf.simulation.MatchState.html#upd_pc_same_mrs_num">upd_pc_same_mrs_num</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; [| <span class="tactic">assumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">Hmrs_len</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.load_store_other">Mem.load_store_other</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">right</span>; <span class="tactic">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="bpf.clightlogic.CommonLemma.html#Ptrofs_unsigned_repr_n">Ptrofs_unsigned_repr_n</a></span> <span class="kwd">in</span> *; <span class="tactic">try</span> (<span class="tactic">simpl</span>; <span class="id">lia</span>).<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hst</span>' <span class="kwd">as</span> (<span class="id">_</span> , <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">Hmrs</span>, <span class="id">_</span>, (<span class="id">_</span> &amp; <span class="id">Hneq_blk</span> &amp; <span class="id">_</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="bpf.simulation.MatchState.html#match_regions">match_regions</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="bpf.simulation.MatchState.html#upd_pc_same_mrs">upd_pc_same_mrs</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="bpf.simulation.MatchState.html#upd_pc_same_mrs_num">upd_pc_same_mrs_num</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hmrs</span> <span class="kwd">as</span> (<span class="id">Hload</span> &amp; <span class="id">Hmrs_len</span> &amp; <span class="id">Hmrs_ge</span> &amp; <span class="id">Hmrs</span>).<br/>
<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">Hload</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.load_store_other">Mem.load_store_other</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">right</span>; <span class="tactic">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="bpf.clightlogic.CommonLemma.html#Ptrofs_unsigned_repr_n">Ptrofs_unsigned_repr_n</a></span> <span class="kwd">in</span> *; <span class="tactic">try</span> (<span class="tactic">simpl</span>; <span class="id">lia</span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; [<span class="tactic">assumption</span>| ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; [<span class="tactic">assumption</span>| ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="bpf.simulation.MatchState.html#upd_preserves_match_list_region">upd_preserves_match_list_region</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hst</span>' <span class="kwd">as</span> (<span class="id">_</span> , <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">Hperm</span>, <span class="id">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="bpf.simulation.MatchState.html#size_of_state">size_of_state</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="bpf.simulation.MatchState.html#upd_pc_same_mrs_num">upd_pc_same_mrs_num</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.range_perm">Mem.range_perm</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hperm</span> <span class="kwd">as</span> (<span class="id">Hperm0</span> &amp; <span class="id">Hperm1</span> &amp; <span class="id">Hperm2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.perm_store_1">Mem.perm_store_1</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Hstore</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Hperm0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.perm_store_1">Mem.perm_store_1</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Hstore</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Hperm1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.perm_store_1">Mem.perm_store_1</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Hstore</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Hperm2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hst</span>' <span class="kwd">as</span> (<span class="id">_</span> , <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">Hvalid</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="bpf.simulation.MatchState.html#upd_pc_same_mem">upd_pc_same_mem</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H3</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.store_valid_block_2">Mem.store_valid_block_2</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="upd_flag_preserves_match_state">upd_flag_preserves_match_state</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">st0</span> <span class="id">st1</span> <span class="id">m0</span> <span class="id">m1</span> {<span class="id">S</span>: <span class="id"><a href="bpf.simulation.MatchState.html#special_blocks">special_blocks</a></span>} <span class="id">flag</span><br/>
&nbsp;&nbsp;(<span class="id">Hst</span>    : <span class="id"><a href="bpf.simulation.MatchState.html#match_state">match_state</a></span>  <span class="id">st0</span> <span class="id">m0</span>)<br/>
&nbsp;&nbsp;(<span class="id">Hst1</span>   : <span class="id"><a href="bpf.comm.State.html#upd_flag">State.upd_flag</a></span> <span class="id">flag</span> <span class="id">st0</span> = <span class="id">st1</span>)<br/>
&nbsp;&nbsp;(<span class="id">Hstore</span> : <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.store">Mem.store</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.AST.html#Mint32">AST.Mint32</a></span> <span class="id">m0</span> <span class="id"><a href="bpf.simulation.MatchState.html#st_blk">st_blk</a></span> 4 (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Vint">Vint</a></span> (<span class="id">int_of_flag</span> <span class="id">flag</span>)) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m1</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.simulation.MatchState.html#match_state">match_state</a></span>  <span class="id">st1</span> <span class="id">m1</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof43')">Proof.</div>
<div class="proofscript" id="proof43">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">Hst</span>' := <span class="id">Hst</span>).<br/>
&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hst</span>' <span class="kwd">as</span> (<span class="id">Hunchanged_on</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="bpf.simulation.MatchState.html#upd_flag_same_mem">upd_flag_same_mem</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hunchanged_on</span>': <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.unchanged_on">Mem.unchanged_on</a></span> (<span class="kwd">fun</span> (<span class="id">b</span> : <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#block">block</a></span>) (<span class="id">_</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) =&gt; <span class="id">b</span> &lt;&gt; <span class="id"><a href="bpf.simulation.MatchState.html#st_blk">st_blk</a></span> /\ <span class="id">b</span> &lt;&gt; <span class="id"><a href="bpf.simulation.MatchState.html#mrs_blk">mrs_blk</a></span> /\ <span class="id">b</span> &lt;&gt; <span class="id"><a href="bpf.simulation.MatchState.html#ins_blk">ins_blk</a></span>) <span class="id">m0</span> <span class="id">m1</span>). {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.store_unchanged_on">Mem.store_unchanged_on</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">H0</span>; <span class="tactic">destruct</span> <span class="id">H0</span> <span class="kwd">as</span> (<span class="id">H0</span> &amp; <span class="id">_</span>); <span class="tactic">apply</span> <span class="id">H0</span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.unchanged_on_trans">Mem.unchanged_on_trans</a></span> <span class="kwd">with</span>(<span class="id">m2</span>:= <span class="id">m0</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hst</span>' <span class="kwd">as</span> (<span class="id">_</span> , <span class="id">Hpc</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="bpf.simulation.MatchState.html#upd_flag_same_pc">upd_flag_same_pc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">Hpc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.load_store_other">Mem.load_store_other</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Hstore</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">right</span>; <span class="tactic">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">fold</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>; <span class="tactic">rewrite</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Integers.html#Ptrofs.unsigned_zero">Ptrofs.unsigned_zero</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hst</span>' <span class="kwd">as</span> (<span class="id">_</span> , <span class="id">_</span>, <span class="id">Hflag</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.loadv">Mem.loadv</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="bpf.clightlogic.CommonLemma.html#Ptrofs_unsigned_repr_n">Ptrofs_unsigned_repr_n</a></span> <span class="kwd">in</span> *; <span class="tactic">try</span> (<span class="tactic">simpl</span>; <span class="id">lia</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.load_store_same">Mem.load_store_same</a></span> <span class="kwd">in</span> <span class="id">Hstore</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hstore</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Val.load_result">Val.load_result</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hst</span>' <span class="kwd">as</span> (<span class="id">_</span> , <span class="id">_</span>, <span class="id">_</span>, <span class="id">Hregs</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="bpf.simulation.MatchState.html#upd_flag_same_regs">upd_flag_same_regs</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="bpf.simulation.MatchState.html#match_registers">match_registers</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">Hregs</span> <span class="id">r</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hregs</span> <span class="kwd">as</span> (<span class="id">vl</span> &amp; <span class="id">Hload</span> &amp; <span class="id">Hvl_eq</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">vl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; [| <span class="tactic">assumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">Hload</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.loadv">Mem.loadv</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.load_store_other">Mem.load_store_other</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Hstore</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">right</span>; <span class="tactic">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Integers.html#Ptrofs.add">Ptrofs.add</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memdata.html#size_chunk">size_chunk</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="bpf.clightlogic.CommonLemma.html#Ptrofs_unsigned_repr_n">Ptrofs_unsigned_repr_n</a></span> <span class="kwd">in</span> *; <span class="tactic">try</span> (<span class="tactic">simpl</span>; <span class="id">lia</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="bpf.clightlogic.CommonLemma.html#Ptrofs_unsigned_repr_n">Ptrofs_unsigned_repr_n</a></span> <span class="kwd">in</span> *; <span class="tactic">try</span> (<span class="tactic">simpl</span>; <span class="id">lia</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="bpf.clightlogic.CommonLemma.html#Ptrofs_unsigned_repr_n">Ptrofs_unsigned_repr_n</a></span> <span class="kwd">in</span> *; <span class="tactic">try</span> (<span class="tactic">simpl</span>; <span class="id">lia</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;4:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="bpf.clightlogic.CommonLemma.html#Ptrofs_unsigned_repr_n">Ptrofs_unsigned_repr_n</a></span> <span class="kwd">in</span> *; <span class="tactic">try</span> (<span class="tactic">simpl</span>; <span class="id">lia</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;4:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="bpf.clightlogic.CommonLemma.html#Ptrofs_unsigned_repr_n">Ptrofs_unsigned_repr_n</a></span> <span class="kwd">in</span> *; <span class="tactic">try</span> (<span class="tactic">simpl</span>; <span class="id">lia</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>: <span class="tactic">unfold</span> <span class="id">id_of_reg</span>; <span class="tactic">destruct</span> <span class="id">r</span>; <span class="id">lia</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hst</span>' <span class="kwd">as</span> (<span class="id">_</span> , <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, (<span class="id">Hins_len</span> &amp; <span class="id">Hge</span>), <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="bpf.simulation.MatchState.html#upd_flag_same_ins_len">upd_flag_same_ins_len</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; [| <span class="tactic">assumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">Hins_len</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.load_store_other">Mem.load_store_other</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">right</span>; <span class="tactic">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="bpf.clightlogic.CommonLemma.html#Ptrofs_unsigned_repr_n">Ptrofs_unsigned_repr_n</a></span> <span class="kwd">in</span> *; <span class="tactic">try</span> (<span class="tactic">simpl</span>; <span class="id">lia</span>).<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hst</span>' <span class="kwd">as</span> (<span class="id">_</span> , <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">Hins</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, (<span class="id">_</span> &amp; <span class="id">Hneq_blk</span> &amp; <span class="id">_</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="bpf.simulation.MatchState.html#match_ins">match_ins</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hins</span> <span class="kwd">as</span> (<span class="id">Hload</span> &amp; <span class="id">Hins_len</span> &amp; <span class="id">Hins_max</span> &amp; <span class="id">Hins</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="bpf.simulation.MatchState.html#upd_flag_same_ins">upd_flag_same_ins</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="bpf.simulation.MatchState.html#upd_flag_same_ins_len">upd_flag_same_ins_len</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">Hload</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.load_store_other">Mem.load_store_other</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">right</span>; <span class="tactic">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="bpf.clightlogic.CommonLemma.html#Ptrofs_unsigned_repr_n">Ptrofs_unsigned_repr_n</a></span> <span class="kwd">in</span> *; <span class="tactic">try</span> (<span class="tactic">simpl</span>; <span class="id">lia</span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; [<span class="tactic">assumption</span> |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; [<span class="tactic">assumption</span> |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="bpf.simulation.MatchState.html#upd_preserves_match_list_ins">upd_preserves_match_list_ins</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hst</span>' <span class="kwd">as</span> (<span class="id">_</span> , <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, (<span class="id">Hmrs_len</span> &amp; <span class="id">Hge</span>), <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="bpf.simulation.MatchState.html#upd_flag_same_mrs_num">upd_flag_same_mrs_num</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; [| <span class="tactic">assumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">Hmrs_len</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.load_store_other">Mem.load_store_other</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">right</span>; <span class="tactic">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="bpf.clightlogic.CommonLemma.html#Ptrofs_unsigned_repr_n">Ptrofs_unsigned_repr_n</a></span> <span class="kwd">in</span> *; <span class="tactic">try</span> (<span class="tactic">simpl</span>; <span class="id">lia</span>).<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hst</span>' <span class="kwd">as</span> (<span class="id">_</span> , <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">Hmrs</span>, <span class="id">_</span>, (<span class="id">_</span> &amp; <span class="id">Hneq_blk</span> &amp; <span class="id">_</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="bpf.simulation.MatchState.html#match_regions">match_regions</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="bpf.simulation.MatchState.html#upd_flag_same_mrs">upd_flag_same_mrs</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="bpf.simulation.MatchState.html#upd_flag_same_mrs_num">upd_flag_same_mrs_num</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hmrs</span> <span class="kwd">as</span> (<span class="id">Hload</span> &amp; <span class="id">Hmrs_len</span> &amp; <span class="id">Hmrs_ge</span> &amp; <span class="id">Hmrs</span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">Hload</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.load_store_other">Mem.load_store_other</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">right</span>; <span class="tactic">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="bpf.clightlogic.CommonLemma.html#Ptrofs_unsigned_repr_n">Ptrofs_unsigned_repr_n</a></span> <span class="kwd">in</span> *; <span class="tactic">try</span> (<span class="tactic">simpl</span>; <span class="id">lia</span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; [<span class="tactic">assumption</span>| ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; [<span class="tactic">assumption</span>| ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="bpf.simulation.MatchState.html#upd_preserves_match_list_region">upd_preserves_match_list_region</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hst</span>' <span class="kwd">as</span> (<span class="id">_</span> , <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">Hperm</span>, <span class="id">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="bpf.simulation.MatchState.html#size_of_state">size_of_state</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="bpf.simulation.MatchState.html#upd_flag_same_mrs_num">upd_flag_same_mrs_num</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.range_perm">Mem.range_perm</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hperm</span> <span class="kwd">as</span> (<span class="id">Hperm0</span> &amp; <span class="id">Hperm1</span> &amp; <span class="id">Hperm2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.perm_store_1">Mem.perm_store_1</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Hstore</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Hperm0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.perm_store_1">Mem.perm_store_1</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Hstore</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Hperm1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.perm_store_1">Mem.perm_store_1</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Hstore</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Hperm2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hst</span>' <span class="kwd">as</span> (<span class="id">_</span> , <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">Hvalid</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="bpf.simulation.MatchState.html#upd_flag_same_mem">upd_flag_same_mem</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H3</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.store_valid_block_2">Mem.store_valid_block_2</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="match_state_implies_valid_pointer">match_state_implies_valid_pointer</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span>  {<span class="id">S</span>:<span class="id"><a href="bpf.simulation.MatchState.html#special_blocks">special_blocks</a></span>} <span class="id">st</span> <span class="id">m</span> <span class="id">b</span> <span class="id">ofs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hmatch</span> : <span class="id"><a href="bpf.simulation.MatchState.html#match_state">match_state</a></span>  <span class="id">st</span> <span class="id">m</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hvalid</span> : <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.valid_pointer">Mem.valid_pointer</a></span> (<span class="id"><a href="bpf.comm.State.html#bpf_m">bpf_m</a></span> <span class="id">st</span>) <span class="id">b</span> <span class="id">ofs</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.valid_pointer">Mem.valid_pointer</a></span> <span class="id">m</span> <span class="id">b</span> <span class="id">ofs</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof44')">Proof.</div>
<div class="proofscript" id="proof44">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.valid_pointer_nonempty_perm">Mem.valid_pointer_nonempty_perm</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hmatch</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.perm_unchanged_on">Mem.perm_unchanged_on</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.perm_valid_block">Mem.perm_valid_block</a></span> <span class="kwd">in</span> <span class="id">Hvalid</span>.<br/>
&nbsp;&nbsp;<span class="tactic">clear</span> - <span class="id">minvalid0</span> <span class="id">Hvalid</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">minvalid0</span> <span class="kwd">as</span> ((<span class="id">Hv0</span> &amp; <span class="id">Hv1</span> &amp; <span class="id">Hv2</span>) &amp; <span class="id">H</span>).<br/>
&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">all</span>: <span class="tactic">eapply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.valid_not_valid_diff">Mem.valid_not_valid_diff</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="match_state_implies_loadv_equal">match_state_implies_loadv_equal</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">S</span>: <span class="id"><a href="bpf.simulation.MatchState.html#special_blocks">special_blocks</a></span>} <span class="id">st</span> <span class="id">m</span> <span class="id">chunk</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">v</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hmatch</span> : <span class="id"><a href="bpf.simulation.MatchState.html#match_state">match_state</a></span>  <span class="id">st</span> <span class="id">m</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hload</span>: <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.load">Mem.load</a></span> <span class="id">chunk</span> (<span class="id"><a href="bpf.comm.State.html#bpf_m">bpf_m</a></span> <span class="id">st</span>) <span class="id">b</span> <span class="id">ofs</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.load">Mem.load</a></span> <span class="id">chunk</span> <span class="id">m</span> <span class="id">b</span> <span class="id">ofs</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof45')">Proof.</div>
<div class="proofscript" id="proof45">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">Hmatch</span>' := <span class="id">Hmatch</span>).<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hmatch</span>' <span class="kwd">as</span> (<span class="id">Hunchanged</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">Hinvalid</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">Hload</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hinvalid</span> <span class="kwd">as</span> (<span class="id">Hinvalid</span> &amp; <span class="id">_</span> &amp; <span class="id">Hvalid_block</span>).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.load_valid_access">Mem.load_valid_access</a></span> <span class="kwd">in</span> <span class="id">Hload</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hload</span>' : <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.valid_access">Mem.valid_access</a></span> (<span class="id"><a href="bpf.comm.State.html#bpf_m">bpf_m</a></span> <span class="id">st</span>) <span class="id">chunk</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memtype.html#Nonempty">Nonempty</a></span>). {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.valid_access_implies">Mem.valid_access_implies</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">constructor</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.valid_access_valid_block">Mem.valid_access_valid_block</a></span> <span class="kwd">in</span> <span class="id">Hload</span>'; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.load_unchanged_on_1">Mem.load_unchanged_on_1</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intuition</span> <span class="tactic">congruence</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="store_match_state_same">store_match_state_same</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">st1</span> <span class="id">m</span> <span class="id">m1</span> <span class="id">m2</span> <span class="id">chunk</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">addr</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hstore</span> : <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.store">Mem.store</a></span> <span class="id">chunk</span> (<span class="id"><a href="bpf.comm.State.html#bpf_m">bpf_m</a></span> <span class="id">st1</span>) <span class="id">b</span> <span class="id">ofs</span> <span class="id">addr</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hstore_m2</span> : <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.store">Mem.store</a></span> <span class="id">chunk</span> <span class="id">m1</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">addr</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hunchanged_on_contents</span> : <span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Maps.html#ZMap.get">Maps.ZMap.get</a></span> <span class="id">ofs</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Maps.html#PMap.get">Maps.PMap.get</a></span> <span class="id">b</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.mem_contents">Mem.mem_contents</a></span> <span class="id">m1</span>)) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Maps.html#ZMap.get">Maps.ZMap.get</a></span> <span class="id">ofs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Maps.html#PMap.get">Maps.PMap.get</a></span> <span class="id">b</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.mem_contents">Mem.mem_contents</a></span> (<span class="id"><a href="bpf.comm.State.html#bpf_m">bpf_m</a></span> <span class="id">st1</span>)))),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Maps.html#ZMap.get">Maps.ZMap.get</a></span> <span class="id">ofs</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Maps.html#PMap.get">Maps.PMap.get</a></span> <span class="id">b</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.mem_contents">Mem.mem_contents</a></span> <span class="id">m2</span>)) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Maps.html#ZMap.get">Maps.ZMap.get</a></span> <span class="id">ofs</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Maps.html#PMap.get">Maps.PMap.get</a></span> <span class="id">b</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.mem_contents">Mem.mem_contents</a></span> <span class="id">m</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof46')">Proof.</div>
<div class="proofscript" id="proof46">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.store_mem_contents">Mem.store_mem_contents</a></span> <span class="kwd">in</span> <span class="id">Hstore</span> <span class="kwd">as</span> <span class="id">Hcontents0</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.store_mem_contents">Mem.store_mem_contents</a></span> <span class="kwd">in</span> <span class="id">Hstore_m2</span> <span class="kwd">as</span> <span class="id">Hcontents1</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hcontents0</span>, <span class="id">Hcontents1</span>.<br/>
&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Maps.html#PMap.gss">Maps.PMap.gss</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">clear</span> - <span class="id">Hunchanged_on_contents</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memdata.html#encode_val">encode_val</a></span> <span class="id">chunk</span> <span class="id">addr</span>).<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">l</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.setN_other">Mem.setN_other</a></span>; [|<span class="tactic">intros</span>; <span class="id">lia</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.setN_other">Mem.setN_other</a></span>; [|<span class="tactic">intros</span>; <span class="id">lia</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Maps.html#ZMap.gss">Maps.ZMap.gss</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="store_match_state_same_other">store_match_state_same_other</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">st1</span> <span class="id">m</span> <span class="id">m1</span> <span class="id">m2</span> <span class="id">chunk</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">ofs0</span> <span class="id">addr</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hstore</span> : <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.store">Mem.store</a></span> <span class="id">chunk</span> (<span class="id"><a href="bpf.comm.State.html#bpf_m">bpf_m</a></span> <span class="id">st1</span>) <span class="id">b</span> <span class="id">ofs</span> <span class="id">addr</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hstore_m2</span> : <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.store">Mem.store</a></span> <span class="id">chunk</span> <span class="id">m1</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">addr</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hother</span>: <span class="id">ofs</span> &lt; <span class="id">ofs0</span> &lt; <span class="id">ofs</span> + <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memdata.html#size_chunk">size_chunk</a></span> <span class="id">chunk</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hunchanged_on_contents</span> : <span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Maps.html#ZMap.get">Maps.ZMap.get</a></span> <span class="id">ofs0</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Maps.html#PMap.get">Maps.PMap.get</a></span> <span class="id">b</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.mem_contents">Mem.mem_contents</a></span> <span class="id">m1</span>)) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Maps.html#ZMap.get">Maps.ZMap.get</a></span> <span class="id">ofs0</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Maps.html#PMap.get">Maps.PMap.get</a></span> <span class="id">b</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.mem_contents">Mem.mem_contents</a></span> (<span class="id"><a href="bpf.comm.State.html#bpf_m">bpf_m</a></span> <span class="id">st1</span>)))),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Maps.html#ZMap.get">Maps.ZMap.get</a></span> <span class="id">ofs0</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Maps.html#PMap.get">Maps.PMap.get</a></span> <span class="id">b</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.mem_contents">Mem.mem_contents</a></span> <span class="id">m2</span>)) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Maps.html#ZMap.get">Maps.ZMap.get</a></span> <span class="id">ofs0</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Maps.html#PMap.get">Maps.PMap.get</a></span> <span class="id">b</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.mem_contents">Mem.mem_contents</a></span> <span class="id">m</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof47')">Proof.</div>
<div class="proofscript" id="proof47">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.store_mem_contents">Mem.store_mem_contents</a></span> <span class="kwd">in</span> <span class="id">Hstore</span> <span class="kwd">as</span> <span class="id">Hcontents0</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.store_mem_contents">Mem.store_mem_contents</a></span> <span class="kwd">in</span> <span class="id">Hstore_m2</span> <span class="kwd">as</span> <span class="id">Hcontents1</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hcontents0</span>, <span class="id">Hcontents1</span>.<br/>
&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Maps.html#PMap.gss">Maps.PMap.gss</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hlen</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#length">List.length</a></span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memdata.html#encode_val">encode_val</a></span> <span class="id">chunk</span> <span class="id">addr</span>) = <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memdata.html#size_chunk_nat">size_chunk_nat</a></span> <span class="id">chunk</span>) <span class="tactic">by</span> <span class="tactic">apply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memdata.html#encode_val_length">encode_val_length</a></span>.<br/>
&nbsp;&nbsp;<span class="id">revert</span> <span class="id">Hlen</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memdata.html#encode_val">encode_val</a></span> <span class="id">chunk</span> <span class="id">addr</span>).<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memdata.html#size_chunk_nat">size_chunk_nat</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hofs0_eq</span>: <span class="tactic">exists</span> <span class="id">n</span>, 0 &lt; <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.of_nat">Z.of_nat</a></span> <span class="id">n</span> &lt; <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memdata.html#size_chunk">size_chunk</a></span> <span class="id">chunk</span> /\ <span class="id">ofs0</span> = <span class="id">ofs</span>+ <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.of_nat">Z.of_nat</a></span> <span class="id">n</span>). {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> - <span class="id">Hother</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Heq</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.of_nat">Z.of_nat</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.to_nat">Z.to_nat</a></span> (<span class="id">ofs0</span> - <span class="id">ofs</span>)) = <span class="id">ofs0</span> - <span class="id">ofs</span>). {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Znat.html#Z2Nat.id">Z2Nat.id</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.to_nat">Z.to_nat</a></span>(<span class="id">ofs0</span> - <span class="id">ofs</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lia</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hofs0_eq</span> <span class="kwd">as</span> (<span class="id">z</span> &amp; <span class="id">Hz_range</span> &amp; <span class="id">Hofs0_eq</span>); <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="bpf.comm.rBPFMemType.html#mem_get_in">mem_get_in</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id">lia</span>.<br/>
&nbsp;&nbsp;<span class="id">lia</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="store_match_state_other">store_match_state_other</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">st1</span> <span class="id">m</span> <span class="id">m1</span> <span class="id">m2</span> <span class="id">chunk</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">addr</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hstore</span> : <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.store">Mem.store</a></span> <span class="id">chunk</span> (<span class="id"><a href="bpf.comm.State.html#bpf_m">bpf_m</a></span> <span class="id">st1</span>) <span class="id">b</span> <span class="id">ofs</span> <span class="id">addr</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hstore_m2</span> : <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.store">Mem.store</a></span> <span class="id">chunk</span> <span class="id">m1</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">addr</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m2</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">b0</span> <span class="id">ofs0</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hother</span>: <span class="id">b0</span> &lt;&gt; <span class="id">b</span> \/ <span class="id">ofs0</span> &lt; <span class="id">ofs</span> \/ <span class="id">ofs</span> + <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memdata.html#size_chunk">size_chunk</a></span> <span class="id">chunk</span> &lt;= <span class="id">ofs0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hunchanged_on_contents</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Maps.html#ZMap.get">Maps.ZMap.get</a></span> <span class="id">ofs0</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Maps.html#PMap.get">Maps.PMap.get</a></span> <span class="id">b0</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.mem_contents">Mem.mem_contents</a></span> <span class="id">m1</span>)) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Maps.html#ZMap.get">Maps.ZMap.get</a></span> <span class="id">ofs0</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Maps.html#PMap.get">Maps.PMap.get</a></span> <span class="id">b0</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.mem_contents">Mem.mem_contents</a></span> (<span class="id"><a href="bpf.comm.State.html#bpf_m">bpf_m</a></span> <span class="id">st1</span>)))),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Maps.html#ZMap.get">Maps.ZMap.get</a></span> <span class="id">ofs0</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Maps.html#PMap.get">Maps.PMap.get</a></span> <span class="id">b0</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.mem_contents">Mem.mem_contents</a></span> <span class="id">m2</span>)) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Maps.html#ZMap.get">Maps.ZMap.get</a></span> <span class="id">ofs0</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Maps.html#PMap.get">Maps.PMap.get</a></span> <span class="id">b0</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.mem_contents">Mem.mem_contents</a></span> <span class="id">m</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof48')">Proof.</div>
<div class="proofscript" id="proof48">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.store_mem_contents">Mem.store_mem_contents</a></span> <span class="kwd">in</span> <span class="id">Hstore</span> <span class="kwd">as</span> <span class="id">Hcontents0</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.store_mem_contents">Mem.store_mem_contents</a></span> <span class="kwd">in</span> <span class="id">Hstore_m2</span> <span class="kwd">as</span> <span class="id">Hcontents1</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hcontents0</span>, <span class="id">Hcontents1</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">b0</span> =? <span class="id">b</span>)%<span class="id">positive</span> <span class="id">eqn</span>: <span class="id">Hblk_eq</span>; [<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.eqb_eq">Pos.eqb_eq</a></span> <span class="kwd">in</span> <span class="id">Hblk_eq</span> | <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.eqb_neq">Pos.eqb_neq</a></span> <span class="kwd">in</span> <span class="id">Hblk_eq</span>].<br/>
&nbsp;&nbsp;- <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Maps.html#PMap.gss">Maps.PMap.gss</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hother</span> <span class="kwd">as</span> [<span class="id">Hfalse</span> | <span class="id">Hother</span>]; [<span class="tactic">intuition</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.setN_outside">Mem.setN_outside</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memdata.html#encode_val_length">Memdata.encode_val_length</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memdata.html#size_chunk_nat">size_chunk_nat</a></span>, <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memdata.html#size_chunk">size_chunk</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memdata.html#size_chunk">size_chunk</a></span> <span class="kwd">in</span> <span class="id">Hother</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hother</span> <span class="kwd">as</span> [<span class="id">Hle</span> | <span class="id">Hge</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">chunk</span>; <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memdata.html#encode_val_length">Memdata.encode_val_length</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memdata.html#size_chunk_nat">size_chunk_nat</a></span>, <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memdata.html#size_chunk">size_chunk</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memdata.html#size_chunk">size_chunk</a></span> <span class="kwd">in</span> <span class="id">Hother</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hother</span> <span class="kwd">as</span> [<span class="id">Hle</span> | <span class="id">Hge</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">chunk</span>; <span class="id">lia</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">repeat</span> (<span class="tactic">rewrite</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Maps.html#PMap.gso">Maps.PMap.gso</a></span>; [| <span class="id">lia</span>]).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assumption</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="store_reg_preserive_match_state">store_reg_preserive_match_state</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">S</span>:<span class="id"><a href="bpf.simulation.MatchState.html#special_blocks">special_blocks</a></span>} <span class="id">st1</span> <span class="id">st2</span> <span class="id">m1</span> <span class="id">chunk</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">addr</span> <span class="id">m</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hst</span>: <span class="id"><a href="bpf.simulation.MatchState.html#match_state">match_state</a></span>  <span class="id">st1</span> <span class="id">m1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hstore</span>: <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.store">Mem.store</a></span> <span class="id">chunk</span> (<span class="id"><a href="bpf.comm.State.html#bpf_m">bpf_m</a></span> <span class="id">st1</span>) <span class="id">b</span> <span class="id">ofs</span> <span class="id">addr</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hupd_st</span>: <span class="id"><a href="bpf.comm.State.html#upd_mem">upd_mem</a></span> <span class="id">m</span> <span class="id">st1</span> = <span class="id">st2</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">m2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.store">Mem.store</a></span> <span class="id">chunk</span> <span class="id">m1</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">addr</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m2</span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.simulation.MatchState.html#match_state">match_state</a></span>  <span class="id">st2</span> <span class="id">m2</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof49')">Proof.</div>
<div class="proofscript" id="proof49">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hvalid_blk</span>': <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.valid_block">Mem.valid_block</a></span> (<span class="id"><a href="bpf.comm.State.html#bpf_m">bpf_m</a></span> <span class="id">st1</span>) <span class="id">b</span>). {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hst</span> <span class="kwd">as</span> (<span class="id">Hunchanged_on</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.store_valid_access_3">Mem.store_valid_access_3</a></span> <span class="kwd">in</span> <span class="id">Hstore</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hstore</span>' : <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.valid_access">Mem.valid_access</a></span> (<span class="id"><a href="bpf.comm.State.html#bpf_m">bpf_m</a></span> <span class="id">st1</span>) <span class="id">chunk</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memtype.html#Nonempty">Nonempty</a></span>). {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.valid_access_implies">Mem.valid_access_implies</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.valid_access_valid_block">Mem.valid_access_valid_block</a></span> <span class="kwd">in</span> <span class="id">Hstore</span>'; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hvalid_blk</span>: <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.valid_block">Mem.valid_block</a></span> <span class="id">m1</span> <span class="id">b</span>). {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hst</span> <span class="kwd">as</span> (<span class="id">Hunchanged_on</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.valid_block_unchanged_on">Mem.valid_block_unchanged_on</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;}<br/>
<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hinvalid</span>: <span class="id">b</span> &lt;&gt; <span class="id"><a href="bpf.simulation.MatchState.html#st_blk">st_blk</a></span> /\ <span class="id">b</span> &lt;&gt; <span class="id"><a href="bpf.simulation.MatchState.html#mrs_blk">mrs_blk</a></span> /\ <span class="id">b</span> &lt;&gt; <span class="id"><a href="bpf.simulation.MatchState.html#ins_blk">ins_blk</a></span>). {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hst</span> <span class="kwd">as</span> (<span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">Hinvalid</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hinvalid</span> <span class="kwd">as</span> ((<span class="id">Hinvalid0</span> &amp; <span class="id">Hinvalid1</span> &amp; <span class="id">Hinvalid2</span>) &amp; <span class="id">_</span> &amp; <span class="id">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Hinvalid0</span>; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">intro</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Hinvalid1</span>; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Hinvalid2</span>; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;}<br/>
<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hvalid_access</span>: <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.valid_access">Mem.valid_access</a></span> <span class="id">m1</span> <span class="id">chunk</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memtype.html#Writable">Writable</a></span>). {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">minvalid0</span> <span class="kwd">as</span> ( <span class="id">_</span> &amp; <span class="id">_</span> &amp; <span class="id">Hvalid</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">Hvalid</span> <span class="id">b</span> <span class="id">Hinvalid</span> <span class="id">Hvalid_blk</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> - <span class="id">munchange0</span> <span class="id">Hvalid</span> <span class="id">Hvalid_blk</span> <span class="id">Hinvalid</span> <span class="id">Hstore</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">munchange0</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.store_valid_access_3">Mem.store_valid_access_3</a></span> <span class="kwd">in</span> <span class="id">Hstore</span> <span class="kwd">as</span> <span class="id">Hvalid_acc</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.valid_access_store">Mem.valid_access_store</a></span> <span class="kwd">with</span> (<span class="id">v</span>:= <span class="id">addr</span>) <span class="kwd">in</span> <span class="id">Hvalid_acc</span> <span class="kwd">as</span> <span class="id">Hres</span>; <span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.valid_access">Mem.valid_access</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hvalid_acc</span> <span class="kwd">as</span> (<span class="id">Hvalid_acc</span> &amp; <span class="id">Haligh</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; [| <span class="tactic">assumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.range_perm">Mem.range_perm</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">Hvalid_acc</span> <span class="id">ofs0</span> <span class="id">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">unchanged_on_perm</span> <span class="id">b</span> <span class="id">ofs0</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memtype.html#Cur">Cur</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memtype.html#Writable">Writable</a></span> <span class="id">Hinvalid</span> <span class="id">Hvalid</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">unchanged_on_perm</span>; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.valid_access_store">Mem.valid_access_store</a></span> <span class="kwd">with</span> (<span class="id">v</span>:= <span class="id">addr</span>) <span class="kwd">in</span> <span class="id">Hvalid_access</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hvalid_access</span> <span class="kwd">as</span> (<span class="id">m2</span> &amp; <span class="id">Hstore_m2</span>).<br/>
&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">m2</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>; [<span class="tactic">assumption</span> |].<br/>
<br/>
&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">Hst</span>' := <span class="id">Hst</span>).<br/>
&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="docright">(* Mem.unchanged_on  *)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hst</span>' <span class="kwd">as</span> (<span class="id">Hunchanged_on</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hunchanged_on</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="bpf.comm.State.html#upd_mem">upd_mem</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.nextblock_store">Mem.nextblock_store</a></span> <span class="kwd">in</span> <span class="id">Hstore_m2</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hstore_m2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.nextblock_store">Mem.nextblock_store</a></span> <span class="kwd">in</span> <span class="id">Hstore</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hstore</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.store_valid_block_2">Mem.store_valid_block_2</a></span> <span class="kwd">in</span> <span class="id">Hstore</span> <span class="kwd">as</span> <span class="id">Hvalid_block</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">unchanged_on_perm</span> <span class="id">b0</span> <span class="id">ofs0</span> <span class="id">k</span> <span class="id">p</span> <span class="id">H</span> <span class="id">Hvalid_block</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="bpf.comm.rBPFMemType.html#store_perm_iff">store_perm_iff</a></span> <span class="kwd">with</span> (<span class="id">b0</span>:=<span class="id">b0</span>) (<span class="id">ofs0</span>:=<span class="id">ofs0</span>) (<span class="id">k</span>:=<span class="id">k</span>) (<span class="id">p</span>:=<span class="id">p</span>) <span class="kwd">in</span> <span class="id">Hstore</span> <span class="kwd">as</span> <span class="id">Hperm_1</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="bpf.comm.rBPFMemType.html#store_perm_iff">store_perm_iff</a></span> <span class="kwd">with</span> (<span class="id">b0</span>:=<span class="id">b0</span>) (<span class="id">ofs0</span>:=<span class="id">ofs0</span>) (<span class="id">k</span>:=<span class="id">k</span>) (<span class="id">p</span>:=<span class="id">p</span>) <span class="kwd">in</span> <span class="id">Hstore_m2</span> <span class="kwd">as</span> <span class="id">Hperm_2</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.perm_store_2">Mem.perm_store_2</a></span> <span class="kwd">in</span> <span class="id">Hstore</span> <span class="kwd">as</span> <span class="id">Hperm</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">unchanged_on_contents</span> <span class="id">b0</span> <span class="id">ofs0</span> <span class="id">H</span> <span class="id">Hperm</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">unchanged_on_nextblock</span> <span class="id">unchanged_on_perm</span> <span class="id">H0</span> <span class="id">Hperm</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">b0</span> =? <span class="id">b</span>)%<span class="id">positive</span> <span class="id">eqn</span>: <span class="id">Hblk_eq</span>; [<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.eqb_eq">Pos.eqb_eq</a></span> <span class="kwd">in</span> <span class="id">Hblk_eq</span> | <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.eqb_neq">Pos.eqb_neq</a></span> <span class="kwd">in</span> <span class="id">Hblk_eq</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="docright">(* b0 = b  *)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">ofs0</span> =? <span class="id">ofs</span>)%<span class="id">Z</span> <span class="id">eqn</span>: <span class="id">Hofs_eq</span>; [<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.eqb_eq">Z.eqb_eq</a></span> <span class="kwd">in</span> <span class="id">Hofs_eq</span> | <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.eqb_neq">Z.eqb_neq</a></span> <span class="kwd">in</span> <span class="id">Hofs_eq</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="docright">(* ofs0 = ofs  *)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="bpf.simulation.MatchState.html#store_match_state_same">store_match_state_same</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="docright">(* ofs0 &lt;&gt; ofs  *)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.lt_gt_cases">Z.lt_gt_cases</a></span> <span class="kwd">in</span> <span class="id">Hofs_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hofs_eq</span> <span class="kwd">as</span> [<span class="id">Hofs_le</span> | <span class="id">Hofs_ge</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="docright">(* ofs0 &lt; ofs *)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="bpf.simulation.MatchState.html#store_match_state_other">store_match_state_other</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="docright">(* ofs &lt; ofs0  *)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">ofs</span> + <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memdata.html#size_chunk">size_chunk</a></span> <span class="id">chunk</span> &lt;=? <span class="id">ofs0</span>)%<span class="id">Z</span> <span class="id">eqn</span>: <span class="id">Hge</span>; [<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.leb_le">Z.leb_le</a></span> <span class="kwd">in</span> <span class="id">Hge</span> | <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.leb_gt">Z.leb_gt</a></span> <span class="kwd">in</span> <span class="id">Hge</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="docright">(* ofs + size_chunk chunk &lt;= ofs0  *)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="bpf.simulation.MatchState.html#store_match_state_other">store_match_state_other</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="docright">(* ofs &lt; ofs0 &lt; ofs + size_chunk chunk  *)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="bpf.simulation.MatchState.html#store_match_state_same_other">store_match_state_same_other</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="docright">(* b0 &lt;&gt; b  *)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="bpf.simulation.MatchState.html#store_match_state_other">store_match_state_other</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="docright">(* pc  *)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hst</span>' <span class="kwd">as</span> (<span class="id">_</span>, <span class="id">Hpc</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.loadv">Mem.loadv</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="bpf.comm.State.html#upd_mem">upd_mem</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.load_store_other">Mem.load_store_other</a></span> <span class="kwd">in</span> <span class="id">Hstore_m2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hstore_m2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;- <span class="docright">(* flag  *)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hst</span>' <span class="kwd">as</span> (<span class="id">_</span>, <span class="id">_</span>, <span class="id">Hflag</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.loadv">Mem.loadv</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="bpf.comm.State.html#upd_mem">upd_mem</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.load_store_other">Mem.load_store_other</a></span> <span class="kwd">in</span> <span class="id">Hstore_m2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hstore_m2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;- <span class="docright">(* registers  *)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hst</span>' <span class="kwd">as</span> (<span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">Hreg</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="bpf.simulation.MatchState.html#match_registers">match_registers</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">Hreg</span> <span class="id">r</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hreg</span> <span class="kwd">as</span> (<span class="id">vl</span> &amp; <span class="id">Hload</span> &amp; <span class="id">Hvl_eq</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.loadv">Mem.loadv</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="bpf.comm.State.html#upd_mem">upd_mem</a></span>; <span class="tactic">simpl</span> <span class="id">regs_st</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exists</span> <span class="id">vl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; [| <span class="tactic">assumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.load_store_other">Mem.load_store_other</a></span> <span class="kwd">in</span> <span class="id">Hstore_m2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hstore_m2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;- <span class="docright">(* ins_len  *)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hst</span>' <span class="kwd">as</span> (<span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">Hins_len</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.loadv">Mem.loadv</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="bpf.comm.State.html#upd_mem">upd_mem</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hins_len</span> <span class="kwd">as</span> (<span class="id">Hload</span> &amp; <span class="id">Hge</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; [| <span class="tactic">assumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.load_store_other">Mem.load_store_other</a></span> <span class="kwd">in</span> <span class="id">Hstore_m2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hstore_m2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;- <span class="docright">(* ins  *)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hst</span>' <span class="kwd">as</span> (<span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">Hins</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.loadv">Mem.loadv</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="bpf.simulation.MatchState.html#match_ins">match_ins</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hins</span> <span class="kwd">as</span> (<span class="id">Hload</span> &amp; <span class="id">Hlen</span> &amp; <span class="id">Hmax</span> &amp; <span class="id">Hmatch</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="bpf.comm.State.html#upd_mem">upd_mem</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.load_store_other">Mem.load_store_other</a></span> <span class="kwd">in</span> <span class="id">Hstore_m2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hstore_m2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intuition</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; [<span class="tactic">assumption</span>| ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; [<span class="tactic">assumption</span>| ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="bpf.simulation.MatchState.html#upd_preserves_match_list_ins">upd_preserves_match_list_ins</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;- <span class="docright">(* mrs_num  *)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hst</span>' <span class="kwd">as</span> (<span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">Hmrs_num</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.loadv">Mem.loadv</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hmrs_num</span> <span class="kwd">as</span> (<span class="id">Hload</span> &amp; <span class="id">Hother</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="bpf.comm.State.html#upd_mem">upd_mem</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.load_store_other">Mem.load_store_other</a></span> <span class="kwd">in</span> <span class="id">Hstore_m2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hstore_m2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intuition</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="docright">(* mrs_block  *)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hst</span>' <span class="kwd">as</span> (<span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">Hmrs_block</span>, <span class="id">_</span>, <span class="id">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.loadv">Mem.loadv</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="bpf.simulation.MatchState.html#match_regions">match_regions</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="bpf.comm.State.html#upd_mem">upd_mem</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hmrs_block</span> <span class="kwd">as</span> (<span class="id">Hload</span> &amp; <span class="id">Hlen</span> &amp; <span class="id">Hmax</span> &amp; <span class="id">Hmatch</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.load_store_other">Mem.load_store_other</a></span> <span class="kwd">in</span> <span class="id">Hstore_m2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hstore_m2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intuition</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; [<span class="tactic">assumption</span>| ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; [<span class="tactic">assumption</span>| ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="bpf.simulation.MatchState.html#upd_preserves_match_list_region">upd_preserves_match_list_region</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;- <span class="docright">(* range_perm  *)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hst</span>' <span class="kwd">as</span> (<span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">Hrange_perm</span>, <span class="id">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="bpf.simulation.MatchState.html#size_of_state">size_of_state</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="bpf.comm.State.html#upd_mem">upd_mem</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="id">mrs_num</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="id">ins_len</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hrange_perm</span> <span class="kwd">as</span> (<span class="id">Hrange_perm_st</span> &amp; <span class="id">Hrange_perm_mrs</span> &amp; <span class="id">Hrange_perm_ins</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; [<span class="tactic">eapply</span> <span class="id"><a href="bpf.comm.rBPFMemType.html#store_range_perm">store_range_perm</a></span>; <span class="tactic">eauto</span>; <span class="tactic">intuition</span> |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">eapply</span> <span class="id"><a href="bpf.comm.rBPFMemType.html#store_range_perm">store_range_perm</a></span>; <span class="tactic">eauto</span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;- <span class="docright">(* valid_block  *)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hst</span>' <span class="kwd">as</span> (<span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">Hvalid_block</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="bpf.comm.State.html#upd_mem">upd_mem</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hvalid_block</span> <span class="kwd">as</span> (<span class="id">Hinvalid_blk</span> &amp; <span class="id">Hneq_blk</span> &amp; <span class="id">Hvalid</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hinvalid_blk</span> <span class="kwd">as</span> (<span class="id">Hinvalid_blk0</span> &amp; <span class="id">Hinvalid_blk1</span> &amp; <span class="id">Hinvalid_blk2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">H</span>; <span class="tactic">apply</span> <span class="id">Hinvalid_blk0</span>; <span class="tactic">eapply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.store_valid_block_2">Mem.store_valid_block_2</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">H</span>; <span class="tactic">apply</span> <span class="id">Hinvalid_blk1</span>; <span class="tactic">eapply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.store_valid_block_2">Mem.store_valid_block_2</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">H</span>; <span class="tactic">apply</span> <span class="id">Hinvalid_blk2</span>; <span class="tactic">eapply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.store_valid_block_2">Mem.store_valid_block_2</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; [<span class="tactic">assumption</span> | ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">Hvalid</span> <span class="id">b0</span> <span class="id">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.store_valid_block_2">Mem.store_valid_block_2</a></span> <span class="kwd">in</span> <span class="id">Hstore_m2</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">specialize</span> (<span class="id">Hvalid</span> <span class="id">Hstore_m2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.store_valid_block_1">Mem.store_valid_block_1</a></span> <span class="kwd">in</span> <span class="id">Hstore</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="id">Close</span> <span class="kwd">Scope</span> <span class="id">Z_scope</span>.<br/>
<br/>
#[<span class="id">global</span>] <span class="kwd">Notation</span> <span class="id"><a name="dcons">dcons</a></span> := (<span class="id"><a href="bpf.clightlogic.Clightlogic.html#DList.DCons">DList.DCons</a></span> (<span class="id">F</span>:= <span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">x</span> -&gt; <span class="id"><a href="bpf.clightlogic.Clightlogic.html#Inv">Inv</a></span> <span class="id"><a href="bpf.comm.State.html#state">State.state</a></span>)).<br/>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</a></div>
</body>
</html>
