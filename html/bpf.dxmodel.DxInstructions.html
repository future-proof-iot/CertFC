
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module DxInstructions</title>
<meta name="description" content="Documentation of Coq module DxInstructions" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module DxInstructions</h1>
<div class="coq">
<br/>
<span class="kwd">From</span> <span class="id">Coq</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html">List</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.ZArith.html">ZArith</a></span>.<br/>
<span class="kwd">Import</span> <span class="id">ListNotations</span>.<br/>
<br/>
<span class="kwd">From</span> <span class="id">compcert</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Integers.html">Integers</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html">Values</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.AST.html">AST</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html">Memory</a></span>.<br/>
<br/>
<span class="kwd">From</span> <span class="id">dx.Type</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Bool</span> <span class="id">Nat</span>.<br/>
<br/>
<span class="kwd">From</span> <span class="id">bpf.comm</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="bpf.comm.MemRegion.html">MemRegion</a></span> <span class="id"><a href="bpf.comm.rBPFValues.html">rBPFValues</a></span> <span class="id"><a href="bpf.comm.rBPFAST.html">rBPFAST</a></span> <span class="id"><a href="bpf.comm.rBPFMemType.html">rBPFMemType</a></span> <span class="id"><a href="bpf.comm.Flag.html">Flag</a></span> <span class="id"><a href="bpf.comm.Regs.html">Regs</a></span> <span class="id"><a href="bpf.comm.BinrBPF.html">BinrBPF</a></span>.<br/>
<span class="kwd">From</span> <span class="id">bpf.dxcomm</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="bpf.dxcomm.DxIntegers.html">DxIntegers</a></span> <span class="id"><a href="bpf.dxcomm.DxValues.html">DxValues</a></span> <span class="id"><a href="bpf.dxcomm.DxList64.html">DxList64</a></span> <span class="id">DxNat</span>.<br/>
<span class="kwd">From</span> <span class="id">bpf.dxmodel</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="bpf.dxmodel.DxRegs.html">DxRegs</a></span> <span class="id"><a href="bpf.dxmodel.DxOpcode.html">DxOpcode</a></span> <span class="id"><a href="bpf.dxmodel.DxFlag.html">DxFlag</a></span> <span class="id"><a href="bpf.dxmodel.DxMemRegion.html">DxMemRegion</a></span> <span class="id"><a href="bpf.dxmodel.DxMemType.html">DxMemType</a></span> <span class="id"><a href="bpf.dxmodel.DxMonad.html">DxMonad</a></span>.<br/>
<br/>
<span class="kwd">From</span> <span class="id">bpf.monadicmodel</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="bpf.monadicmodel.Opcode.html">Opcode</a></span>.<br/>
<br/>
<span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">monad_scope</span>.<br/>
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="get_dst">get_dst</a></span> (<span class="id">ins</span>: <span class="id"><a href="bpf.dxcomm.DxIntegers.html#int64_t">int64_t</a></span>): <span class="id"><a href="bpf.dxmodel.DxMonad.html#M">M</a></span> <span class="id"><a href="bpf.comm.Regs.html#reg">reg</a></span> := <span class="id"><a href="bpf.dxmodel.DxMonad.html#int64_to_dst_reg">int64_to_dst_reg</a></span> <span class="id">ins</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="reg64_to_reg32">reg64_to_reg32</a></span> (<span class="id">d</span>: <span class="id"><a href="bpf.dxcomm.DxValues.html#val64_t">val64_t</a></span>): <span class="id"><a href="bpf.dxmodel.DxMonad.html#M">M</a></span> <span class="id"><a href="bpf.dxcomm.DxValues.html#valu32_t">valu32_t</a></span> := <span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> (<span class="id"><a href="bpf.comm.rBPFValues.html#val_intuoflongu">val_intuoflongu</a></span> <span class="id">d</span>).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="get_src">get_src</a></span> (<span class="id">ins</span>: <span class="id"><a href="bpf.dxcomm.DxIntegers.html#int64_t">int64_t</a></span>): <span class="id"><a href="bpf.dxmodel.DxMonad.html#M">M</a></span> <span class="id"><a href="bpf.comm.Regs.html#reg">reg</a></span> := <span class="id"><a href="bpf.dxmodel.DxMonad.html#int64_to_src_reg">int64_to_src_reg</a></span> <span class="id">ins</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="get_offset">get_offset</a></span> (<span class="id">ins</span>:<span class="id"><a href="bpf.dxcomm.DxIntegers.html#int64_t">int64_t</a></span> ):<span class="id"><a href="bpf.dxmodel.DxMonad.html#M">M</a></span> <span class="id"><a href="bpf.dxcomm.DxIntegers.html#sint32_t">sint32_t</a></span> := <span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> (<span class="id"><a href="bpf.comm.BinrBPF.html#get_offset">get_offset</a></span> <span class="id">ins</span>).<br/>
<div class="doc">get_immediate: int64_t -&gt; vals32_t. Tthe return type is vals32_t instead of sint32_t because `imm` is always used to be calculted with other `val` type.
  </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="get_immediate">get_immediate</a></span> (<span class="id">ins</span>:<span class="id"><a href="bpf.dxcomm.DxIntegers.html#int64_t">int64_t</a></span>):<span class="id"><a href="bpf.dxmodel.DxMonad.html#M">M</a></span> <span class="id"><a href="bpf.dxcomm.DxIntegers.html#sint32_t">sint32_t</a></span> := <span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> (<span class="id"><a href="bpf.comm.BinrBPF.html#get_immediate">get_immediate</a></span> <span class="id">ins</span>).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="eval_immediate">eval_immediate</a></span> (<span class="id">ins</span>: <span class="id"><a href="bpf.dxcomm.DxIntegers.html#sint32_t">sint32_t</a></span>): <span class="id"><a href="bpf.dxmodel.DxMonad.html#M">M</a></span> <span class="id"><a href="bpf.dxcomm.DxValues.html#vals64_t">vals64_t</a></span> := <span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> (<span class="id"><a href="bpf.dxcomm.DxValues.html#Val_slongofint">Val_slongofint</a></span> <span class="id">ins</span>).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="get_src64">get_src64</a></span> (<span class="id">x</span>: <span class="id">nat8</span>) (<span class="id">ins</span>: <span class="id"><a href="bpf.dxcomm.DxIntegers.html#int64_t">int64_t</a></span>): <span class="id"><a href="bpf.dxmodel.DxMonad.html#M">M</a></span> <span class="id"><a href="bpf.dxcomm.DxValues.html#val64_t">val64_t</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Integers.html#Int.eq">Int.eq</a></span> <span class="id"><a href="bpf.dxcomm.DxIntegers.html#int32_0">int32_0</a></span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Integers.html#Int.and">Int.and</a></span> (<span class="id">nat2int</span> <span class="id">x</span>) <span class="id"><a href="bpf.dxcomm.DxIntegers.html#int32_8">int32_8</a></span>) <span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">imm</span>    &lt;-- <span class="id"><a href="bpf.dxmodel.DxInstructions.html#get_immediate">get_immediate</a></span> <span class="id">ins</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">imm64</span>  &lt;-- <span class="id"><a href="bpf.dxmodel.DxInstructions.html#eval_immediate">eval_immediate</a></span> <span class="id">imm</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> (<span class="id"><a href="bpf.dxcomm.DxValues.html#Val_ulongofslong">Val_ulongofslong</a></span> <span class="id">imm64</span>)<br/>
&nbsp;&nbsp;<span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">src</span>    &lt;-- <span class="id"><a href="bpf.dxmodel.DxInstructions.html#get_src">get_src</a></span> <span class="id">ins</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">src64</span>  &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#eval_reg">eval_reg</a></span> <span class="id">src</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id">src64</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="get_src32">get_src32</a></span> (<span class="id">x</span>: <span class="id">nat8</span>) (<span class="id">ins</span>: <span class="id"><a href="bpf.dxcomm.DxIntegers.html#int64_t">int64_t</a></span>): <span class="id"><a href="bpf.dxmodel.DxMonad.html#M">M</a></span> <span class="id"><a href="bpf.dxcomm.DxValues.html#valu32_t">valu32_t</a></span> := <br/>
&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Integers.html#Int.eq">Int.eq</a></span> <span class="id"><a href="bpf.dxcomm.DxIntegers.html#int32_0">int32_0</a></span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Integers.html#Int.and">Int.and</a></span> (<span class="id">nat2int</span> <span class="id">x</span>) <span class="id"><a href="bpf.dxcomm.DxIntegers.html#int32_8">int32_8</a></span>) <span class="kwd">then</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">imm</span>    &lt;-- <span class="id"><a href="bpf.dxmodel.DxInstructions.html#get_immediate">get_immediate</a></span> <span class="id">ins</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> (<span class="id"><a href="bpf.comm.rBPFValues.html#sint32_to_vint">sint32_to_vint</a></span> <span class="id">imm</span>)<br/>
&nbsp;&nbsp;<span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">src</span>    &lt;-- <span class="id"><a href="bpf.dxmodel.DxInstructions.html#get_src">get_src</a></span> <span class="id">ins</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">src64</span>  &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#eval_reg">eval_reg</a></span> <span class="id">src</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">src32</span>  &lt;-- <span class="id"><a href="bpf.dxmodel.DxInstructions.html#reg64_to_reg32">reg64_to_reg32</a></span> <span class="id">src64</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id">src32</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="get_opcode_ins">get_opcode_ins</a></span> (<span class="id">ins</span>: <span class="id"><a href="bpf.dxcomm.DxIntegers.html#int64_t">int64_t</a></span>): <span class="id"><a href="bpf.dxmodel.DxMonad.html#M">M</a></span> <span class="id">nat8</span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> (<span class="id"><a href="bpf.comm.BinrBPF.html#get_opcode">get_opcode</a></span> <span class="id">ins</span>).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="get_opcode_alu64">get_opcode_alu64</a></span> (<span class="id">op</span>: <span class="id">nat8</span>): <span class="id"><a href="bpf.dxmodel.DxMonad.html#M">M</a></span> <span class="id"><a href="bpf.monadicmodel.Opcode.html#opcode_alu64">opcode_alu64</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> (<span class="id"><a href="bpf.monadicmodel.Opcode.html#byte_to_opcode_alu64">byte_to_opcode_alu64</a></span> <span class="id">op</span>).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="get_opcode_alu32">get_opcode_alu32</a></span> (<span class="id">op</span>: <span class="id">nat8</span>): <span class="id"><a href="bpf.dxmodel.DxMonad.html#M">M</a></span> <span class="id"><a href="bpf.monadicmodel.Opcode.html#opcode_alu32">opcode_alu32</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> (<span class="id"><a href="bpf.monadicmodel.Opcode.html#byte_to_opcode_alu32">byte_to_opcode_alu32</a></span> <span class="id">op</span>).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="get_opcode_branch">get_opcode_branch</a></span> (<span class="id">op</span>: <span class="id">nat8</span>): <span class="id"><a href="bpf.dxmodel.DxMonad.html#M">M</a></span> <span class="id"><a href="bpf.monadicmodel.Opcode.html#opcode_branch">opcode_branch</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> (<span class="id"><a href="bpf.monadicmodel.Opcode.html#byte_to_opcode_branch">byte_to_opcode_branch</a></span> <span class="id">op</span>).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="get_opcode_mem_ld_imm">get_opcode_mem_ld_imm</a></span> (<span class="id">op</span>: <span class="id">nat8</span>): <span class="id"><a href="bpf.dxmodel.DxMonad.html#M">M</a></span> <span class="id"><a href="bpf.monadicmodel.Opcode.html#opcode_mem_ld_imm">opcode_mem_ld_imm</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> (<span class="id"><a href="bpf.monadicmodel.Opcode.html#byte_to_opcode_mem_ld_imm">byte_to_opcode_mem_ld_imm</a></span> <span class="id">op</span>).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="get_opcode_mem_ld_reg">get_opcode_mem_ld_reg</a></span> (<span class="id">op</span>: <span class="id">nat8</span>): <span class="id"><a href="bpf.dxmodel.DxMonad.html#M">M</a></span> <span class="id"><a href="bpf.monadicmodel.Opcode.html#opcode_mem_ld_reg">opcode_mem_ld_reg</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> (<span class="id"><a href="bpf.monadicmodel.Opcode.html#byte_to_opcode_mem_ld_reg">byte_to_opcode_mem_ld_reg</a></span> <span class="id">op</span>).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="get_opcode_mem_st_imm">get_opcode_mem_st_imm</a></span> (<span class="id">op</span>: <span class="id">nat8</span>): <span class="id"><a href="bpf.dxmodel.DxMonad.html#M">M</a></span> <span class="id"><a href="bpf.monadicmodel.Opcode.html#opcode_mem_st_imm">opcode_mem_st_imm</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> (<span class="id"><a href="bpf.monadicmodel.Opcode.html#byte_to_opcode_mem_st_imm">byte_to_opcode_mem_st_imm</a></span> <span class="id">op</span>).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="get_opcode_mem_st_reg">get_opcode_mem_st_reg</a></span> (<span class="id">op</span>: <span class="id">nat8</span>): <span class="id"><a href="bpf.dxmodel.DxMonad.html#M">M</a></span> <span class="id"><a href="bpf.monadicmodel.Opcode.html#opcode_mem_st_reg">opcode_mem_st_reg</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> (<span class="id"><a href="bpf.monadicmodel.Opcode.html#byte_to_opcode_mem_st_reg">byte_to_opcode_mem_st_reg</a></span> <span class="id">op</span>).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="get_opcode">get_opcode</a></span> (<span class="id">op</span>: <span class="id">nat8</span>): <span class="id"><a href="bpf.dxmodel.DxMonad.html#M">M</a></span> <span class="id"><a href="bpf.monadicmodel.Opcode.html#opcode">opcode</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> (<span class="id"><a href="bpf.monadicmodel.Opcode.html#byte_to_opcode">byte_to_opcode</a></span> <span class="id">op</span>).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="get_add">get_add</a></span> (<span class="id">x</span> <span class="id">y</span>: <span class="id"><a href="bpf.dxcomm.DxValues.html#valu32_t">valu32_t</a></span>): <span class="id"><a href="bpf.dxmodel.DxMonad.html#M">M</a></span> <span class="id"><a href="bpf.dxcomm.DxValues.html#valu32_t">valu32_t</a></span> := <span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Val.add">Val.add</a></span> <span class="id">x</span> <span class="id">y</span>).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="get_sub">get_sub</a></span> (<span class="id">x</span> <span class="id">y</span>: <span class="id"><a href="bpf.dxcomm.DxValues.html#valu32_t">valu32_t</a></span>): <span class="id"><a href="bpf.dxmodel.DxMonad.html#M">M</a></span> <span class="id"><a href="bpf.dxcomm.DxValues.html#valu32_t">valu32_t</a></span> := <span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Val.sub">Val.sub</a></span> <span class="id">x</span> <span class="id">y</span>).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="get_addr_ofs">get_addr_ofs</a></span> (<span class="id">x</span>: <span class="id"><a href="bpf.dxcomm.DxValues.html#val64_t">val64_t</a></span>) (<span class="id">ofs</span>: <span class="id"><a href="bpf.dxcomm.DxIntegers.html#sint32_t">sint32_t</a></span>): <span class="id"><a href="bpf.dxmodel.DxMonad.html#M">M</a></span> <span class="id"><a href="bpf.dxcomm.DxValues.html#valu32_t">valu32_t</a></span> := <span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> (<span class="id"><a href="bpf.comm.rBPFValues.html#val_intuoflongu">val_intuoflongu</a></span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Val.addl">Val.addl</a></span> <span class="id">x</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Val.longofint">Val.longofint</a></span> (<span class="id"><a href="bpf.comm.rBPFValues.html#sint32_to_vint">sint32_to_vint</a></span> <span class="id">ofs</span>)))).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="get_start_addr">get_start_addr</a></span> (<span class="id">mr</span>: <span class="id"><a href="bpf.comm.MemRegion.html#memory_region">memory_region</a></span>): <span class="id"><a href="bpf.dxmodel.DxMonad.html#M">M</a></span> <span class="id"><a href="bpf.dxcomm.DxValues.html#valu32_t">valu32_t</a></span> := <span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> (<span class="id"><a href="bpf.comm.MemRegion.html#start_addr">start_addr</a></span> <span class="id">mr</span>).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="get_block_size">get_block_size</a></span> (<span class="id">mr</span>: <span class="id"><a href="bpf.comm.MemRegion.html#memory_region">memory_region</a></span>): <span class="id"><a href="bpf.dxmodel.DxMonad.html#M">M</a></span> <span class="id"><a href="bpf.dxcomm.DxValues.html#valu32_t">valu32_t</a></span> := <span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> (<span class="id"><a href="bpf.comm.MemRegion.html#block_size">block_size</a></span> <span class="id">mr</span>).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="get_block_perm">get_block_perm</a></span> (<span class="id">mr</span>: <span class="id"><a href="bpf.comm.MemRegion.html#memory_region">memory_region</a></span>): <span class="id"><a href="bpf.dxmodel.DxMonad.html#M">M</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memtype.html#permission">permission</a></span> := <span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> (<span class="id"><a href="bpf.comm.MemRegion.html#block_perm">block_perm</a></span> <span class="id">mr</span>).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="is_well_chunk_bool">is_well_chunk_bool</a></span> (<span class="id">chunk</span>: <span class="id"><a href="https://compcert.org/doc/html/compcert.common.AST.html#memory_chunk">memory_chunk</a></span>) : <span class="id"><a href="bpf.dxmodel.DxMonad.html#M">M</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">chunk</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="https://compcert.org/doc/html/compcert.common.AST.html#Mint8unsigned">Mint8unsigned</a></span> | <span class="id"><a href="https://compcert.org/doc/html/compcert.common.AST.html#Mint16unsigned">Mint16unsigned</a></span> | <span class="id"><a href="https://compcert.org/doc/html/compcert.common.AST.html#Mint32">Mint32</a></span> | <span class="id"><a href="https://compcert.org/doc/html/compcert.common.AST.html#Mint64">Mint64</a></span> =&gt; <span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span><br/>
&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="check_mem_aux2">check_mem_aux2</a></span> (<span class="id">mr</span>: <span class="id"><a href="bpf.comm.MemRegion.html#memory_region">memory_region</a></span>) (<span class="id">perm</span>: <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memtype.html#permission">permission</a></span>) (<span class="id">addr</span>: <span class="id"><a href="bpf.dxcomm.DxValues.html#valu32_t">valu32_t</a></span>) (<span class="id">chunk</span>: <span class="id"><a href="https://compcert.org/doc/html/compcert.common.AST.html#memory_chunk">memory_chunk</a></span>): <span class="id"><a href="bpf.dxmodel.DxMonad.html#M">M</a></span> <span class="id"><a href="bpf.dxcomm.DxValues.html#valptr8_t">valptr8_t</a></span> :=  <br/>
&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">start</span>  &lt;-- <span class="id"><a href="bpf.dxmodel.DxInstructions.html#get_start_addr">get_start_addr</a></span> <span class="id">mr</span>;<br/>
&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">size</span>   &lt;-- <span class="id"><a href="bpf.dxmodel.DxInstructions.html#get_block_size">get_block_size</a></span> <span class="id">mr</span>;<br/>
&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">mr_perm</span>  &lt;-- <span class="id"><a href="bpf.dxmodel.DxInstructions.html#get_block_perm">get_block_perm</a></span> <span class="id">mr</span>;<br/>
&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">lo_ofs</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxInstructions.html#get_sub">get_sub</a></span> <span class="id">addr</span> <span class="id">start</span>;<br/>
&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">hi_ofs</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxInstructions.html#get_add">get_add</a></span> <span class="id">lo_ofs</span> (<span class="id"><a href="bpf.comm.rBPFAST.html#memory_chunk_to_valu32">memory_chunk_to_valu32</a></span> <span class="id">chunk</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#andb">andb</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#andb">andb</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="bpf.comm.rBPFValues.html#compu_lt_32">compu_lt_32</a></span> <span class="id">hi_ofs</span> <span class="id">size</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#andb">andb</a></span> (<span class="id"><a href="bpf.comm.rBPFValues.html#compu_le_32">compu_le_32</a></span> <span class="id">lo_ofs</span> (<span class="id"><a href="bpf.comm.rBPFAST.html#memory_chunk_to_valu32_upbound">memory_chunk_to_valu32_upbound</a></span> <span class="id">chunk</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="bpf.comm.rBPFValues.html#comp_eq_32">comp_eq_32</a></span> <span class="id"><a href="bpf.dxcomm.DxValues.html#val32_zero">val32_zero</a></span> (<span class="id"><a href="bpf.comm.rBPFValues.html#val32_modu">val32_modu</a></span> <span class="id">lo_ofs</span> (<span class="id"><a href="bpf.comm.rBPFAST.html#memory_chunk_to_valu32">memory_chunk_to_valu32</a></span> <span class="id">chunk</span>)))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="bpf.comm.rBPFMemType.html#perm_ge">perm_ge</a></span> <span class="id">mr_perm</span> <span class="id">perm</span>) <span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Val.add">Val.add</a></span> (<span class="id"><a href="bpf.comm.MemRegion.html#block_ptr">block_ptr</a></span> <span class="id">mr</span>) <span class="id">lo_ofs</span>) <span class="docright">(* Vptr b lo_ofs  *)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="bpf.dxcomm.DxValues.html#valptr_null">valptr_null</a></span> <span class="docright">(* = 0  *)</span>. <br/>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="check_mem_aux">check_mem_aux</a></span> (<span class="id">num</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">perm</span>: <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memtype.html#permission">permission</a></span>) (<span class="id">chunk</span>: <span class="id"><a href="https://compcert.org/doc/html/compcert.common.AST.html#memory_chunk">memory_chunk</a></span>) (<span class="id">addr</span>: <span class="id"><a href="bpf.dxcomm.DxValues.html#valu32_t">valu32_t</a></span>) (<span class="id">mrs</span>: <span class="id"><a href="bpf.comm.MemRegion.html#MyMemRegionsType">MyMemRegionsType</a></span>) {<span class="kwd">struct</span> <span class="id">num</span>}: <span class="id"><a href="bpf.dxmodel.DxMonad.html#M">M</a></span> <span class="id"><a href="bpf.dxcomm.DxValues.html#valptr8_t">valptr8_t</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">num</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span> =&gt; <span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="bpf.dxcomm.DxValues.html#valptr_null">valptr_null</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">cur_mr</span>    &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#get_mem_region">get_mem_region</a></span> <span class="id">n</span> <span class="id">mrs</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">check_mem</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxInstructions.html#check_mem_aux2">check_mem_aux2</a></span> <span class="id">cur_mr</span> <span class="id">perm</span> <span class="id">addr</span> <span class="id">chunk</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">is_null</span>   &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#cmp_ptr32_nullM">cmp_ptr32_nullM</a></span> <span class="id">check_mem</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id">is_null</span> <span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">check_mem_aux</span> <span class="id">n</span> <span class="id">perm</span> <span class="id">chunk</span> <span class="id">addr</span> <span class="id">mrs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id">check_mem</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="check_mem">check_mem</a></span> (<span class="id">perm</span>: <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memtype.html#permission">permission</a></span>) (<span class="id">chunk</span>: <span class="id"><a href="https://compcert.org/doc/html/compcert.common.AST.html#memory_chunk">memory_chunk</a></span>) (<span class="id">addr</span>: <span class="id"><a href="bpf.dxcomm.DxValues.html#valu32_t">valu32_t</a></span>): <span class="id"><a href="bpf.dxmodel.DxMonad.html#M">M</a></span> <span class="id"><a href="bpf.dxcomm.DxValues.html#valptr8_t">valptr8_t</a></span> :=<br/>
&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">well_chunk</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxInstructions.html#is_well_chunk_bool">is_well_chunk_bool</a></span> <span class="id">chunk</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id">well_chunk</span> <span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">mem_reg_num</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#eval_mrs_num">eval_mrs_num</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">mrs</span>         &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#eval_mrs_regions">eval_mrs_regions</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">check_mem</span>   &lt;-- <span class="id"><a href="bpf.dxmodel.DxInstructions.html#check_mem_aux">check_mem_aux</a></span> <span class="id">mem_reg_num</span> <span class="id">perm</span> <span class="id">chunk</span> <span class="id">addr</span> <span class="id">mrs</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">is_null</span>     &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#cmp_ptr32_nullM">cmp_ptr32_nullM</a></span> <span class="id">check_mem</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id">is_null</span> <span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="bpf.dxcomm.DxValues.html#valptr_null">valptr_null</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id">check_mem</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="bpf.dxcomm.DxValues.html#valptr_null">valptr_null</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="step_opcode_alu64">step_opcode_alu64</a></span> (<span class="id">dst64</span>: <span class="id"><a href="bpf.dxcomm.DxValues.html#val64_t">val64_t</a></span>) (<span class="id">src64</span>: <span class="id"><a href="bpf.dxcomm.DxValues.html#val64_t">val64_t</a></span>) (<span class="id">dst</span>: <span class="id"><a href="bpf.comm.Regs.html#reg">reg</a></span>) (<span class="id">op</span>: <span class="id">nat8</span>): <span class="id"><a href="bpf.dxmodel.DxMonad.html#M">M</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#unit">unit</a></span> :=<br/>
&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">opcode_alu64</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxInstructions.html#get_opcode_alu64">get_opcode_alu64</a></span> <span class="id">op</span>;<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">opcode_alu64</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="bpf.monadicmodel.Opcode.html#op_BPF_ADD64">op_BPF_ADD64</a></span>   =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_reg">upd_reg</a></span> <span class="id">dst</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Val.addl">Val.addl</a></span>    <span class="id">dst64</span> <span class="id">src64</span>); <span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="bpf.monadicmodel.Opcode.html#op_BPF_SUB64">op_BPF_SUB64</a></span>   =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_reg">upd_reg</a></span> <span class="id">dst</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Val.subl">Val.subl</a></span>    <span class="id">dst64</span> <span class="id">src64</span>); <span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="bpf.monadicmodel.Opcode.html#op_BPF_MUL64">op_BPF_MUL64</a></span>   =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_reg">upd_reg</a></span> <span class="id">dst</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Val.mull">Val.mull</a></span>    <span class="id">dst64</span> <span class="id">src64</span>); <span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="bpf.monadicmodel.Opcode.html#op_BPF_DIV64">op_BPF_DIV64</a></span>   =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="bpf.comm.rBPFValues.html#compl_ne">compl_ne</a></span> <span class="id">src64</span> <span class="id"><a href="bpf.dxcomm.DxValues.html#val64_zero">val64_zero</a></span> <span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_reg">upd_reg</a></span> <span class="id">dst</span> (<span class="id"><a href="bpf.comm.rBPFValues.html#val64_divlu">val64_divlu</a></span> <span class="id">dst64</span> <span class="id">src64</span>); <span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_flag">upd_flag</a></span> <span class="id"><a href="bpf.comm.Flag.html#BPF_ILLEGAL_DIV">BPF_ILLEGAL_DIV</a></span>; <span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="docright">(* we do it for the clightproof , we could omit it later  *)</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="bpf.monadicmodel.Opcode.html#op_BPF_OR64">op_BPF_OR64</a></span>    =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_reg">upd_reg</a></span> <span class="id">dst</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Val.orl">Val.orl</a></span>     <span class="id">dst64</span> <span class="id">src64</span>); <span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="bpf.monadicmodel.Opcode.html#op_BPF_AND64">op_BPF_AND64</a></span>   =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_reg">upd_reg</a></span> <span class="id">dst</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Val.andl">Val.andl</a></span>    <span class="id">dst64</span> <span class="id">src64</span>); <span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="bpf.monadicmodel.Opcode.html#op_BPF_LSH64">op_BPF_LSH64</a></span>   =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">src32</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxInstructions.html#reg64_to_reg32">reg64_to_reg32</a></span> <span class="id">src64</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="bpf.comm.rBPFValues.html#compu_lt_32">compu_lt_32</a></span> <span class="id">src32</span> <span class="id"><a href="bpf.dxcomm.DxValues.html#val32_64">val32_64</a></span> <span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_reg">upd_reg</a></span> <span class="id">dst</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Val.shll">Val.shll</a></span>    <span class="id">dst64</span> <span class="id">src32</span>); <span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_flag">upd_flag</a></span> <span class="id"><a href="bpf.comm.Flag.html#BPF_ILLEGAL_SHIFT">BPF_ILLEGAL_SHIFT</a></span>; <span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="bpf.monadicmodel.Opcode.html#op_BPF_RSH64">op_BPF_RSH64</a></span>   =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">src32</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxInstructions.html#reg64_to_reg32">reg64_to_reg32</a></span> <span class="id">src64</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="bpf.comm.rBPFValues.html#compu_lt_32">compu_lt_32</a></span> <span class="id">src32</span> <span class="id"><a href="bpf.dxcomm.DxValues.html#val32_64">val32_64</a></span> <span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_reg">upd_reg</a></span> <span class="id">dst</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Val.shrlu">Val.shrlu</a></span>   <span class="id">dst64</span> <span class="id">src32</span>); <span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_flag">upd_flag</a></span> <span class="id"><a href="bpf.comm.Flag.html#BPF_ILLEGAL_SHIFT">BPF_ILLEGAL_SHIFT</a></span>; <span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="bpf.monadicmodel.Opcode.html#op_BPF_NEG64">op_BPF_NEG64</a></span>    =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eqb">Nat.eqb</a></span> <span class="id">op</span> <span class="id">nat8_0x87</span> <span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_reg">upd_reg</a></span> <span class="id">dst</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Val.negl">Val.negl</a></span>    <span class="id">dst64</span>); <span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_flag">upd_flag</a></span> <span class="id"><a href="bpf.comm.Flag.html#BPF_ILLEGAL_INSTRUCTION">BPF_ILLEGAL_INSTRUCTION</a></span>; <span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="bpf.monadicmodel.Opcode.html#op_BPF_MOD64">op_BPF_MOD64</a></span>   =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="bpf.comm.rBPFValues.html#compl_ne">compl_ne</a></span> <span class="id">src64</span> <span class="id"><a href="bpf.dxcomm.DxValues.html#val64_zero">val64_zero</a></span> <span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_reg">upd_reg</a></span> <span class="id">dst</span> (<span class="id"><a href="bpf.comm.rBPFValues.html#val64_modlu">val64_modlu</a></span> <span class="id">dst64</span> <span class="id">src64</span>); <span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_flag">upd_flag</a></span> <span class="id"><a href="bpf.comm.Flag.html#BPF_ILLEGAL_DIV">BPF_ILLEGAL_DIV</a></span>; <span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="bpf.monadicmodel.Opcode.html#op_BPF_XOR64">op_BPF_XOR64</a></span>   =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_reg">upd_reg</a></span> <span class="id">dst</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Val.xorl">Val.xorl</a></span>      <span class="id">dst64</span> <span class="id">src64</span>); <span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="bpf.monadicmodel.Opcode.html#op_BPF_MOV64">op_BPF_MOV64</a></span>   =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_reg">upd_reg</a></span> <span class="id">dst</span> <span class="id">src64</span>; <span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="bpf.monadicmodel.Opcode.html#op_BPF_ARSH64">op_BPF_ARSH64</a></span>  =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">src32</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxInstructions.html#reg64_to_reg32">reg64_to_reg32</a></span> <span class="id">src64</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="bpf.comm.rBPFValues.html#compu_lt_32">compu_lt_32</a></span> <span class="id">src32</span> <span class="id"><a href="bpf.dxcomm.DxValues.html#val32_64">val32_64</a></span> <span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_reg">upd_reg</a></span> <span class="id">dst</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Val.shrl">Val.shrl</a></span>    <span class="id">dst64</span> <span class="id">src32</span>); <span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_flag">upd_flag</a></span> <span class="id"><a href="bpf.comm.Flag.html#BPF_ILLEGAL_SHIFT">BPF_ILLEGAL_SHIFT</a></span>; <span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="bpf.monadicmodel.Opcode.html#op_BPF_ALU64_ILLEGAL_INS">op_BPF_ALU64_ILLEGAL_INS</a></span> =&gt; <span class="tactic">do</span> <span class="id">_</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_flag">upd_flag</a></span> <span class="id"><a href="bpf.comm.Flag.html#BPF_ILLEGAL_INSTRUCTION">BPF_ILLEGAL_INSTRUCTION</a></span>; <span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="step_opcode_alu32">step_opcode_alu32</a></span> (<span class="id">dst32</span>: <span class="id"><a href="bpf.dxcomm.DxValues.html#valu32_t">valu32_t</a></span>) (<span class="id">src32</span>: <span class="id"><a href="bpf.dxcomm.DxValues.html#valu32_t">valu32_t</a></span>) (<span class="id">dst</span>: <span class="id"><a href="bpf.comm.Regs.html#reg">reg</a></span>) (<span class="id">op</span>: <span class="id">nat8</span>): <span class="id"><a href="bpf.dxmodel.DxMonad.html#M">M</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#unit">unit</a></span> :=<br/>
&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">opcode_alu32</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxInstructions.html#get_opcode_alu32">get_opcode_alu32</a></span> <span class="id">op</span>;<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">opcode_alu32</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="bpf.monadicmodel.Opcode.html#op_BPF_ADD32">op_BPF_ADD32</a></span>   =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_reg">upd_reg</a></span> <span class="id">dst</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Val.longofintu">Val.longofintu</a></span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Val.add">Val.add</a></span> <span class="id">dst32</span> <span class="id">src32</span>)); <span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="bpf.monadicmodel.Opcode.html#op_BPF_SUB32">op_BPF_SUB32</a></span>   =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_reg">upd_reg</a></span> <span class="id">dst</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Val.longofintu">Val.longofintu</a></span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Val.sub">Val.sub</a></span> <span class="id">dst32</span> <span class="id">src32</span>)); <span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="bpf.monadicmodel.Opcode.html#op_BPF_MUL32">op_BPF_MUL32</a></span>   =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_reg">upd_reg</a></span> <span class="id">dst</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Val.longofintu">Val.longofintu</a></span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Val.mul">Val.mul</a></span> <span class="id">dst32</span> <span class="id">src32</span>)); <span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="bpf.monadicmodel.Opcode.html#op_BPF_DIV32">op_BPF_DIV32</a></span>   =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="bpf.comm.rBPFValues.html#comp_ne_32">comp_ne_32</a></span> <span class="id">src32</span> <span class="id"><a href="bpf.dxcomm.DxValues.html#val32_zero">val32_zero</a></span> <span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_reg">upd_reg</a></span> <span class="id">dst</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Val.longofintu">Val.longofintu</a></span> (<span class="id"><a href="bpf.comm.rBPFValues.html#val32_divu">val32_divu</a></span> <span class="id">dst32</span> <span class="id">src32</span>)); <span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_flag">upd_flag</a></span> <span class="id"><a href="bpf.comm.Flag.html#BPF_ILLEGAL_DIV">BPF_ILLEGAL_DIV</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="bpf.monadicmodel.Opcode.html#op_BPF_OR32">op_BPF_OR32</a></span>   =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_reg">upd_reg</a></span> <span class="id">dst</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Val.longofintu">Val.longofintu</a></span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Val.or">Val.or</a></span>  <span class="id">dst32</span> <span class="id">src32</span>)); <span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="bpf.monadicmodel.Opcode.html#op_BPF_AND32">op_BPF_AND32</a></span>   =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_reg">upd_reg</a></span> <span class="id">dst</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Val.longofintu">Val.longofintu</a></span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Val.and">Val.and</a></span> <span class="id">dst32</span> <span class="id">src32</span>)); <span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="bpf.monadicmodel.Opcode.html#op_BPF_LSH32">op_BPF_LSH32</a></span>   =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="bpf.comm.rBPFValues.html#compu_lt_32">compu_lt_32</a></span> <span class="id">src32</span> <span class="id"><a href="bpf.dxcomm.DxValues.html#val32_32">val32_32</a></span> <span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_reg">upd_reg</a></span> <span class="id">dst</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Val.longofintu">Val.longofintu</a></span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Val.shl">Val.shl</a></span> <span class="id">dst32</span> <span class="id">src32</span>)); <span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_flag">upd_flag</a></span> <span class="id"><a href="bpf.comm.Flag.html#BPF_ILLEGAL_SHIFT">BPF_ILLEGAL_SHIFT</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="bpf.monadicmodel.Opcode.html#op_BPF_RSH32">op_BPF_RSH32</a></span>   =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="bpf.comm.rBPFValues.html#compu_lt_32">compu_lt_32</a></span> <span class="id">src32</span> <span class="id"><a href="bpf.dxcomm.DxValues.html#val32_32">val32_32</a></span> <span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_reg">upd_reg</a></span> <span class="id">dst</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Val.longofintu">Val.longofintu</a></span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Val.shru">Val.shru</a></span> <span class="id">dst32</span> <span class="id">src32</span>)); <span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_flag">upd_flag</a></span> <span class="id"><a href="bpf.comm.Flag.html#BPF_ILLEGAL_SHIFT">BPF_ILLEGAL_SHIFT</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="bpf.monadicmodel.Opcode.html#op_BPF_NEG32">op_BPF_NEG32</a></span>    =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eqb">Nat.eqb</a></span> <span class="id">op</span> <span class="id">nat8_0x84</span> <span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_reg">upd_reg</a></span> <span class="id">dst</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Val.longofintu">Val.longofintu</a></span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Val.neg">Val.neg</a></span> <span class="id">dst32</span>)); <span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_flag">upd_flag</a></span> <span class="id"><a href="bpf.comm.Flag.html#BPF_ILLEGAL_INSTRUCTION">BPF_ILLEGAL_INSTRUCTION</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="bpf.monadicmodel.Opcode.html#op_BPF_MOD32">op_BPF_MOD32</a></span>   =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="bpf.comm.rBPFValues.html#comp_ne_32">comp_ne_32</a></span> <span class="id">src32</span> <span class="id"><a href="bpf.dxcomm.DxValues.html#val32_zero">val32_zero</a></span> <span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_reg">upd_reg</a></span> <span class="id">dst</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Val.longofintu">Val.longofintu</a></span> (<span class="id"><a href="bpf.comm.rBPFValues.html#val32_modu">val32_modu</a></span> <span class="id">dst32</span> <span class="id">src32</span>)); <span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_flag">upd_flag</a></span> <span class="id"><a href="bpf.comm.Flag.html#BPF_ILLEGAL_DIV">BPF_ILLEGAL_DIV</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="bpf.monadicmodel.Opcode.html#op_BPF_XOR32">op_BPF_XOR32</a></span>   =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_reg">upd_reg</a></span> <span class="id">dst</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Val.longofintu">Val.longofintu</a></span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Val.xor">Val.xor</a></span> <span class="id">dst32</span> <span class="id">src32</span>)); <span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="bpf.monadicmodel.Opcode.html#op_BPF_MOV32">op_BPF_MOV32</a></span>   =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_reg">upd_reg</a></span> <span class="id">dst</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Val.longofintu">Val.longofintu</a></span> <span class="id">src32</span>); <span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="bpf.monadicmodel.Opcode.html#op_BPF_ARSH32">op_BPF_ARSH32</a></span>  =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="bpf.comm.rBPFValues.html#compu_lt_32">compu_lt_32</a></span> <span class="id">src32</span> <span class="id"><a href="bpf.dxcomm.DxValues.html#val32_32">val32_32</a></span> <span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_reg">upd_reg</a></span> <span class="id">dst</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Val.longofint">Val.longofint</a></span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Val.shr">Val.shr</a></span> <span class="id">dst32</span> <span class="id">src32</span>)); <span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_flag">upd_flag</a></span> <span class="id"><a href="bpf.comm.Flag.html#BPF_ILLEGAL_SHIFT">BPF_ILLEGAL_SHIFT</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="bpf.monadicmodel.Opcode.html#op_BPF_ALU32_ILLEGAL_INS">op_BPF_ALU32_ILLEGAL_INS</a></span> =&gt; <span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_flag">upd_flag</a></span> <span class="id"><a href="bpf.comm.Flag.html#BPF_ILLEGAL_INSTRUCTION">BPF_ILLEGAL_INSTRUCTION</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="step_opcode_branch">step_opcode_branch</a></span> (<span class="id">dst64</span>: <span class="id"><a href="bpf.dxcomm.DxValues.html#val64_t">val64_t</a></span>) (<span class="id">src64</span>: <span class="id"><a href="bpf.dxcomm.DxValues.html#val64_t">val64_t</a></span>) (<span class="id">pc</span>: <span class="id"><a href="bpf.dxcomm.DxIntegers.html#uint32_t">uint32_t</a></span>) (<span class="id">ofs</span>: <span class="id"><a href="bpf.dxcomm.DxIntegers.html#uint32_t">uint32_t</a></span>) (<span class="id">op</span>: <span class="id">nat8</span>) : <span class="id"><a href="bpf.dxmodel.DxMonad.html#M">M</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#unit">unit</a></span> :=<br/>
&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">opcode_jmp</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxInstructions.html#get_opcode_branch">get_opcode_branch</a></span> <span class="id">op</span>;<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">opcode_jmp</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="bpf.monadicmodel.Opcode.html#op_BPF_JA">op_BPF_JA</a></span>       =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eqb">Nat.eqb</a></span> <span class="id">op</span> <span class="id">nat8_0x05</span> <span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_pc">upd_pc</a></span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Integers.html#Int.add">Int.add</a></span> <span class="id">pc</span> <span class="id">ofs</span>); <span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_flag">upd_flag</a></span> <span class="id"><a href="bpf.comm.Flag.html#BPF_ILLEGAL_INSTRUCTION">BPF_ILLEGAL_INSTRUCTION</a></span>; <span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="bpf.monadicmodel.Opcode.html#op_BPF_JEQ">op_BPF_JEQ</a></span>     =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="bpf.comm.rBPFValues.html#compl_eq">compl_eq</a></span> <span class="id">dst64</span> <span class="id">src64</span> <span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_pc">upd_pc</a></span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Integers.html#Int.add">Int.add</a></span> <span class="id">pc</span> <span class="id">ofs</span>); <span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="bpf.monadicmodel.Opcode.html#op_BPF_JGT">op_BPF_JGT</a></span>     =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="bpf.comm.rBPFValues.html#complu_gt">complu_gt</a></span> <span class="id">dst64</span> <span class="id">src64</span> <span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_pc">upd_pc</a></span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Integers.html#Int.add">Int.add</a></span> <span class="id">pc</span> <span class="id">ofs</span>); <span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="bpf.monadicmodel.Opcode.html#op_BPF_JGE">op_BPF_JGE</a></span>     =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="bpf.comm.rBPFValues.html#complu_ge">complu_ge</a></span> <span class="id">dst64</span> <span class="id">src64</span> <span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_pc">upd_pc</a></span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Integers.html#Int.add">Int.add</a></span> <span class="id">pc</span> <span class="id">ofs</span>); <span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="bpf.monadicmodel.Opcode.html#op_BPF_JLT">op_BPF_JLT</a></span>     =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="bpf.comm.rBPFValues.html#complu_lt">complu_lt</a></span> <span class="id">dst64</span> <span class="id">src64</span> <span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_pc">upd_pc</a></span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Integers.html#Int.add">Int.add</a></span> <span class="id">pc</span> <span class="id">ofs</span>); <span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="bpf.monadicmodel.Opcode.html#op_BPF_JLE">op_BPF_JLE</a></span>     =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="bpf.comm.rBPFValues.html#complu_le">complu_le</a></span> <span class="id">dst64</span> <span class="id">src64</span> <span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_pc">upd_pc</a></span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Integers.html#Int.add">Int.add</a></span> <span class="id">pc</span> <span class="id">ofs</span>); <span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="bpf.monadicmodel.Opcode.html#op_BPF_JSET">op_BPF_JSET</a></span>     =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="bpf.comm.rBPFValues.html#complu_set">complu_set</a></span> <span class="id">dst64</span> <span class="id">src64</span> <span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_pc">upd_pc</a></span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Integers.html#Int.add">Int.add</a></span> <span class="id">pc</span> <span class="id">ofs</span>); <span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="bpf.monadicmodel.Opcode.html#op_BPF_JNE">op_BPF_JNE</a></span>     =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="bpf.comm.rBPFValues.html#compl_ne">compl_ne</a></span> <span class="id">dst64</span> <span class="id">src64</span> <span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_pc">upd_pc</a></span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Integers.html#Int.add">Int.add</a></span> <span class="id">pc</span> <span class="id">ofs</span>); <span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="bpf.monadicmodel.Opcode.html#op_BPF_JSGT">op_BPF_JSGT</a></span>     =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="bpf.comm.rBPFValues.html#compl_gt">compl_gt</a></span> <span class="id">dst64</span> <span class="id">src64</span> <span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_pc">upd_pc</a></span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Integers.html#Int.add">Int.add</a></span> <span class="id">pc</span> <span class="id">ofs</span>); <span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="bpf.monadicmodel.Opcode.html#op_BPF_JSGE">op_BPF_JSGE</a></span>     =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="bpf.comm.rBPFValues.html#compl_ge">compl_ge</a></span> <span class="id">dst64</span> <span class="id">src64</span> <span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_pc">upd_pc</a></span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Integers.html#Int.add">Int.add</a></span> <span class="id">pc</span> <span class="id">ofs</span>); <span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="bpf.monadicmodel.Opcode.html#op_BPF_JSLT">op_BPF_JSLT</a></span>     =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="bpf.comm.rBPFValues.html#compl_lt">compl_lt</a></span> <span class="id">dst64</span> <span class="id">src64</span> <span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_pc">upd_pc</a></span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Integers.html#Int.add">Int.add</a></span> <span class="id">pc</span> <span class="id">ofs</span>); <span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="bpf.monadicmodel.Opcode.html#op_BPF_JSLE">op_BPF_JSLE</a></span>     =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="bpf.comm.rBPFValues.html#compl_le">compl_le</a></span> <span class="id">dst64</span> <span class="id">src64</span> <span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_pc">upd_pc</a></span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Integers.html#Int.add">Int.add</a></span> <span class="id">pc</span> <span class="id">ofs</span>); <span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
<br/>
&nbsp;&nbsp;| <span class="id"><a href="bpf.monadicmodel.Opcode.html#op_BPF_CALL">op_BPF_CALL</a></span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eqb">Nat.eqb</a></span> <span class="id">op</span> <span class="id">nat8_0x85</span> <span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">f_ptr</span>    &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#_bpf_get_call">_bpf_get_call</a></span> (<span class="id"><a href="bpf.comm.rBPFValues.html#val_intsoflongu">val_intsoflongu</a></span> <span class="id">src64</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">is_null</span>  &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#cmp_ptr32_nullM">cmp_ptr32_nullM</a></span> <span class="id">f_ptr</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id">is_null</span> <span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_flag">upd_flag</a></span> <span class="id"><a href="bpf.comm.Flag.html#BPF_ILLEGAL_CALL">BPF_ILLEGAL_CALL</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">res</span>  &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#exec_function">exec_function</a></span> <span class="id">f_ptr</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_reg">upd_reg</a></span> <span class="id"><a href="bpf.comm.Regs.html#R0">R0</a></span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Val.longofintu">Val.longofintu</a></span> <span class="id">res</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_flag">upd_flag</a></span> <span class="id"><a href="bpf.comm.Flag.html#BPF_ILLEGAL_INSTRUCTION">BPF_ILLEGAL_INSTRUCTION</a></span>; <span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
<br/>
&nbsp;&nbsp;| <span class="id"><a href="bpf.monadicmodel.Opcode.html#op_BPF_RET">op_BPF_RET</a></span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eqb">Nat.eqb</a></span> <span class="id">op</span> <span class="id">nat8_0x95</span> <span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_flag">upd_flag</a></span> <span class="id"><a href="bpf.comm.Flag.html#BPF_SUCC_RETURN">BPF_SUCC_RETURN</a></span>; <span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_flag">upd_flag</a></span> <span class="id"><a href="bpf.comm.Flag.html#BPF_ILLEGAL_INSTRUCTION">BPF_ILLEGAL_INSTRUCTION</a></span>; <span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="bpf.monadicmodel.Opcode.html#op_BPF_JMP_ILLEGAL_INS">op_BPF_JMP_ILLEGAL_INS</a></span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_flag">upd_flag</a></span> <span class="id"><a href="bpf.comm.Flag.html#BPF_ILLEGAL_INSTRUCTION">BPF_ILLEGAL_INSTRUCTION</a></span>; <span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="step_opcode_mem_ld_imm">step_opcode_mem_ld_imm</a></span> (<span class="id">imm</span>: <span class="id"><a href="bpf.dxcomm.DxIntegers.html#sint32_t">sint32_t</a></span>) (<span class="id">dst64</span>: <span class="id"><a href="bpf.dxcomm.DxValues.html#val64_t">val64_t</a></span>) (<span class="id">dst</span>: <span class="id"><a href="bpf.comm.Regs.html#reg">reg</a></span>) (<span class="id">op</span>: <span class="id">nat8</span>): <span class="id"><a href="bpf.dxmodel.DxMonad.html#M">M</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#unit">unit</a></span> :=<br/>
&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">opcode_ld</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxInstructions.html#get_opcode_mem_ld_imm">get_opcode_mem_ld_imm</a></span> <span class="id">op</span>;<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">opcode_ld</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="bpf.monadicmodel.Opcode.html#op_BPF_LDDW_low">op_BPF_LDDW_low</a></span>      =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_reg">upd_reg</a></span> <span class="id">dst</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Val.longofintu">Val.longofintu</a></span> (<span class="id"><a href="bpf.dxcomm.DxValues.html#svint_to_uvint">svint_to_uvint</a></span> (<span class="id"><a href="bpf.comm.rBPFValues.html#sint32_to_vint">sint32_to_vint</a></span> <span class="id">imm</span>))); <span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="bpf.monadicmodel.Opcode.html#op_BPF_LDDW_high">op_BPF_LDDW_high</a></span>     =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_reg">upd_reg</a></span> <span class="id">dst</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Val.orl">Val.orl</a></span> <span class="id">dst64</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Val.shll">Val.shll</a></span>  (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Val.longofintu">Val.longofintu</a></span> (<span class="id"><a href="bpf.dxcomm.DxValues.html#svint_to_uvint">svint_to_uvint</a></span> (<span class="id"><a href="bpf.comm.rBPFValues.html#sint32_to_vint">sint32_to_vint</a></span> <span class="id">imm</span>))) (<span class="id"><a href="bpf.comm.rBPFValues.html#sint32_to_vint">sint32_to_vint</a></span> <span class="id"><a href="bpf.dxcomm.DxIntegers.html#int32_32">int32_32</a></span>)));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="bpf.monadicmodel.Opcode.html#op_BPF_LDX_IMM_ILLEGAL_INS">op_BPF_LDX_IMM_ILLEGAL_INS</a></span> =&gt; <span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_flag">upd_flag</a></span> <span class="id"><a href="bpf.comm.Flag.html#BPF_ILLEGAL_INSTRUCTION">BPF_ILLEGAL_INSTRUCTION</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="step_opcode_mem_ld_reg">step_opcode_mem_ld_reg</a></span> (<span class="id">addr</span>: <span class="id"><a href="bpf.dxcomm.DxValues.html#valu32_t">valu32_t</a></span>) (<span class="id">dst</span>: <span class="id"><a href="bpf.comm.Regs.html#reg">reg</a></span>) (<span class="id">op</span>: <span class="id">nat8</span>): <span class="id"><a href="bpf.dxmodel.DxMonad.html#M">M</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#unit">unit</a></span> :=<br/>
&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">opcode_ld</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxInstructions.html#get_opcode_mem_ld_reg">get_opcode_mem_ld_reg</a></span> <span class="id">op</span>;<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">opcode_ld</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="bpf.monadicmodel.Opcode.html#op_BPF_LDXW">op_BPF_LDXW</a></span>      =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">addr_ptr</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxInstructions.html#check_mem">check_mem</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memtype.html#Readable">Readable</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.AST.html#Mint32">Mint32</a></span> <span class="id">addr</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">is_null</span>  &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#cmp_ptr32_nullM">cmp_ptr32_nullM</a></span> <span class="id">addr_ptr</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id">is_null</span> <span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_flag">upd_flag</a></span> <span class="id"><a href="bpf.comm.Flag.html#BPF_ILLEGAL_MEM">BPF_ILLEGAL_MEM</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">v</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#load_mem">load_mem</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.AST.html#Mint32">Mint32</a></span> <span class="id">addr_ptr</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_reg">upd_reg</a></span> <span class="id">dst</span> <span class="id">v</span>; <span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="bpf.monadicmodel.Opcode.html#op_BPF_LDXH">op_BPF_LDXH</a></span>      =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">addr_ptr</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxInstructions.html#check_mem">check_mem</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memtype.html#Readable">Readable</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.AST.html#Mint16unsigned">Mint16unsigned</a></span> <span class="id">addr</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">is_null</span>  &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#cmp_ptr32_nullM">cmp_ptr32_nullM</a></span> <span class="id">addr_ptr</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id">is_null</span> <span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_flag">upd_flag</a></span> <span class="id"><a href="bpf.comm.Flag.html#BPF_ILLEGAL_MEM">BPF_ILLEGAL_MEM</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">v</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#load_mem">load_mem</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.AST.html#Mint16unsigned">Mint16unsigned</a></span> <span class="id">addr_ptr</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_reg">upd_reg</a></span> <span class="id">dst</span> <span class="id">v</span>; <span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="bpf.monadicmodel.Opcode.html#op_BPF_LDXB">op_BPF_LDXB</a></span>      =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">addr_ptr</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxInstructions.html#check_mem">check_mem</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memtype.html#Readable">Readable</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.AST.html#Mint8unsigned">Mint8unsigned</a></span> <span class="id">addr</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">is_null</span>  &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#cmp_ptr32_nullM">cmp_ptr32_nullM</a></span> <span class="id">addr_ptr</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id">is_null</span> <span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_flag">upd_flag</a></span> <span class="id"><a href="bpf.comm.Flag.html#BPF_ILLEGAL_MEM">BPF_ILLEGAL_MEM</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">v</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#load_mem">load_mem</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.AST.html#Mint8unsigned">Mint8unsigned</a></span> <span class="id">addr_ptr</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_reg">upd_reg</a></span> <span class="id">dst</span> <span class="id">v</span>; <span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="bpf.monadicmodel.Opcode.html#op_BPF_LDXDW">op_BPF_LDXDW</a></span>     =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">addr_ptr</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxInstructions.html#check_mem">check_mem</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memtype.html#Readable">Readable</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.AST.html#Mint64">Mint64</a></span> <span class="id">addr</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">is_null</span>  &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#cmp_ptr32_nullM">cmp_ptr32_nullM</a></span> <span class="id">addr_ptr</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id">is_null</span> <span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_flag">upd_flag</a></span> <span class="id"><a href="bpf.comm.Flag.html#BPF_ILLEGAL_MEM">BPF_ILLEGAL_MEM</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">v</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#load_mem">load_mem</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.AST.html#Mint64">Mint64</a></span> <span class="id">addr_ptr</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_reg">upd_reg</a></span> <span class="id">dst</span> <span class="id">v</span>; <span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="bpf.monadicmodel.Opcode.html#op_BPF_LDX_REG_ILLEGAL_INS">op_BPF_LDX_REG_ILLEGAL_INS</a></span> =&gt; <span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_flag">upd_flag</a></span> <span class="id"><a href="bpf.comm.Flag.html#BPF_ILLEGAL_INSTRUCTION">BPF_ILLEGAL_INSTRUCTION</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="step_opcode_mem_st_imm">step_opcode_mem_st_imm</a></span> (<span class="id">imm</span>: <span class="id"><a href="bpf.dxcomm.DxValues.html#vals32_t">vals32_t</a></span>) (<span class="id">addr</span>: <span class="id"><a href="bpf.dxcomm.DxValues.html#valu32_t">valu32_t</a></span>) (<span class="id">op</span>: <span class="id">nat8</span>): <span class="id"><a href="bpf.dxmodel.DxMonad.html#M">M</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#unit">unit</a></span> :=<br/>
&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">opcode_st</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxInstructions.html#get_opcode_mem_st_imm">get_opcode_mem_st_imm</a></span> <span class="id">op</span>;<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">opcode_st</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="bpf.monadicmodel.Opcode.html#op_BPF_STW">op_BPF_STW</a></span>       =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">addr_ptr</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxInstructions.html#check_mem">check_mem</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memtype.html#Writable">Writable</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.AST.html#Mint32">Mint32</a></span> <span class="id">addr</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">is_null</span>  &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#cmp_ptr32_nullM">cmp_ptr32_nullM</a></span> <span class="id">addr_ptr</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id">is_null</span> <span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_flag">upd_flag</a></span> <span class="id"><a href="bpf.comm.Flag.html#BPF_ILLEGAL_MEM">BPF_ILLEGAL_MEM</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#store_mem_imm">store_mem_imm</a></span> <span class="id">addr_ptr</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.AST.html#Mint32">Mint32</a></span> <span class="id">imm</span>; <span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="bpf.monadicmodel.Opcode.html#op_BPF_STH">op_BPF_STH</a></span>       =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">addr_ptr</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxInstructions.html#check_mem">check_mem</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memtype.html#Writable">Writable</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.AST.html#Mint16unsigned">Mint16unsigned</a></span> <span class="id">addr</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">is_null</span>  &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#cmp_ptr32_nullM">cmp_ptr32_nullM</a></span> <span class="id">addr_ptr</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id">is_null</span> <span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_flag">upd_flag</a></span> <span class="id"><a href="bpf.comm.Flag.html#BPF_ILLEGAL_MEM">BPF_ILLEGAL_MEM</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#store_mem_imm">store_mem_imm</a></span> <span class="id">addr_ptr</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.AST.html#Mint16unsigned">Mint16unsigned</a></span> <span class="id">imm</span>; <span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="bpf.monadicmodel.Opcode.html#op_BPF_STB">op_BPF_STB</a></span>       =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">addr_ptr</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxInstructions.html#check_mem">check_mem</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memtype.html#Writable">Writable</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.AST.html#Mint8unsigned">Mint8unsigned</a></span> <span class="id">addr</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">is_null</span>  &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#cmp_ptr32_nullM">cmp_ptr32_nullM</a></span> <span class="id">addr_ptr</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id">is_null</span> <span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_flag">upd_flag</a></span> <span class="id"><a href="bpf.comm.Flag.html#BPF_ILLEGAL_MEM">BPF_ILLEGAL_MEM</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#store_mem_imm">store_mem_imm</a></span> <span class="id">addr_ptr</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.AST.html#Mint8unsigned">Mint8unsigned</a></span> <span class="id">imm</span>; <span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="bpf.monadicmodel.Opcode.html#op_BPF_STDW">op_BPF_STDW</a></span>      =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">addr_ptr</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxInstructions.html#check_mem">check_mem</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memtype.html#Writable">Writable</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.AST.html#Mint64">Mint64</a></span> <span class="id">addr</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">is_null</span>  &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#cmp_ptr32_nullM">cmp_ptr32_nullM</a></span> <span class="id">addr_ptr</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id">is_null</span> <span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_flag">upd_flag</a></span> <span class="id"><a href="bpf.comm.Flag.html#BPF_ILLEGAL_MEM">BPF_ILLEGAL_MEM</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#store_mem_imm">store_mem_imm</a></span> <span class="id">addr_ptr</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.AST.html#Mint64">Mint64</a></span> <span class="id">imm</span>; <span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;| <span class="id">op_BPF_ST_IMM_ILLEGAL_INS</span> =&gt; <span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_flag">upd_flag</a></span> <span class="id"><a href="bpf.comm.Flag.html#BPF_ILLEGAL_INSTRUCTION">BPF_ILLEGAL_INSTRUCTION</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="step_opcode_mem_st_reg">step_opcode_mem_st_reg</a></span> (<span class="id">src64</span>: <span class="id"><a href="bpf.dxcomm.DxValues.html#val64_t">val64_t</a></span>) (<span class="id">addr</span>: <span class="id"><a href="bpf.dxcomm.DxValues.html#valu32_t">valu32_t</a></span>) (<span class="id">op</span>: <span class="id">nat8</span>): <span class="id"><a href="bpf.dxmodel.DxMonad.html#M">M</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#unit">unit</a></span> :=<br/>
&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">opcode_st</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxInstructions.html#get_opcode_mem_st_reg">get_opcode_mem_st_reg</a></span> <span class="id">op</span>;<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">opcode_st</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="bpf.monadicmodel.Opcode.html#op_BPF_STXW">op_BPF_STXW</a></span>      =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">addr_ptr</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxInstructions.html#check_mem">check_mem</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memtype.html#Writable">Writable</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.AST.html#Mint32">Mint32</a></span> <span class="id">addr</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">is_null</span>  &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#cmp_ptr32_nullM">cmp_ptr32_nullM</a></span> <span class="id">addr_ptr</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id">is_null</span> <span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_flag">upd_flag</a></span> <span class="id"><a href="bpf.comm.Flag.html#BPF_ILLEGAL_MEM">BPF_ILLEGAL_MEM</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#store_mem_reg">store_mem_reg</a></span> <span class="id">addr_ptr</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.AST.html#Mint32">Mint32</a></span> <span class="id">src64</span>; <span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="bpf.monadicmodel.Opcode.html#op_BPF_STXH">op_BPF_STXH</a></span>      =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">addr_ptr</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxInstructions.html#check_mem">check_mem</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memtype.html#Writable">Writable</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.AST.html#Mint16unsigned">Mint16unsigned</a></span> <span class="id">addr</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">is_null</span>  &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#cmp_ptr32_nullM">cmp_ptr32_nullM</a></span> <span class="id">addr_ptr</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id">is_null</span> <span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_flag">upd_flag</a></span> <span class="id"><a href="bpf.comm.Flag.html#BPF_ILLEGAL_MEM">BPF_ILLEGAL_MEM</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#store_mem_reg">store_mem_reg</a></span> <span class="id">addr_ptr</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.AST.html#Mint16unsigned">Mint16unsigned</a></span> <span class="id">src64</span>; <span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="bpf.monadicmodel.Opcode.html#op_BPF_STXB">op_BPF_STXB</a></span>      =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">addr_ptr</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxInstructions.html#check_mem">check_mem</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memtype.html#Writable">Writable</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.AST.html#Mint8unsigned">Mint8unsigned</a></span> <span class="id">addr</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">is_null</span>  &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#cmp_ptr32_nullM">cmp_ptr32_nullM</a></span> <span class="id">addr_ptr</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id">is_null</span> <span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_flag">upd_flag</a></span> <span class="id"><a href="bpf.comm.Flag.html#BPF_ILLEGAL_MEM">BPF_ILLEGAL_MEM</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#store_mem_reg">store_mem_reg</a></span> <span class="id">addr_ptr</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.AST.html#Mint8unsigned">Mint8unsigned</a></span> <span class="id">src64</span>; <span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="bpf.monadicmodel.Opcode.html#op_BPF_STXDW">op_BPF_STXDW</a></span>     =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">addr_ptr</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxInstructions.html#check_mem">check_mem</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memtype.html#Writable">Writable</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.AST.html#Mint64">Mint64</a></span> <span class="id">addr</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">is_null</span>  &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#cmp_ptr32_nullM">cmp_ptr32_nullM</a></span> <span class="id">addr_ptr</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id">is_null</span> <span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_flag">upd_flag</a></span> <span class="id"><a href="bpf.comm.Flag.html#BPF_ILLEGAL_MEM">BPF_ILLEGAL_MEM</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#store_mem_reg">store_mem_reg</a></span> <span class="id">addr_ptr</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.AST.html#Mint64">Mint64</a></span> <span class="id">src64</span>; <span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;| <span class="id">op_BPF_STX_REG_ILLEGAL_INS</span> =&gt; <span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_flag">upd_flag</a></span> <span class="id"><a href="bpf.comm.Flag.html#BPF_ILLEGAL_INSTRUCTION">BPF_ILLEGAL_INSTRUCTION</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="step">step</a></span>: <span class="id"><a href="bpf.dxmodel.DxMonad.html#M">M</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#unit">unit</a></span> :=<br/>
&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">pc</span>   &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#eval_pc">eval_pc</a></span>;<br/>
&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">ins</span>  &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#eval_ins">eval_ins</a></span> <span class="id">pc</span>;<br/>
&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">op</span>   &lt;-- <span class="id"><a href="bpf.dxmodel.DxInstructions.html#get_opcode_ins">get_opcode_ins</a></span> <span class="id">ins</span>;<br/>
&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">opc</span>  &lt;-- <span class="id"><a href="bpf.dxmodel.DxInstructions.html#get_opcode">get_opcode</a></span> <span class="id">op</span>;<br/>
&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">dst</span>  &lt;-- <span class="id"><a href="bpf.dxmodel.DxInstructions.html#get_dst">get_dst</a></span> <span class="id">ins</span>;<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">opc</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="bpf.monadicmodel.Opcode.html#op_BPF_ALU64">op_BPF_ALU64</a></span>   =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">dst64</span>  &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#eval_reg">eval_reg</a></span> <span class="id">dst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">src64</span>  &lt;-- <span class="id"><a href="bpf.dxmodel.DxInstructions.html#get_src64">get_src64</a></span> <span class="id">op</span> <span class="id">ins</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.dxmodel.DxInstructions.html#step_opcode_alu64">step_opcode_alu64</a></span> <span class="id">dst64</span> <span class="id">src64</span> <span class="id">dst</span> <span class="id">op</span>                     <span class="docright">(* 0xX7 / 0xXf  *)</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="bpf.monadicmodel.Opcode.html#op_BPF_ALU32">op_BPF_ALU32</a></span>   =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">dst64</span>  &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#eval_reg">eval_reg</a></span> <span class="id">dst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">dst32</span>  &lt;-- <span class="id"><a href="bpf.dxmodel.DxInstructions.html#reg64_to_reg32">reg64_to_reg32</a></span> <span class="id">dst64</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">src32</span>  &lt;-- <span class="id"><a href="bpf.dxmodel.DxInstructions.html#get_src32">get_src32</a></span> <span class="id">op</span> <span class="id">ins</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.dxmodel.DxInstructions.html#step_opcode_alu32">step_opcode_alu32</a></span> <span class="id">dst32</span> <span class="id">src32</span> <span class="id">dst</span> <span class="id">op</span>                     <span class="docright">(* 0xX4 / 0xXc  *)</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="bpf.monadicmodel.Opcode.html#op_BPF_Branch">op_BPF_Branch</a></span>  =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">dst64</span>  &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#eval_reg">eval_reg</a></span> <span class="id">dst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">ofs</span>    &lt;-- <span class="id"><a href="bpf.dxmodel.DxInstructions.html#get_offset">get_offset</a></span> <span class="id">ins</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">src64</span>  &lt;-- <span class="id"><a href="bpf.dxmodel.DxInstructions.html#get_src64">get_src64</a></span> <span class="id">op</span> <span class="id">ins</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.dxmodel.DxInstructions.html#step_opcode_branch">step_opcode_branch</a></span> <span class="id">dst64</span> <span class="id">src64</span> <span class="id">pc</span> (<span class="id"><a href="bpf.comm.rBPFValues.html#sint32_to_uint32">sint32_to_uint32</a></span> <span class="id">ofs</span>) <span class="id">op</span>                    <span class="docright">(* 0xX5 / 0xXd  *)</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="bpf.monadicmodel.Opcode.html#op_BPF_Mem_ld_imm">op_BPF_Mem_ld_imm</a></span>  =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">dst64</span>  &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#eval_reg">eval_reg</a></span> <span class="id">dst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">imm</span>    &lt;-- <span class="id"><a href="bpf.dxmodel.DxInstructions.html#get_immediate">get_immediate</a></span> <span class="id">ins</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.dxmodel.DxInstructions.html#step_opcode_mem_ld_imm">step_opcode_mem_ld_imm</a></span> <span class="id">imm</span> <span class="id">dst64</span> <span class="id">dst</span> <span class="id">op</span>              <span class="docright">(* 0xX8  *)</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="bpf.monadicmodel.Opcode.html#op_BPF_Mem_ld_reg">op_BPF_Mem_ld_reg</a></span>  =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">src</span>    &lt;-- <span class="id"><a href="bpf.dxmodel.DxInstructions.html#get_src">get_src</a></span> <span class="id">ins</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">src64</span>  &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#eval_reg">eval_reg</a></span> <span class="id">src</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">ofs</span>    &lt;-- <span class="id"><a href="bpf.dxmodel.DxInstructions.html#get_offset">get_offset</a></span> <span class="id">ins</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">addr</span>   &lt;-- <span class="id"><a href="bpf.dxmodel.DxInstructions.html#get_addr_ofs">get_addr_ofs</a></span> <span class="id">src64</span> <span class="id">ofs</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.dxmodel.DxInstructions.html#step_opcode_mem_ld_reg">step_opcode_mem_ld_reg</a></span> <span class="id">addr</span> <span class="id">dst</span> <span class="id">op</span>       <span class="docright">(* 0xX1/0xX9  *)</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="bpf.monadicmodel.Opcode.html#op_BPF_Mem_st_imm">op_BPF_Mem_st_imm</a></span>  =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">dst64</span>  &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#eval_reg">eval_reg</a></span> <span class="id">dst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">ofs</span>    &lt;-- <span class="id"><a href="bpf.dxmodel.DxInstructions.html#get_offset">get_offset</a></span> <span class="id">ins</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">imm</span>    &lt;-- <span class="id"><a href="bpf.dxmodel.DxInstructions.html#get_immediate">get_immediate</a></span> <span class="id">ins</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">addr</span>   &lt;-- <span class="id"><a href="bpf.dxmodel.DxInstructions.html#get_addr_ofs">get_addr_ofs</a></span> <span class="id">dst64</span> <span class="id">ofs</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.dxmodel.DxInstructions.html#step_opcode_mem_st_imm">step_opcode_mem_st_imm</a></span> (<span class="id"><a href="bpf.comm.rBPFValues.html#sint32_to_vint">sint32_to_vint</a></span> <span class="id">imm</span>) <span class="id">addr</span> <span class="id">op</span>       <span class="docright">(* 0xX2/0xXa  *)</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="bpf.monadicmodel.Opcode.html#op_BPF_Mem_st_reg">op_BPF_Mem_st_reg</a></span>  =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">dst64</span>  &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#eval_reg">eval_reg</a></span> <span class="id">dst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">src</span>    &lt;-- <span class="id"><a href="bpf.dxmodel.DxInstructions.html#get_src">get_src</a></span> <span class="id">ins</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">src64</span>  &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#eval_reg">eval_reg</a></span> <span class="id">src</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">ofs</span>    &lt;-- <span class="id"><a href="bpf.dxmodel.DxInstructions.html#get_offset">get_offset</a></span> <span class="id">ins</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">addr</span>   &lt;-- <span class="id"><a href="bpf.dxmodel.DxInstructions.html#get_addr_ofs">get_addr_ofs</a></span> <span class="id">dst64</span> <span class="id">ofs</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.dxmodel.DxInstructions.html#step_opcode_mem_st_reg">step_opcode_mem_st_reg</a></span> <span class="id">src64</span> <span class="id">addr</span> <span class="id">op</span>       <span class="docright">(* 0xX3/0xXb  *)</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="bpf.monadicmodel.Opcode.html#op_BPF_ILLEGAL_INS">op_BPF_ILLEGAL_INS</a></span> =&gt; <span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_flag">upd_flag</a></span> <span class="id"><a href="bpf.comm.Flag.html#BPF_ILLEGAL_INSTRUCTION">BPF_ILLEGAL_INSTRUCTION</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="bpf_interpreter_aux">bpf_interpreter_aux</a></span> (<span class="id">fuel</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) {<span class="kwd">struct</span> <span class="id">fuel</span>}: <span class="id"><a href="bpf.dxmodel.DxMonad.html#M">M</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#unit">unit</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">fuel</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span> =&gt; <span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_flag">upd_flag</a></span> <span class="id"><a href="bpf.comm.Flag.html#BPF_ILLEGAL_LEN">BPF_ILLEGAL_LEN</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">fuel0</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">len</span>  &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#eval_ins_len">eval_ins_len</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">pc</span>   &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#eval_pc">eval_pc</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Integers.html#Int.ltu">Int.ltu</a></span> <span class="id">pc</span> <span class="id">len</span>) <span class="kwd">then</span> <span class="docright">(* 0 &lt; pc &lt; len: pc is less than the length of l  *)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxInstructions.html#step">step</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">f</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#eval_flag">eval_flag</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="bpf.comm.Flag.html#flag_eq">flag_eq</a></span> <span class="id">f</span> <span class="id"><a href="bpf.comm.Flag.html#BPF_OK">BPF_OK</a></span> <span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">len0</span>  &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#eval_ins_len">eval_ins_len</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">pc0</span>   &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#eval_pc">eval_pc</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Integers.html#Int.ltu">Int.ltu</a></span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Integers.html#Int.add">Int.add</a></span> <span class="id">pc0</span> <span class="id"><a href="bpf.dxcomm.DxIntegers.html#int32_1">int32_1</a></span>) <span class="id">len0</span>) <span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span> &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_pc_incr">upd_pc_incr</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">bpf_interpreter_aux</span> <span class="id">fuel0</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_flag">upd_flag</a></span> <span class="id"><a href="bpf.comm.Flag.html#BPF_ILLEGAL_LEN">BPF_ILLEGAL_LEN</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_flag">upd_flag</a></span> <span class="id"><a href="bpf.comm.Flag.html#BPF_ILLEGAL_LEN">BPF_ILLEGAL_LEN</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="bpf_interpreter">bpf_interpreter</a></span> (<span class="id">fuel</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>): <span class="id"><a href="bpf.dxmodel.DxMonad.html#M">M</a></span> <span class="id"><a href="bpf.dxcomm.DxValues.html#val64_t">val64_t</a></span> :=<br/>
&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">mrs</span>      &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#eval_mrs_regions">eval_mrs_regions</a></span>;<br/>
&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">bpf_ctx</span>  &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#get_mem_region">get_mem_region</a></span> 0 <span class="id">mrs</span>;<br/>
&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">start</span>  &lt;-- <span class="id"><a href="bpf.dxmodel.DxInstructions.html#get_start_addr">get_start_addr</a></span> <span class="id">bpf_ctx</span>;<br/>
&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span>        &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#upd_reg">upd_reg</a></span> <span class="id"><a href="bpf.comm.Regs.html#R1">R1</a></span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Val.longofintu">Val.longofintu</a></span> <span class="id">start</span>); <span class="docright">(* let's say the ctx memory region is also be the first one  *)</span><br/>
&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">_</span>        &lt;-- <span class="id"><a href="bpf.dxmodel.DxInstructions.html#bpf_interpreter_aux">bpf_interpreter_aux</a></span> <span class="id">fuel</span>;<br/>
&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">f</span>        &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#eval_flag">eval_flag</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="bpf.comm.Flag.html#flag_eq">flag_eq</a></span> <span class="id">f</span> <span class="id"><a href="bpf.comm.Flag.html#BPF_SUCC_RETURN">BPF_SUCC_RETURN</a></span> <span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">res</span>  &lt;-- <span class="id"><a href="bpf.dxmodel.DxMonad.html#eval_reg">eval_reg</a></span> <span class="id"><a href="bpf.comm.Regs.html#R0">R0</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id">res</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="bpf.dxmodel.DxMonad.html#returnM">returnM</a></span> <span class="id"><a href="bpf.dxcomm.DxValues.html#val64_zero">val64_zero</a></span>.<br/>
<br/>
<span class="id">Close</span> <span class="kwd">Scope</span> <span class="id">monad_scope</span>.
</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</a></div>
</body>
</html>
